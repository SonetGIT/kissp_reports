using Intersoft.CISSA.DataAccessLayer.Model.Context;
using Intersoft.CISSA.DataAccessLayer.Model.Documents;
using Intersoft.CISSA.DataAccessLayer.Model.Query;
using Intersoft.CISSA.DataAccessLayer.Model.Query.Builders;
using Intersoft.CISSA.DataAccessLayer.Model.Query.Sql;
using Intersoft.CISSA.DataAccessLayer.Model.Workflow;
using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Reflection;
using System.Web;
using System.Runtime.Serialization;
using Intersoft.CISSA.DataAccessLayer.Model;

namespace SourcesAPI.Utils
{
    public static class ReportExecutor
    {
        public static class GenerateSummaryReport
        {
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var ui = context.GetUserInfo();
                var items = new List<ReportItem>
            {
                GetReportItem1(context, year, month, ui.OrganizationId.Value),
                GetReportItem2(context, year, month, ui.OrganizationId.Value),
                GetReportItem3(context, year, month, ui.OrganizationId.Value),
                GetReportItem4(context, year, month, ui.OrganizationId.Value),
                GetReportItem5(context, year, month, ui.OrganizationId.Value),
                GetReportItem6(context, year, month, ui.OrganizationId.Value),
                GetReportItem7(context, year, month, ui.OrganizationId.Value)
            };

                return items;
            }
            //Report Defs
            static Guid reportNo1DefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");//Уй-булого комок (от 0 до 16 лет)
            static Guid reportNo1ItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");//Rows Уй-булого комок (от 0 до 16 лет)

            static Guid reportNo2DefId = new Guid("{0C6A34A9-CF41-4750-B21D-9913672A0C76}");//ЕПМС
            static Guid reportNo2ItemDefId = new Guid("{760233C7-3FC3-4417-95AE-F399B8B0208F}");//Rows ЕПМС

            static Guid reportNo3DefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");//Социальное пособие  (АСЖ)
            static Guid reportNo3ItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}");//Rows Социальное пособие  (АСЖ)

            static Guid reportNo4DefId = new Guid("{9580E9AE-5949-4B83-90F0-EED511B63477}");//ДЕСП
            static Guid reportNo4ItemDefId = new Guid("{D2FCA75E-34E4-4E85-93B5-6917C4F18BC2}");//Rows ДЕСП


            class _ReportDef
            {
                public Guid ReportDefId { get; set; }
                public Guid ReportItemDefId { get; set; }
            }

            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            static List<ReportItem> GetReportItems(WorkflowContext context, int year, int month, Guid orgId)
            {
                var reportDefs = new List<_ReportDef>
        {
            new _ReportDef
            {
                ReportDefId = reportNo1DefId,
                ReportItemDefId = reportNo1ItemDefId
            },
            /*new _ReportDef
            {
                ReportDefId = reportNo2DefId,
                ReportItemDefId = reportNo2ItemDefId
            },*/
            new _ReportDef
            {
                ReportDefId = reportNo3DefId,
                ReportItemDefId = reportNo3ItemDefId
            }
        };
                var items = new List<ReportItem>();

                foreach (var reportDef in reportDefs)
                {
                    var qb = new QueryBuilder(reportDef.ReportDefId, context.UserId);
                    qb.Where("&OrgId").Eq(orgId)
                        .And("&State").Eq(approvedStateId)
                        .And("Year").Eq(year).And("Month").Eq(month);
                    var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                    var itemSrc = query.JoinSource(query.Source, reportDef.ReportItemDefId, SqlSourceJoinType.Inner, "Rows");
                    if (reportDef.ReportDefId == reportNo1DefId)
                        query.AddCondition(ExpressionOperation.And, reportDef.ReportItemDefId, "PaymentType", ConditionOperation.Equal, new Guid("{330FA388-7596-4D4B-903B-33D4D069707D}"));
                    query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        if (reader.Read())
                        {
                            items.Add(new ReportItem
                            {
                                RowNo = reportDef.ReportDefId == reportNo1DefId ? 1 : 4,
                                PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                                PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                                PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                                PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                                PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                                BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                                BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                                BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                                BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                                BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                            });
                        }
                    }
                }
                GetReportItems2(context, year, month, orgId, items, new object[] { poorBenefitPaymentId, underWardBenefitPaymentId }, true);
                GetReportItems3(context, year, month, orgId, items, new object[] { despCategoryType1Id }, 5);
                return items;
            }

            static ReportItem GetReportItem1(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo1DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo1ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo1ItemDefId, "PaymentType", ConditionOperation.Equal, new Guid("{330FA388-7596-4D4B-903B-33D4D069707D}"));
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 1,
                            RowName = "Уй-булого комок (от 0 до 16 лет)",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 1");
            }
            static ReportItem GetReportItem2(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo2DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo2ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.In, new object[] { poorBenefitPaymentId, underWardBenefitPaymentId });
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 2,
                            RowName = "ЕПМС от 3-х до 16-18 лет",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 2");
            }
            static ReportItem GetReportItem3(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo2DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo2ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.In, new object[] { twinsBenefitPaymentId, till3BenefitPaymentId, tripletsBenefitPaymentId });
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 3,
                            RowName = "ЕПМС до 3-х лет",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 3");
            }
            static ReportItem GetReportItem4(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo3DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo1ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 4,
                            RowName = "Социальное пособие  (АСЖ)",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 4");
            }
            static ReportItem GetReportItem5(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo4DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo4ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo4ItemDefId, "Category", ConditionOperation.Equal, despCategoryType1Id);
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 5,
                            RowName = "До 18 лет",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 5");
            }
            static ReportItem GetReportItem6(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo4DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo4ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo4ItemDefId, "Category", ConditionOperation.In, new object[] { despCategoryType3Id, despCategoryType4Id });
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 6,
                            RowName = "ДЕСП ЛОВЗ",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 6");
            }
            static ReportItem GetReportItem7(WorkflowContext context, int year, int month, Guid orgId)
            {
                var qb = new QueryBuilder(reportNo4DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo4ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo4ItemDefId, "Category", ConditionOperation.Equal, despCategoryType2Id);
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        return new ReportItem
                        {
                            RowNo = 7,
                            RowName = "ДЕСП родители",
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        };
                    }
                }
                throw new ApplicationException("Ошибка при инициализации строки 7");
            }
            // Виды выплат
            private static readonly Guid poorBenefitPaymentId = new Guid("{D24151CF-C8B0-4851-B0EC-6D6EB382DC61}");   // * ЕПМС семьям по малообеспеченности
            private static readonly Guid twinsBenefitPaymentId = new Guid("{7F1B9709-8F99-473F-9AE0-2DDCD74BDE6E}");   // * Пособие матерям родившим двойню до достижения 3-лет
            private static readonly Guid till3BenefitPaymentId = new Guid("{9BC8A898-31F8-4F55-8C14-28F641142370}");   // * ЕПМС на ребенка до 3-х лет
            private static readonly Guid tripletsBenefitPaymentId = new Guid("{64ACC17D-78B8-492E-AC81-7B1E4750F53A}");   // * ЕПМС матерям родившим тройню и более до достижения 16-лет
            private static readonly Guid underWardBenefitPaymentId = new Guid("{BCE5B287-7495-4AD1-96A8-F52040A4CABF}");   // * ЕПМС малоимущим (опекаемым, сиротам) 
            private static readonly Guid onBirthBenefitPaymentId = new Guid("{43F0ED4A-EFF2-425D-8564-683551BA8F82}");   // * Единовременное пособие при рождении ребенка
            private static readonly Guid onBirthBenefitPayment2Id = new Guid("{1D0CD630-9BB0-4716-AEB7-673B54B42CE5}");   // * Суйунчу
            static List<ReportItem> GetReportItems2(WorkflowContext context, int year, int month, Guid orgId, List<ReportItem> items, object[] rowTypes, bool isFirstCalled)
            {
                var qb = new QueryBuilder(reportNo2DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo2ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.In, rowTypes);
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        items.Add(new ReportItem
                        {
                            RowNo = isFirstCalled ? 2 : 3,
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        });
                    }
                }

                return isFirstCalled ? GetReportItems2(context, year, month, orgId, items, new object[] { twinsBenefitPaymentId, till3BenefitPaymentId, tripletsBenefitPaymentId }, false) : items;
            }


            private static readonly Guid despCategoryType1Id = new Guid("{608F740E-C44B-4305-88E8-F53D497214C0}");//Дети погибшего в событиях 2010 г. до 18 лет
            private static readonly Guid despCategoryType2Id = new Guid("{238BD896-A3B7-494D-B549-4AAC292EE8F5}");//Родители погибшего ед. ребенка в событиях 2010 г. по достижении пенсионного возраста
            private static readonly Guid despCategoryType3Id = new Guid("{ECDF4DE6-299E-4C6A-843F-49362C32EB96}");//Получившие вред здоровью в событиях 2010 г., имеющие заключение СМЭ
            private static readonly Guid despCategoryType4Id = new Guid("{7D08F570-239D-46BF-BF4F-6E3A510ACCD2}");//Признанные ЛОВЗ в следствие событий 2010 г.
            static List<ReportItem> GetReportItems3(WorkflowContext context, int year, int month, Guid orgId, List<ReportItem> items, object[] rowTypes, int rowNo)
            {
                var qb = new QueryBuilder(reportNo4DefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId)
                    .And("&State").Eq(approvedStateId)
                    .And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportNo4ItemDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddCondition(ExpressionOperation.And, reportNo4ItemDefId, "Category", ConditionOperation.In, rowTypes);
                query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        items.Add(new ReportItem
                        {
                            RowNo = rowNo,
                            PostFamilyCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0),
                            PostChildCount = reader.IsDbNull(1) ? 0 : reader.GetInt32(1),
                            PostNeedAmountSec1 = reader.IsDbNull(2) ? 0m : Math.Round(reader.GetDecimal(2) * 0.001m, 2),
                            PostNeedAmountSec2 = reader.IsDbNull(3) ? 0m : Math.Round(reader.GetDecimal(3) * 0.001m, 2),
                            PostComissionSize = reader.IsDbNull(4) ? 0m : Math.Round(reader.GetDecimal(4) * 0.001m, 2),
                            BankFamilyCount = reader.IsDbNull(5) ? 0 : reader.GetInt32(5),
                            BankChildCount = reader.IsDbNull(6) ? 0 : reader.GetInt32(6),
                            BankNeedAmountSec1 = reader.IsDbNull(7) ? 0m : Math.Round(reader.GetDecimal(7) * 0.001m, 2),
                            BankNeedAmountSec2 = reader.IsDbNull(8) ? 0m : Math.Round(reader.GetDecimal(8) * 0.001m, 2),
                            BankComissionSize = reader.IsDbNull(9) ? 0m : Math.Round(reader.GetDecimal(9) * 0.001m, 2)
                        });
                    }
                }

                return rowNo == 5 ? GetReportItems3(context, year, month, orgId, items, new object[] { despCategoryType3Id, despCategoryType4Id }, 6) : rowNo == 6 ? GetReportItems3(context, year, month, orgId, items, new object[] { despCategoryType2Id }, 7) : items;
            }

            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                #region потребная сумма получателей через почту
                public int PostFamilyCount { get; set; }
                public int PostChildCount { get; set; }
                public decimal PostNeedAmount
                {
                    get
                    {
                        return PostNeedAmountSec1 + PostNeedAmountSec2;
                    }
                }
                public decimal PostNeedAmountSec1 { get; set; }
                public decimal PostNeedAmountSec2 { get; set; }
                public decimal PostComissionSize { get; set; }
                #endregion

                #region потребная сумма получателей через банк
                public int BankFamilyCount { get; set; }
                public int BankChildCount { get; set; }
                public decimal BankNeedAmount
                {
                    get
                    {
                        return BankNeedAmountSec1 + BankNeedAmountSec2;
                    }
                }
                public decimal BankNeedAmountSec1 { get; set; }
                public decimal BankNeedAmountSec2 { get; set; }
                public decimal BankComissionSize { get; set; }
                #endregion

                #region Всего получ-й
                public int TotalFamilyCount
                {
                    get
                    {
                        return PostFamilyCount + BankFamilyCount;
                    }
                }
                public int TotalChildCount
                {
                    get
                    {
                        return PostChildCount + BankChildCount;
                    }
                }
                #endregion

                #region Всего потребная сумма
                public decimal TotalNeedAmount
                {
                    get
                    {
                        return PostNeedAmount + BankNeedAmount;
                    }
                }
                public decimal TotalPostComissionSize
                {
                    get
                    {
                        return PostComissionSize;
                    }
                }
                public decimal TotalBankComissionSize
                {
                    get
                    {
                        return BankComissionSize;
                    }
                }
                public decimal TotalNeedAmountComissionSize
                {
                    get
                    {
                        return TotalNeedAmount + TotalBankComissionSize + TotalPostComissionSize;
                    }
                }
                #endregion

                #region средний размер на 1 человека
                public decimal AvgAmount
                {
                    get
                    {
                        var total = (BankNeedAmountSec2 + PostNeedAmountSec2);
                        if (total > 0 && TotalChildCount > 0)
                            return Math.Round((total / TotalChildCount) * 1000, 2);
                        else
                            return 0;
                    }
                }
                #endregion
            }
        }

        public static class PoorBenefitsReport2
        {
            // Виды выплат                             
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");   // * Уй-булого комок

            // Document Defs
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid famMember = new Guid("{85B03F9E-47D7-4829-8041-0CDCB8486572}");
            private static readonly Guid famMemberTypeId1 = new Guid("{9BF3B519-C0B8-4344-BF29-47B062C07454}");
            private static readonly Guid famMemberTypeId2 = new Guid("{45D55628-5E72-42B8-8B8D-667346E79046}"); //Двойня
            private static readonly Guid famMemberTypeId3 = new Guid("{8CCAE21E-128A-4728-9479-9C094271C614}");
            private static readonly Guid empStatusTo3Id = new Guid("{D8FF3DAF-A701-414A-B965-4BF93BB658B9}"); //Ребенок до 3-х лет
            private static readonly Guid empStatusTo16Id = new Guid("{8024982A-4AFB-4074-9D63-3EEFE22420E0}");  //Ребенок от 3-х до 16 лет  

            // States                               
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)//*
            {
                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);
                }
                catch (Exception ex)
                {
                    throw new ApplicationException("TargetSite: " + ex.TargetSite.Name + "; Message: " + ex.Message);//*
                }
            }
            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }

            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)//*
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();//context.Get<Doc>("ApprovedReport");
                }

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();

                //Инициализация строк отчета
                var row1TypeId = new Guid("{330FA388-7596-4D4B-903B-33D4D069707D}"); //Уй-булого комок от 0 до 16 лет   
                var row2TypeId = new Guid("{3F7B2602-49D9-4611-A64B-D1E1B4873D13}"); //Уй-булого комок  (опекаемым, сиротам)
                var row3TypeId = new Guid("{7FD8CE36-0E0E-4C0B-B21D-6EB0521AB75B}"); //Пособие матерям родившим двойню до 16 лет
                var row4TypeId = new Guid("{8BC11C2E-AD05-4A96-A434-9C4A57CB03F0}"); //Пособие матерям родившим тройню и более до достижения 16-лет

                var item1 = docRepo.New(reportItemDefId);
                item1["PaymentType"] = row1TypeId;
                var _item1 = new ReportItem { RowName = context.Enums.GetValue(row1TypeId).Value };//*

                var item2 = docRepo.New(reportItemDefId);
                item2["PaymentType"] = row2TypeId;
                var _item2 = new ReportItem { RowName = context.Enums.GetValue(row2TypeId).Value };//*

                var item3 = docRepo.New(reportItemDefId);
                item3["PaymentType"] = row3TypeId;
                var _item3 = new ReportItem { RowName = context.Enums.GetValue(row3TypeId).Value };//*

                var item4 = docRepo.New(reportItemDefId);
                item4["PaymentType"] = row4TypeId;
                var _item4 = new ReportItem { RowName = context.Enums.GetValue(row4TypeId).Value };//*

                CalcSection1(item1, item2, item3, item4, context, year, month, orgId, userId, postPercent);

                CalcSection2(item1, item2, item3, item4, context, year, month, orgId, userId, postPercent);

                CalcFields(item1, item2, item3, item4, report, _item1, _item2, _item3, _item4);//*

                items.Reverse();

                foreach (Doc item in new[] { item4, item3, item2, item1 })
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return new List<ReportItem> { _item1, _item2, _item3, _item4 };
            }

            private static void CalcSection1(Doc item1, Doc item2, Doc item3, Doc item4, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, item1, item2, item3, item4, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(Doc item1, Doc item2, Doc item3, Doc item4, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, item1, item2, item3, item4, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, item1, "Post", context);
                CalcAmountSum(userId, year, month, orgId, item1, item2, item3, item4, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(Doc item1, Doc item2, Doc item3, Doc item4, Doc report, ReportItem _item1, ReportItem _item2, ReportItem _item3, ReportItem _item4)
            {
                var items = new[] { item4, item3, item2, item1 };
                var _items = new[] { _item4, _item3, _item2, _item1 };

                for (int i = 0; items.Length > i; i++)
                {
                    var item = items[i];
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    FieldsInit(item, _item);
                }
                report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item1["DocCount"];
                report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item1["AppCount"];
                report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item1["NeedAmount"];
                report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item1["Percent"];
                report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item1["NeedAmountPercent"];
            }

            private static void FieldsInit(Doc item, ReportItem _item = null)//*
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;

                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }
            public class ReportItem
            {
                public string RowName { get; set; }
                public int DocCount { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmount { get; set; }
                public decimal Percent { get; set; }
                public decimal NeedAmountPercent { get; set; }

                public int PostSection1MonthCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public int PostSection2DocCount { get; set; }
                public int PostSection2AppCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostNeedAmount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }

                public int BankSection1MonthCount { get; set; }
                public int BankSection1AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public int BankSection2DocCount { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public decimal BankNeedAmount { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
            }

            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, Doc item1, Doc item2, Doc item3, Doc item4, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignSrc = query.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                //        var famSrc = query.JoinSource(appSrc, famMember, SqlSourceJoinType.Inner, "FamilyMembers");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, uyBulogoKomokPaymentId);
                query.AddAttribute(assignSrc, "MembershipType");
                query.AddAttribute(assignSrc, "EmploymentStatus");
                query.AddAttribute(appSrc, "RegNo");
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    string s = "";
                    while (reader.Read())
                    {
                        var famMemberType = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var empStatus = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                        var field = orderTypeName + "Section" + sNum + "AppCount";
                        var appNo = reader.IsDbNull(2) ? "---" : reader.GetString(2);
                        if (empStatus == empStatusTo3Id || empStatus == empStatusTo16Id)
                        {
                            item1[field] = ((int?)item1[field] ?? 0) + 1;
                            if (famMemberType == famMemberTypeId1)
                            {
                                item2[field] = ((int?)item2[field] ?? 0) + 1;
                            }
                            else if (famMemberType == famMemberTypeId2)
                            {
                                item3[field] = ((int?)item3[field] ?? 0) + 1;
                                s += "; " + appNo;
                            }
                            else if (famMemberType == famMemberTypeId3)
                            {
                                item4[field] = ((int?)item4[field] ?? 0) + 1;
                            }
                        }
                        else
                        {
                            var statusName = empStatus != Guid.Empty ? context.Enums.GetValue(empStatus).Value : "Род занятий не указан!";
                            throw new Exception(string.Format("Не могу сформировать заявку. У заявления с номером \"{0}\" у получателя указано некорректно род занятий \"{1}\". Просьба проверить и исправить данное значение, и повторить сформировать заново.", appNo, statusName));
                        }
                    }
                    throw new Exception(s);
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, item1, item2, item3, item4, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, Doc item1, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, uyBulogoKomokPaymentId);
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if (reader.Read())
                    {
                        int docCount = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        item1[orderTypeName + "Section2DocCount"] = docCount;
                    }
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, item1, "Bank", context);
            }

            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, Doc item1, Doc item2, Doc item3, Doc item4, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var assignSrc = query.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, uyBulogoKomokPaymentId);
                    query.AddAttribute(assignSrc, "Amount");
                    query.AddAttribute(assignSrc, "MembershipType");
                    query.AddAttribute(assignSrc, "EmploymentStatus");
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        var memberTypeAssign = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var empStatus = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        decimal service = (amount / 100) * postPercent;
                        if (empStatus == empStatusTo3Id || empStatus == empStatusTo16Id)
                        {
                            item1[field + "NeedAmount"] = ((decimal?)item1[field + "NeedAmount"] ?? 0m) + amount;
                            item1[field + "Percent"] = ((decimal?)item1[field + "Percent"] ?? 0m) + service;
                            if (memberTypeAssign == famMemberTypeId1)
                            {
                                item2[field + "NeedAmount"] = ((decimal?)item2[field + "NeedAmount"] ?? 0m) + amount;
                                item2[field + "Percent"] = ((decimal?)item2[field + "Percent"] ?? 0m) + service;
                            }
                            else if (memberTypeAssign == famMemberTypeId2)
                            {
                                item3[field + "NeedAmount"] = ((decimal?)item3[field + "NeedAmount"] ?? 0m) + amount;
                                item3[field + "Percent"] = ((decimal?)item3[field + "Percent"] ?? 0m) + service;
                            }
                            else if (memberTypeAssign == famMemberTypeId3)
                            {
                                item4[field + "NeedAmount"] = ((decimal?)item4[field + "NeedAmount"] ?? 0m) + amount;
                                item4[field + "Percent"] = ((decimal?)item4[field + "Percent"] ?? 0m) + service;
                            }
                        }
                    }
                    CalcAmountSum(userId, year, month, orgId, item1, item2, item3, item4, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var assignSrc = query.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, uyBulogoKomokPaymentId);
                    query.AddAttribute(assignSrc, "Amount");
                    query.AddAttribute(assignSrc, "MembershipType");
                    query.AddAttribute(assignSrc, "EmploymentStatus");
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    query.AddAttribute(appSrc, "RegNo");
                    //query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    string s = "";
                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        string appNo = "";
                        if (sectionTypeId == section1TypeId)
                        {
                            appNo = row[4] is DBNull ? "" : row[4].ToString();
                            s += string.Format("{0}:{1}\n", appNo, amount);
                        }
                        var memberTypeAssignBank = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var empStatus = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        double percent;
                        double.TryParse(row[3].ToString(), out percent);
                        decimal service = (amount / 100) * (decimal)percent;
                        if (empStatus == empStatusTo3Id || empStatus == empStatusTo16Id)
                        {
                            item1[field + "NeedAmount"] = ((decimal?)item1[field + "NeedAmount"] ?? 0m) + amount;
                            item1[field + "Percent"] = ((decimal?)item1[field + "Percent"] ?? 0m) + service;
                            if (memberTypeAssignBank == famMemberTypeId1)
                            {
                                item2[field + "NeedAmount"] = ((decimal?)item2[field + "NeedAmount"] ?? 0m) + amount;
                                item2[field + "Percent"] = ((decimal?)item2[field + "Percent"] ?? 0m) + service;
                            }
                            else if (memberTypeAssignBank == famMemberTypeId2)
                            {
                                item3[field + "NeedAmount"] = ((decimal?)item3[field + "NeedAmount"] ?? 0m) + amount;
                                item3[field + "Percent"] = ((decimal?)item3[field + "Percent"] ?? 0m) + service;
                            }
                            else if (memberTypeAssignBank == famMemberTypeId3)
                            {
                                item4[field + "NeedAmount"] = ((decimal?)item4[field + "NeedAmount"] ?? 0m) + amount;
                                item4[field + "Percent"] = ((decimal?)item4[field + "Percent"] ?? 0m) + service;
                            }
                        }
                    }
                    //throw new Exception(s);
                }
            }

            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        public static class PrivilegePaymentReport1
        {
            // Виды выплат                             
            private static readonly Guid privilege46PaymentId = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");//Денежная компенсация взамен льгот
            private static readonly Guid rehabSinglePaymentId = new Guid("{034D9A01-2B4A-481C-B7FD-A3255C27400C}");//Единовременная выплата реабилитированным гражданам
                                                                                                                   //Categories
            private static Guid category1 = new Guid("{2E662509-144D-47CA-9F2B-087BB6F4AE91}");//Участник ликвидации последствий аварии на ЧАЭЗ 1989 г.
            private static Guid category2 = new Guid("{DF92F99F-BA8D-415C-8236-F54206AF0F73}");//Участник ликвидации последствий аварии на ЧАЭЗ 1988 г.
            private static Guid category3 = new Guid("{8691D5FB-7611-4AAA-AD84-60D2AADF50BE}");//Участник ликвидации последствий аварии на ЧАЭЗ 1986-87 гг.
            private static Guid category4 = new Guid("{63DFD63A-2868-411F-A52F-039E37B1D39F}");//Участник ВОВ, награжденный орденами славы 3-х степеней
            private static Guid category5 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");//Участник ВОВ
            private static Guid category6 = new Guid("{7EE64986-5A47-49D0-A288-88A537E6D0A0}");//Участник боевых действий на территории других государств
            private static Guid category7 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");//Участник блокады г.Ленинграда
            private static Guid category8 = new Guid("{8C21641E-1AC2-438A-ABDB-D6D17D195BB5}");//Семьям погибших военнослужащих при исполнении обязанностей военной службы
            private static Guid category9 = new Guid("{ECD8E6DF-3C3E-427D-BDC1-58E132A8B03D}");//Семья, потерявшая кормильца - участника ЧАЭС
            private static Guid category10 = new Guid("{93B5323F-E16B-4A76-AEB6-7CE166B0471B}");//Семья погибшего/пропавшего без вести в ВОВ военнослужащего
            private static Guid category11 = new Guid("{B038B840-021C-436E-B34D-4EB0E90DB767}");//Семьи сотрудников МВД, погибших при исполнении сл. обяз. или сл.долга, умерших после увольн. вслед-е ран./трав./забол., получ. в пер.прохожд.службы
            private static Guid category12 = new Guid("{C5728DEE-CE74-41C2-A0CF-B1182615D6B3}");//Реабилитированный, пострадавший в результате репрессий
            private static Guid category13 = new Guid("{24D5389C-9102-4369-A978-E2EF7DFC36C8}");//Почетный донор
            private static Guid category14 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");//Несовершеннолетний узник концлагерей, гетто
            private static Guid category15 = new Guid("{FA1787EF-A156-400E-8CA3-436203D3C322}");//ЛОВЗ Сов.Армии 3 гр. (во время несения службы)
            private static Guid category16 = new Guid("{22CB5768-069B-4E18-9F4C-D3F308AF4E3F}");//ЛОВЗ Сов.Армии 2 гр. (во время несения службы)
            private static Guid category17 = new Guid("{1EA3FA92-E895-4A9D-AD5F-72FE1EE3D5BF}");//ЛОВЗ Сов.Армии 1 гр. (во время несения службы)
            private static Guid category18 = new Guid("{CBD190B1-44AD-4E6B-8B79-34BF60619CF5}");//ЛОВЗ по слуху и зрению до 18 лет
            private static Guid category19 = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");//ЛОВЗ 3 гр. по слуху
            private static Guid category21 = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");//ЛОВЗ 2 гр. по слуху
            private static Guid category23 = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");//ЛОВЗ 1 гр. по слуху
            private static Guid category20 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 3 гр. по зрению
            private static Guid category22 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 2 гр. по зрению
            private static Guid category24 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 1 гр. по зрению
            private static Guid category25 = new Guid("{A4B6BC13-479B-468F-B4EB-D661417B1127}");//Лица, награжденные за работу/службу в тылу в годы ВОВ с группой инв.
            private static Guid category26 = new Guid("{891911A4-C7C9-4E8D-919B-6AE2B7DE1AB7}");//Лица, награжденные за работу/службу в тылу в годы ВОВ без группы инв-ти
            private static Guid category27 = new Guid("{76668EA1-47E2-4F09-AD73-4AF24BF0D55C}");//Лица заболевшие лучевой болезнью (ЧАЭС)
            private static Guid category28 = new Guid("{E14662C0-719D-4B26-886F-55C8BD43A11E}");//Инвалид-реабилитиров., пострадавший в результате репрессий
            private static Guid category29 = new Guid("{BFE0BD8C-032D-4DF2-ACC1-60F2385925E9}");//Инвалид Советской армии при исполнении служеб. Обязанности
            private static Guid category30 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");//Инвалид ВОВ 3 группы
            private static Guid category31 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");//Инвалид ВОВ 2 группы
            private static Guid category32 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");//Инвалид ВОВ 1 группы
            private static Guid category33 = new Guid("{7CC482B7-A2FD-4B2E-8BFE-9CF0B96D8E05}");//Инв.3 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category35 = new Guid("{69E2D977-7C5A-4315-BF6A-6E790D19D7EC}");//Инв.2 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category38 = new Guid("{0A8D29A0-4806-422B-89EF-8F11AE835098}");//Инв.1 гр. - участник ликвидации последствий аварии на ЧАЭC
            private static Guid category34 = new Guid("{8828EAF5-5884-4BB0-B097-3D65496E4168}");//Инв.3 гр.-участник боевых действий на террит.др.государств
            private static Guid category36 = new Guid("{EB091676-B785-42AC-A330-44DFFBFDE1F6}");//Инв.2 гр.-участник боевых действий на террит.др.государств
            private static Guid category37 = new Guid("{3F0DD390-EFF5-42BA-A6D4-BB600F61F793}");//Инв.1 гр.-участник боевых действий на террит.др.государств
            private static Guid category39 = new Guid("{DCAC340F-4132-4514-B90C-581B2B24E37D}");//Дети участника ЧАЭС в возрасте до 18 лет
            private static Guid category40 = new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}");//Дети ВИЧ-инфиц. или больные СПИДом
            private static Guid category41 = new Guid("{B0004A56-4831-4CB8-B12B-C39280493A0B}");//Гражданин, мобилизованный в трудовую армию в годы ВОВ
            private static Guid category42 = new Guid("{A1FD4E39-07A0-4117-A99F-1CBFB9BF9E97}");//Герой СССР, герой КР, награжденный за боевые заслуги
            private static Guid category43 = new Guid("{95EC8C3C-0006-45E6-9A24-0FBA212117AA}");//Герой соц. труда, кавалер ордена трудовой славы 3-х степеней
            private static Guid category44 = new Guid("{92F076ED-8558-416F-B28C-AD80017C8D56}");//Вдова(ец) участ. Блокады Ленинграда
            private static Guid category45 = new Guid("{5F257499-9BF5-4850-AC3B-02264CDB62C8}");//Вдова(ец) УОВ
            private static Guid category46 = new Guid("{93933D4F-DE39-4C43-839F-6BE09DF1C9C5}");//Вдова(ец) умершего ИОВ

            private static List<object> categoryTypes = new List<object>
            {
            category1,category2,category3,category4,category5,category6,category7,category8,category9,category10,category11,
            category12,category13,category14,category15,category16,category17,category18,category19,category20,category21,category22,category23,
            category24,category25,category26,category27,category28,category29,category30,category31,category32,category33,category34,category35,
            category36,category37,category38,category39,category40,category41,category42,category43,category44,category45,category46
            };
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d9454743306;
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{4447EA34-67AB-46F2-BE03-A406CAC4EABC}");
            private static readonly Guid reportItemDefId = new Guid("{66605D33-A39E-4709-8534-C1505C041182}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);

                }

                catch (Exception ex)
                {
                    throw new ApplicationException("TargetSite: " + ex.TargetSite.Name + "; Message: " + ex.Message);
                }

            }

            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }
            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();

                }

                Dictionary<Guid, Decimal> prices = GetPriceList(userId, month, year, context);

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();
                var reportItemList = new List<ReportItem>();
                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    if (!prices.ContainsKey(categoryId)) continue;
                    Doc item = docRepo.New(reportItemDefId);

                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    reportItemList.Add(new ReportItem { Category = context.Enums.GetValue(categoryId).Value, PaymentPrice = prices[categoryId] });
                    items.Add(item);
                }

                CalcSection1(items, context, year, month, orgId, userId, postPercent);

                CalcSection2(items, context, year, month, orgId, userId, postPercent);

                CalcFields(items, report, reportItemList);

                items.Reverse();
                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return reportItemList;
            }

            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                //CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section1TypeId);
                //CalcSection1Months(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                int i = 0;
                foreach (var item in items)
                {
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                    FieldsInit(item, _item);
                    i++;
                }
            }
            private static void FieldsInit(Doc item, ReportItem _item = null)
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }

            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                public decimal Percent { get; set; }
                public string Category { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmountPercent { get; set; }
                public decimal PaymentPrice { get; set; }
                public decimal NeedAmount { get; set; }
                public int DocCount { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }
                public decimal PostNeedAmount { get; set; }
                public int PostDocCount { get; set; }
                public int PostSection1DocCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public decimal PostSection1NeedAmountPercent { get; set; }
                public int PostSection1MonthCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public int PostSection2AppCount { get; set; }
                public int PostSection2MonthCount { get; set; }
                public decimal PostSection2NeedAmountPercent { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public int PostSection2DocCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public int BankDocCount { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmount { get; set; }
                public int BankSection2DocCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2NeedAmountPercent { get; set; }
                public int BankSection2MonthCount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public int BankSection1DocCount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public decimal BankSection1NeedAmountPercent { get; set; }
                public int BankSection1AppCount { get; set; }
                public int BankSection1MonthCount { get; set; }
            }

            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, privilege46PaymentId);
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty)
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория не найдена.");

                    if (!categoryTypes.Contains(categoryId))
                    {
                        var catName = context.Enums.GetValue(categoryId).Value;
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория \"" + catName + "\" не входит в число получателей денежной компенсации.");
                    }
                    var item = items[categoryTypes.IndexOf(categoryId)];
                    var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                    var field = orderTypeName + "Section" + sNum + "AppCount";
                    item[field] = ((int?)item[field] ?? 0) + count;
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, privilege46PaymentId);
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = (int?)row[0] ?? 0;
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    Doc item = items[categoryTypes.IndexOf(categoryId)];
                    item[orderTypeName + "Section2DocCount"] = docCount;
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
            }

            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, privilege46PaymentId);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        try
                        {
                            decimal service = (amount / 100) * postPercent;
                            var item = items[categoryTypes.IndexOf(categoryId)];
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, privilege46PaymentId);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent = row[1] is DBNull ? 0 : (double)row[1];
                        Guid categoryId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        if (categoryId == Guid.Empty) continue;
                        try
                        {
                            decimal service = amount / 100 * (decimal)percent;

                            var item = items[categoryTypes.IndexOf(categoryId)];
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                }
            }
            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").Eq(privilege46PaymentId);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0m : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ДК. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        public static class AdditionalAksySocialBenefitsReport1
        {
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {

                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);
                }
                catch (Exception ex)
                {
                    throw new ApplicationException(ex.TargetSite.Name + "; " + ex.Message);
                }
            }
            private static readonly Guid despAksyPaymentTypeId = new Guid("{E590688C-FE0E-4DE2-BEFC-35887CD23ABA}");
            // Document Defs
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{73A632C4-9F82-4861-BF3A-E5C895A3B00F}");
            private static readonly Guid reportItemDefId = new Guid("{ED58934E-989C-4AE6-AB19-A432F06E43E0}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            private static readonly Guid categoryType1Id = new Guid("{12C16D1F-1AF5-4BB0-931A-2D1D9F07E1A5}");//Детям погибшего в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid categoryType2Id = new Guid("{1BFDE4A6-D55F-435A-A34E-B77FAAEA265B}");//Родителям погибшего в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid categoryType3Id = new Guid("{4F53C318-8590-453C-9A06-B7CD9DB29888}");//Вдовам погибшего в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid categoryType4Id = new Guid("{E049D13F-DE27-4644-8473-E1F50F5C5611}");//Лицам, признанным инвалидами  в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly List<object> categoryTypes = new List<object>
            {
            categoryType1Id, categoryType2Id, categoryType3Id, categoryType4Id
            };

            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }
            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();
                }

                Dictionary<Guid, Decimal> prices = GetPriceList(userId, month, year, context);

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();
                var reportItemList = new List<ReportItem>();
                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    Doc item = docRepo.New(reportItemDefId);
                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    reportItemList.Add(new ReportItem { Category = context.Enums.GetValue(categoryId).Value, PaymentPrice = prices[categoryId] });
                    items.Add(item);
                }

                CalcSection1(items, context, year, month, orgId, userId, postPercent);

                CalcSection2(items, context, year, month, orgId, userId, postPercent);

                CalcFields(items, report, reportItemList);

                items.Reverse();
                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return reportItemList;
            }

            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                int i = 0;
                foreach (var item in items)
                {
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                    FieldsInit(item, _item);
                    i++;
                }
            }

            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                public decimal Percent { get; set; }
                public string Category { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmountPercent { get; set; }
                public decimal PaymentPrice { get; set; }
                public decimal NeedAmount { get; set; }
                public int DocCount { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }
                public decimal PostNeedAmount { get; set; }
                public int PostDocCount { get; set; }
                public int PostSection1DocCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public decimal PostSection1NeedAmountPercent { get; set; }
                public int PostSection1MonthCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public int PostSection2AppCount { get; set; }
                public int PostSection2MonthCount { get; set; }
                public decimal PostSection2NeedAmountPercent { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public int PostSection2DocCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public int BankDocCount { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmount { get; set; }
                public int BankSection2DocCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2NeedAmountPercent { get; set; }
                public int BankSection2MonthCount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public int BankSection1DocCount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public decimal BankSection1NeedAmountPercent { get; set; }
                public int BankSection1AppCount { get; set; }
                public int BankSection1MonthCount { get; set; }
            }

            private static void FieldsInit(Doc item, ReportItem _item = null)
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }

            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despAksyPaymentTypeId);
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty)
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория не найдена.");
                    var item = items[categoryTypes.IndexOf(categoryId)];
                    var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                    var field = orderTypeName + "Section" + sNum + "AppCount";
                    item[field] = ((int?)item[field] ?? 0) + count;
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despAksyPaymentTypeId);
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    Doc item = items[categoryTypes.IndexOf(categoryId)];
                    item[orderTypeName + "Section2DocCount"] = docCount;
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
            }

            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despAksyPaymentTypeId);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * postPercent;

                        var item = items[categoryTypes.IndexOf(categoryId)];
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despAksyPaymentTypeId);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent;
                        double.TryParse(row[1].ToString(), out percent);
                        Guid categoryId;
                        Guid.TryParse(row[2].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * (decimal)percent;

                        var item = items[categoryTypes.IndexOf(categoryId)];
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                }
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").Eq(despAksyPaymentTypeId);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0 : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ДЕСП. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        public static class AdditionalSocialBenefitsReport1
        {
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {

                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);
                }
                catch (Exception ex)
                {
                    throw new ApplicationException(ex.TargetSite.Name + "; " + ex.Message);
                }
            }
            private static readonly Guid despPaymentTypeId = new Guid("{272F8D91-5B4B-42AC-9D79-A17E77F5496E}");
            // Document Defs                                                    
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{9580E9AE-5949-4B83-90F0-EED511B63477}");
            private static readonly Guid reportItemDefId = new Guid("{D2FCA75E-34E4-4E85-93B5-6917C4F18BC2}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            private static readonly Guid categoryType1Id = new Guid("{608F740E-C44B-4305-88E8-F53D497214C0}");//Дети погибшего в событиях 2010 г. до 18 лет
            private static readonly Guid categoryType2Id = new Guid("{238BD896-A3B7-494D-B549-4AAC292EE8F5}");//Родители погибшего ед. ребенка в событиях 2010 г. по достижении пенсионного возраста
            private static readonly Guid categoryType3Id = new Guid("{ECDF4DE6-299E-4C6A-843F-49362C32EB96}");//Получившие вред здоровью в событиях 2010 г., имеющие заключение СМЭ
            private static readonly Guid categoryType4Id = new Guid("{7D08F570-239D-46BF-BF4F-6E3A510ACCD2}");//Признанные ЛОВЗ в следствие событий 2010 г.
            private static readonly List<object> categoryTypes = new List<object>
            {
            categoryType1Id, categoryType2Id, categoryType3Id, categoryType4Id
            };

            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }
            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();
                }

                Dictionary<Guid, Decimal> prices = GetPriceList(userId, month, year, context);

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();
                var reportItemList = new List<ReportItem>();

                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    Doc item = docRepo.New(reportItemDefId);
                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    reportItemList.Add(new ReportItem { Category = context.Enums.GetValue(categoryId).Value, PaymentPrice = prices[categoryId] });
                    items.Add(item);
                }
                CalcSection1(items, context, year, month, orgId, userId, postPercent);
                CalcSection2(items, context, year, month, orgId, userId, postPercent);
                CalcFields(items, report, reportItemList);

                items.Reverse();
                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return reportItemList;
            }

            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                int i = 0;
                foreach (var item in items)
                {
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                    FieldsInit(item, _item);
                    i++;
                }
            }

            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                public decimal Percent { get; set; }
                public string Category { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmountPercent { get; set; }
                public decimal PaymentPrice { get; set; }
                public decimal NeedAmount { get; set; }
                public int DocCount { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }
                public decimal PostNeedAmount { get; set; }
                public int PostDocCount { get; set; }
                public int PostSection1DocCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public decimal PostSection1NeedAmountPercent { get; set; }
                public int PostSection1MonthCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public int PostSection2AppCount { get; set; }
                public int PostSection2MonthCount { get; set; }
                public decimal PostSection2NeedAmountPercent { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public int PostSection2DocCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public int BankDocCount { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmount { get; set; }
                public int BankSection2DocCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2NeedAmountPercent { get; set; }
                public int BankSection2MonthCount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public int BankSection1DocCount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public decimal BankSection1NeedAmountPercent { get; set; }
                public int BankSection1AppCount { get; set; }
                public int BankSection1MonthCount { get; set; }
            }

            private static void FieldsInit(Doc item, ReportItem _item = null)
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }

            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despPaymentTypeId);
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty)
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория не найдена.");
                    var item = items[categoryTypes.IndexOf(categoryId)];
                    var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                    var field = orderTypeName + "Section" + sNum + "AppCount";
                    item[field] = ((int?)item[field] ?? 0) + count;
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despPaymentTypeId);
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
               // var appNo = query.AddAttribute(appSrc, "RegNo");
                query.AddGroupAttribute(appPaymentAttr);

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = row[0] is DBNull ? 0 : (int)row[0];
                    string regNo = row[1] is DBNull ? "" : (string)row[1];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    Doc item = items[categoryTypes.IndexOf(categoryId)];
                    item[orderTypeName + "Section2DocCount"] = docCount;
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
            }

            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                        canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despPaymentTypeId);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * postPercent;

                        var item = items[categoryTypes.IndexOf(categoryId)];
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                        canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, despPaymentTypeId);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent;
                        double.TryParse(row[1].ToString(), out percent);
                        Guid categoryId;
                        Guid.TryParse(row[2].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * (decimal)percent;

                        var item = items[categoryTypes.IndexOf(categoryId)];
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                }
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").Eq(despPaymentTypeId);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0 : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ДЕСП. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        public static class SocialBenefitsReport1
        {
            // Виды выплат
            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");

            private static readonly Guid alpineRetirementCategoryId = new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}");
            private static readonly Guid retirementCategoryId = new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}");
            private static readonly Guid heroMotherCategoryId = new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}");
            private static readonly Guid childDisableCategoryId = new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}");
            private static readonly Guid orphanChildren = new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}");
            private static readonly Guid childSurvivorsCategoryId = new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}");
            private static readonly Guid childFromAidsCategoryId = new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}");
            private static readonly Guid childenAidsCategoryId = new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}");
            private static readonly Guid childISPCategoryId = new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}");
            private static readonly Guid childhood1CategoryId = new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}");
            private static readonly Guid childhood2CategoryId = new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}");
            private static readonly Guid childhood3CategoryId = new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}");
            private static readonly Guid commonDeseas1CategoryId = new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}");
            private static readonly Guid commonDeseas2CategoryId = new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}");
            private static readonly Guid commonDeseas3CategoryId = new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}");
            private static readonly Guid hearDisabled1CategoryId = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");
            private static readonly Guid hearDisabled2CategoryId = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");
            private static readonly Guid hearDisabled3CategoryId = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");
            private static readonly Guid eyesDisabled1CategoryId = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");
            private static readonly Guid eyesDisabled2CategoryId = new Guid("{947E64F0-18EC-4A6B-80C0-FCECFE7C67C2}");
            private static readonly Guid eyesDisabled3CategoryId = new Guid("{8B787FCA-62EE-4261-9094-1FFAC1BF4C02}");

            public static List<object> categoryTypes = new List<object>
            {
                heroMotherCategoryId,
                alpineRetirementCategoryId,
                retirementCategoryId,
                orphanChildren,
                childSurvivorsCategoryId,
                commonDeseas3CategoryId,
                commonDeseas2CategoryId,
                commonDeseas1CategoryId,
                childhood3CategoryId,
                childhood2CategoryId,
                childhood1CategoryId,
                childenAidsCategoryId,
                childFromAidsCategoryId,
                childISPCategoryId,
                childDisableCategoryId
            };
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");
            private static readonly Guid reportItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);
                }
                catch (Exception ex)
                {
                    throw new ApplicationException("TargetSite: " + ex.TargetSite.Name + "; Message: " + ex.Message);
                }
            }
            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }
            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();
                }

                var prices = GetPriceList(userId, month, year, context);

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();
                List<ReportItem> _items = new List<ReportItem>();

                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    var item = docRepo.New(reportItemDefId);
                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    var _item = new ReportItem { RowName = context.Enums.GetValue(categoryId).Value }; //*
                    items.Add(item);
                    _items.Add(_item);
                    _items.Reverse();
                    items.Reverse();
                }

                CalcSection1(items, context, year, month, orgId, userId, postPercent);

                CalcSection2(items, context, year, month, orgId, userId, postPercent);

                CalcFields(items, report, _items);

                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return _items;
            }

            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                foreach (var item in items)
                {
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                }
            }
            private static void FieldsInit(Doc item, ReportItem _item = null)//*
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }
            public class ReportItem
            {
                public string RowName { get; set; }
                public int DocCount { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmount { get; set; }
                public decimal Percent { get; set; }
                public decimal NeedAmountPercent { get; set; }

                public int PostSection1MonthCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public int PostSection2DocCount { get; set; }
                public int PostSection2AppCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostNeedAmount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }

                public int BankSection1MonthCount { get; set; }
                public int BankSection1AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public int BankSection2DocCount { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public decimal BankNeedAmount { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
            }
            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                        canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                {
                    retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                });
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    try
                    {
                        var item = GetItemByCategory(items, categoryId);
                        var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                        var field = orderTypeName + "Section" + sNum + "AppCount";
                        item[field] = ((int?)item[field] ?? 0) + count;
                    }
                    catch
                    {
                        throw new Exception(context.Enums.GetValue(categoryId).Value);
                        continue;
                    }
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                        canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                {
                    retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                });
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    try
                    {
                        var item = GetItemByCategory(items, categoryId);
                        item[orderTypeName + "Section2DocCount"] = docCount;
                    }
                    catch
                    {
                        throw new Exception(context.Enums.GetValue(categoryId).Value);
                        continue;
                    }
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
            }
            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                        canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                    {
                        retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                        aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                    });
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    //query.AddAttribute("Amount");
                    //query.AddAttribute(appSrc, "RegNo");
                    //query.AddAttribute(appSrc, "PaymentSum");
                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    string text = "";
                    decimal sum = 0m;
                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        /* if (categoryId == new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}"))//lj 18 лет
                         {                                                                   
                             var regNo = row[2] is DBNull ? "" : row[2].ToString();
                             decimal paySum = row[3] is DBNull ? 0 : (decimal)row[3];
                             text+= "[" + amount + ", " + regNo + ", сназ " + paySum + "]";
                             sum+= amount;           

                         } */
                        decimal service = (amount / 100) * postPercent;
                        try
                        {
                            var item = GetItemByCategory(items, categoryId);
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                       canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                    {
                    retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                    });
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent;
                        double.TryParse(row[1].ToString(), out percent);
                        Guid categoryId;
                        Guid.TryParse(row[2].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * (decimal)percent;
                        try
                        {
                            var item = GetItemByCategory(items, categoryId);
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                }
            }
            private static Doc GetItemByCategory(List<Doc> items, Guid categoryId)
            {
                if ((new[] { commonDeseas1CategoryId, hearDisabled1CategoryId, eyesDisabled1CategoryId }).Contains(categoryId))
                    return items[categoryTypes.IndexOf(commonDeseas1CategoryId)];
                else if ((new[] { commonDeseas2CategoryId, hearDisabled2CategoryId, eyesDisabled2CategoryId }).Contains(categoryId))
                    return items[categoryTypes.IndexOf(commonDeseas2CategoryId)];
                else if ((new[] { commonDeseas3CategoryId, hearDisabled3CategoryId, eyesDisabled3CategoryId }).Contains(categoryId))
                    return items[categoryTypes.IndexOf(commonDeseas3CategoryId)];
                else
                    return items[categoryTypes.IndexOf(categoryId)];
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").In(new object[]
            {
            retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
            aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
            });
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0 : (decimal)row[1]);
                    }
                }
                return catList;
            }
            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        public static class LifetimeGrantReport1
        {
            // Виды выплат                             
            public static readonly Guid lifetimeGrantPayment = new Guid("{3DB68E47-2451-43E0-AB98-9A59C8B52686}");
            //Categories
            private static readonly Guid category1 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");
            private static readonly Guid category2 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");
            private static readonly Guid category3 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");
            private static readonly Guid category4 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");
            private static readonly Guid category5 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");
            private static readonly Guid category6 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");
            private static readonly List<object> categoryTypes = new List<object>
            {
            category1,category2,category3,category4,category5,category6
            };
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{86122C43-3E74-4A03-9F87-B29D1DA32961}");
            private static readonly Guid reportItemDefId = new Guid("{5251BDA5-6302-4086-ADE3-022C98F219DA}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {

                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);
                }
                catch (Exception ex)
                {
                    throw new ApplicationException(ex.Message);
                }
            }

            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }
            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();
                }

                Dictionary<Guid, Decimal> prices = GetPriceList(userId, month, year, context);

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();
                var reportItemList = new List<ReportItem>();
                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    Doc item = docRepo.New(reportItemDefId);
                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    reportItemList.Add(new ReportItem { Category = context.Enums.GetValue(categoryId).Value, PaymentPrice = prices[categoryId] });
                    items.Add(item);
                }

                CalcSection1(items, context, year, month, orgId, userId, postPercent);

                CalcSection2(items, context, year, month, orgId, userId, postPercent);

                CalcFields(items, report, reportItemList);

                items.Reverse();
                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return reportItemList;
            }

            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                int i = 0;
                foreach (var item in items)
                {
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                    FieldsInit(item, _item);
                    i++;
                }
            }

            private static void FieldsInit(Doc item, ReportItem _item = null)
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }

            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                public decimal Percent { get; set; }
                public string Category { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmountPercent { get; set; }
                public decimal PaymentPrice { get; set; }
                public decimal NeedAmount { get; set; }
                public int DocCount { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }
                public decimal PostNeedAmount { get; set; }
                public int PostDocCount { get; set; }
                public int PostSection1DocCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public decimal PostSection1NeedAmountPercent { get; set; }
                public int PostSection1MonthCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public int PostSection2AppCount { get; set; }
                public int PostSection2MonthCount { get; set; }
                public decimal PostSection2NeedAmountPercent { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public int PostSection2DocCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public int BankDocCount { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmount { get; set; }
                public int BankSection2DocCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2NeedAmountPercent { get; set; }
                public int BankSection2MonthCount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public int BankSection1DocCount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public decimal BankSection1NeedAmountPercent { get; set; }
                public int BankSection1AppCount { get; set; }
                public int BankSection1MonthCount { get; set; }
            }

            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, lifetimeGrantPayment);
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty)
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория не найдена.");
                    var item = items[categoryTypes.IndexOf(categoryId)];
                    var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                    var field = orderTypeName + "Section" + sNum + "AppCount";
                    item[field] = ((int?)item[field] ?? 0) + count;
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, lifetimeGrantPayment);
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    Doc item = items[categoryTypes.IndexOf(categoryId)];
                    item[orderTypeName + "Section2DocCount"] = docCount;
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
            }

            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, lifetimeGrantPayment);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * postPercent;

                        var item = items[categoryTypes.IndexOf(categoryId)];
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, lifetimeGrantPayment);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent;
                        double.TryParse(row[1].ToString(), out percent);
                        Guid categoryId;
                        Guid.TryParse(row[2].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * (decimal)percent;

                        var item = items[categoryTypes.IndexOf(categoryId)];
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                }
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").Eq(lifetimeGrantPayment);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0 : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ПС. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        public static class AdditionalLifetimeGrantReport1
        {
            // Виды выплат                             
            public static readonly Guid additionalLifetimeGrantPayment = new Guid("{A72AA579-7F1A-4BCE-A6C0-A081B13AAD8F}");
            //Categories
            private static readonly Guid category1 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");
            private static readonly Guid category2 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");
            private static readonly Guid category3 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");
            private static readonly Guid category4 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");
            private static readonly Guid category5 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");
            private static readonly Guid category6 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");
            private static readonly List<object> categoryTypes = new List<object>
            {
            category1,category2,category3,category4,category5,category6
            };
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {

                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);
                }
                catch (Exception ex)
                {
                    throw new ApplicationException(ex.Message);
                }
            }

            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }

            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");

                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();
                }
                var prices = GetPriceList(userId, month, year, context);

                var postPercent = GetPostPercent(year, month, userId, context);
                var items = new List<Doc>();
                var reportItemList = new List<ReportItem>();

                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    Doc item = docRepo.New(reportItemDefId);
                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    reportItemList.Add(new ReportItem { Category = context.Enums.GetValue(categoryId).Value, PaymentPrice = prices[categoryId] });
                    items.Add(item);
                }

                CalcSection1(items, context, year, month, orgId, userId, postPercent);

                CalcSection2(items, context, year, month, orgId, userId, postPercent);

                CalcFields(items, report, reportItemList);

                items.Reverse();
                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return reportItemList;
            }

            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }

            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }

            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                int i = 0;
                foreach (var item in items)
                {
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                    FieldsInit(item, _item);
                    i++;
                }
            }

            private static void FieldsInit(Doc item, ReportItem _item = null)
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }
            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                public decimal Percent { get; set; }
                public string Category { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmountPercent { get; set; }
                public decimal PaymentPrice { get; set; }
                public decimal NeedAmount { get; set; }
                public int DocCount { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }
                public decimal PostNeedAmount { get; set; }
                public int PostDocCount { get; set; }
                public int PostSection1DocCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public decimal PostSection1NeedAmountPercent { get; set; }
                public int PostSection1MonthCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public int PostSection2AppCount { get; set; }
                public int PostSection2MonthCount { get; set; }
                public decimal PostSection2NeedAmountPercent { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public int PostSection2DocCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public int BankDocCount { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmount { get; set; }
                public int BankSection2DocCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2NeedAmountPercent { get; set; }
                public int BankSection2MonthCount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public int BankSection1DocCount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public decimal BankSection1NeedAmountPercent { get; set; }
                public int BankSection1AppCount { get; set; }
                public int BankSection1MonthCount { get; set; }
            }

            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, additionalLifetimeGrantPayment);
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty)
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория не найдена.");
                    Doc item;
                    try
                    {
                        item = items[categoryTypes.IndexOf(categoryId)];
                    }
                    catch
                    {
                        continue;
                    }
                    var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                    var field = orderTypeName + "Section" + sNum + "AppCount";
                    item[field] = ((int?)item[field] ?? 0) + count;
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);
            }

            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, additionalLifetimeGrantPayment);
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    Doc item;
                    try
                    {
                        item = items[categoryTypes.IndexOf(categoryId)];
                    }
                    catch
                    {
                        continue;
                    }
                    item[orderTypeName + "Section2DocCount"] = docCount;
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
            }

            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, additionalLifetimeGrantPayment);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);

                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");

                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * postPercent;

                        Doc item;
                        try
                        {
                            item = items[categoryTypes.IndexOf(categoryId)];
                        }
                        catch
                        {
                            continue;
                        }
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, additionalLifetimeGrantPayment);
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent;
                        double.TryParse(row[1].ToString(), out percent);
                        Guid categoryId;
                        Guid.TryParse(row[2].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * (decimal)percent;

                        Doc item;
                        try
                        {
                            item = items[categoryTypes.IndexOf(categoryId)];
                        }
                        catch
                        {
                            continue;
                        }
                        item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                        item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                    }
                }
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").Eq(additionalLifetimeGrantPayment);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0 : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ПС. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }
        

        /*ОТЧЕТНОСТЬ 2022***************************************************************************************************/
        public static class MonthlyFC_1001
        {
            private static readonly Guid privilege46PaymentId = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");

            private static readonly Guid reportDefId = new Guid("{4447EA34-67AB-46F2-BE03-A406CAC4EABC}"); //Заявка на финансирование ДК
            private static readonly Guid reportItemDefId = new Guid("{66605D33-A39E-4709-8534-C1505C041182}");
            private static readonly Guid reportShortDefId = new Guid("{5DC7BAD3-F6D7-4BF8-87BE-DA3D719917AC}"); //Строка заявки на финансирование ДК (краткая)
            private static readonly Guid reportItemShortDefId = new Guid("{7AC9E5A3-9FD3-4400-998B-7583FC130470}"); //Строка заявки на финансирование ДК (краткая)
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static Guid cat1 = new Guid("{F080A1B0-9AA9-4339-B0B1-11D9541B28ED}");//Инвалиды ВОВ
            private static Guid cat2 = new Guid("{86114020-3577-46D4-85C2-7BB9D463FEFC}");//Участники ВОВ
            private static Guid cat3 = new Guid("{51377AAE-DD99-4CB9-82BF-E11FDE545147}");//Герои КР, Советского союза
            private static Guid cat4 = new Guid("{063FF85F-EFEE-4562-80A2-EE72C7442449}");//Несовершеннолетние узники концлагерей
            private static Guid cat5 = new Guid("{F7D81582-3F23-47F4-95CF-B4B9B275770B}");//Блокадники Ленинграда
            private static Guid cat6 = new Guid("{118CD71F-B219-47DA-B6F4-EA4467DD3B3A}");//Инвалиды СА
            private static Guid cat7 = new Guid("{1DF503C7-C53E-4892-A5E0-A1B956718A7B}");//Инвалиды-интернационалисты
            private static Guid cat8 = new Guid("{C11F38A5-5418-4455-9DCA-22F81513699B}");//Участники-интернационалисты
            private static Guid cat9 = new Guid("{55F9BB9F-4DBC-4DFA-9ED2-968C8F82E58A}");//Инвалиды ЧАЭС
            private static Guid cat10 = new Guid("{0224C18D-7654-4F92-B7E8-8B44C056F469}");//Участники ЧАЭС 1986-87 гг.
            private static Guid cat11 = new Guid("{4BD28541-094B-49A3-90B8-DD9FF6CFB997}");//Труж. тыла с группой инвалидности
            private static Guid cat12 = new Guid("{E7498511-A118-44B4-9407-E455F705515D}");//Трудармейцы
            private static Guid cat13 = new Guid("{32A216E3-081E-49C0-BBE2-4E7DCAA4F0FE}");//Реабилитированные граждане
            private static Guid cat14 = new Guid("{15613E81-FA2D-460C-A0DC-C9EA5FFA40A2}");//Участники ЧАЭС 1988-89 гг.
            private static Guid cat15 = new Guid("{3CE57669-237A-4CD2-8BAA-AA3FEFEB96C3}");//СП участников и умерших инв. ЧАЭС                 
            private static Guid cat16 = new Guid("{9BF497E9-04F9-4D02-81C1-7044A810B561}");//Дети до 18 лет участников ЧАЭС
            private static Guid cat17 = new Guid("{7FF0BFF7-CBF5-4ABB-899A-8F1A0A292A2A}");//Труженники тыла (без инвал.)
            private static Guid cat18 = new Guid("{A3EFED3D-0651-487D-AF4F-70D43508A47C}");//Семьи погибших военнослужащих
            private static Guid cat19 = new Guid("{B8497A2E-9C9F-4DEB-B521-8DDA3E7594D9}");//Семьи погибших воинов в ВОВ
            private static Guid cat20 = new Guid("{46A029B0-9A62-4E7D-A875-F2F33B1262EE}");//Семьи погибших сотрудников ОВД
            private static Guid cat21 = new Guid("{EFD864F1-F6CA-4CEE-A640-B7455396AE32}");//Вдовы ИВОВ
            private static Guid cat22 = new Guid("{DA73BA19-D8C6-449A-825E-D446523BD0EA}");//Вдовы УВОВ
            private static Guid cat23 = new Guid("{0A87F5D6-603F-4E26-B2FC-84812A8739FC}");//Вдовы блок. Ленинграда
            private static Guid cat24 = new Guid("{3A503598-29D8-4570-8250-969341E32B5A}");//Почетные доноры
            private static Guid cat25 = new Guid("{D2A3B9DD-120C-4597-A09A-C5F04B22B39E}");//Инвалиды по слуху и зрению
            private static Guid cat26 = new Guid("{C7FA81F8-D1BF-4371-9271-9BDA49AF16AE}");//В т.ч. инв. с детства по сл. и зр. до 18 лет
            private static Guid catTotal = new Guid("{419C6C7E-2790-486B-8A7B-0D6C2C61EF0A}");//Всего
            private static List<object> categoryTypes = new List<object>
            {
                cat1, cat2, cat3, cat4, cat5, cat6, cat7, cat8, cat9, cat10, cat11, cat12, cat13, cat14, cat15, cat16, cat17, cat18, cat19, cat20, cat21, cat22, cat23, cat24, cat25, cat26, catTotal
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportShortDefId);
                qb.Where("Original").Include("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month).End();

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemDefSrc = query.JoinSource(query.Source, reportItemShortDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(itemDefSrc, "Category");
                query.AddAttribute(itemDefSrc, "AppCount");
                //query.AddAttribute(itemDefSrc, "PaymentPrice");

                var tempList = new List<TempItem>();

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var appId = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var categoryId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var appCount = reader.IsDbNull(3) ? 0 : reader.GetInt32(3);

                        if (orgId == Guid.Empty) continue;
                        tempList.Add(new TempItem
                        {
                            CategoryId = categoryId,
                            OrgId = orgId,
                            AppCount = appCount
                        });
                    }
                }
                Dictionary<Guid, Decimal> prices = GetPriceList(month, year, context);
                int counter = 1;
                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    if (!prices.ContainsKey(categoryId)) continue;
                    var item = new ReportItem
                    {
                        CategoryName = context.Enums.GetValue(categoryId).Value,
                        Price = prices[categoryId]
                    };

                    var subItems = tempList.Where(x => x.CategoryId == categoryId);
                    item.Total = subItems.Sum(x => x.AppCount);
                    item.c_Bishkek = GetDetailRegion(subItems, bishkekList);
                    item.r_Chui = GetDetailRegion(subItems, chuiList);
                    item.r_Talas = GetDetailRegion(subItems, talasList);
                    item.r_IK = GetDetailRegion(subItems, issyk_kulList);
                    item.r_Naryn = GetDetailRegion(subItems, narynList);
                    item.r_Batken = GetDetailRegion(subItems, batkenList);
                    item.r_Osh = GetDetailRegion(subItems, oshList);
                    item.c_Osh = GetDetailRegion(subItems, osh);
                    item.r_JA = GetDetailRegion(subItems, jalal_abad);

                    item.RowNo = counter;
                    items.Add(item);
                    counter++;
                }
                return items;
            }
            private static Dictionary<Guid, Decimal> GetPriceList(int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                var qb = new QueryBuilder(reportShortDefId);
                qb.Where("Original").Include("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month).End();

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemDefSrc = query.JoinSource(query.Source, reportItemShortDefId, SqlSourceJoinType.Inner, "Rows");
                query.AddAttribute(itemDefSrc, "Category");
                query.AddAttribute(itemDefSrc, "PaymentPrice");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0m : (decimal)row[1]);
                    }
                }
                return catList;
            }
            private static Region GetDetailRegion(IEnumerable<TempItem> subItems, List<Guid> regionList)
            {
                Region region = new Region(regionList);
                foreach (RegionReportItem districtItem in region.RegionList)
                {
                    districtItem.AppCounter = subItems.Where(x => x.OrgId == districtItem.GetDistrictId()).Sum(x => x.AppCount);
                }
                region.RegionList = region.RegionList;
                region.RegionTotal = subItems.Where(x => regionList.Contains(x.OrgId)).Sum(x => x.AppCount);
                return region;
            }
            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
                //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
                //new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
                //new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                //new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
                //new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                //new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                //new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                //new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public class TempItem
            {
                public Guid CategoryId { get; set; }
                public Guid OrgId { get; set; }
                public int AppCount { get; set; }
            }
            public class ReportItem
            {
                public int RowNo { get; set; }
                public string CategoryName { get; set; }
                public decimal Price { get; set; }
                public int Total { get; set; }
                public Region c_Bishkek { get; set; }
                public Region r_Chui { get; set; }
                public Region r_Talas { get; set; }
                public Region r_IK { get; set; }
                public Region r_Naryn { get; set; }
                public Region r_Batken { get; set; }
                public Region r_Osh { get; set; }
                public Region c_Osh { get; set; }
                public Region r_JA { get; set; }
            }

            [DataContract]
            public class Region
            {
                [DataMember]
                public int RegionTotal { get; set; }
                [DataMember]
                public List<RegionReportItem> RegionList { get; set; }

                public Region(List<Guid> _regionList)
                {
                    RegionList = new List<RegionReportItem>();
                    foreach (Guid districtId in _regionList)
                    {
                        RegionReportItem item = new RegionReportItem(districtId);
                        item.DistrictName = GetNameByCategoryId(districtId);
                        item.AppCounter = 0;
                        RegionList.Add(item);
                    }
                }
            }
            public static string GetNameByCategoryId(Guid regionGuid)
            {
                if (regionGuid.Equals(new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}")))
                    return "Ленинский";
                else if (regionGuid.Equals(new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}")))
                    return "Первомайский";
                else if (regionGuid.Equals(new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}")))
                    return "Свердловский";
                else if (regionGuid.Equals(new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}")))
                    return "Октябрьский";
                else if (regionGuid.Equals(new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}")))
                    return "Кемин";
                else if (regionGuid.Equals(new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}")))
                    return "Чуй";
                else if (regionGuid.Equals(new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}")))
                    return "Токмок";
                else if (regionGuid.Equals(new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}")))
                    return "Ыссык-Ата";
                else if (regionGuid.Equals(new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}")))
                    return "Аламудун";
                else if (regionGuid.Equals(new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}")))
                    return "Сокулук";
                else if (regionGuid.Equals(new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}")))
                    return "Москва";
                else if (regionGuid.Equals(new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}")))
                    return "Жайыл";
                else if (regionGuid.Equals(new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}")))
                    return "Панфилов";
                else if (regionGuid.Equals(new Guid("{02992EB8-E107-408E-954E-E322A73B433A}")))
                    return "г.Талас";
                else if (regionGuid.Equals(new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}")))
                    return "Талас";
                else if (regionGuid.Equals(new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}")))
                    return "БакайАта";
                else if (regionGuid.Equals(new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}")))
                    return "Кара-Буура";
                else if (regionGuid.Equals(new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}")))
                    return "Манас";
                else if (regionGuid.Equals(new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}")))
                    return "Каракол";
                else if (regionGuid.Equals(new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}")))
                    return "Балыкчы";
                else if (regionGuid.Equals(new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}")))
                    return "Ыссык-Куль";
                else if (regionGuid.Equals(new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}")))
                    return "Тюп";
                else if (regionGuid.Equals(new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}")))
                    return "Жети-Огуз";
                else if (regionGuid.Equals(new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}")))
                    return "Тон";
                else if (regionGuid.Equals(new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}")))
                    return "Ак-Суу";
                else if (regionGuid.Equals(new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}")))
                    return "Ак-Талаа";
                else if (regionGuid.Equals(new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}")))
                    return "Ат-Баши";
                else if (regionGuid.Equals(new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}")))
                    return "Жумгал";
                else if (regionGuid.Equals(new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}")))
                    return "Кочкор";
                else if (regionGuid.Equals(new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}")))
                    return "Нарын";
                else if (regionGuid.Equals(new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}")))
                    return "г.Нарын";
                else if (regionGuid.Equals(new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}")))
                    return "Баткен";
                else if (regionGuid.Equals(new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}")))
                    return "г.Баткен";
                else if (regionGuid.Equals(new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}")))
                    return "Кадамжай";
                else if (regionGuid.Equals(new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}")))
                    return "Лейлек";
                else if (regionGuid.Equals(new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}")))
                    return "Кызыл-Кия";
                else if (regionGuid.Equals(new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}")))
                    return "Сулюкта";
                else if (regionGuid.Equals(new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}")))
                    return "Араван";
                else if (regionGuid.Equals(new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}")))
                    return "Кара-Кулджа";
                else if (regionGuid.Equals(new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}")))
                    return "Кара-Суу";
                else if (regionGuid.Equals(new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}")))
                    return "Ноокат";
                else if (regionGuid.Equals(new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}")))
                    return "Узген";
                else if (regionGuid.Equals(new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}")))
                    return "г.Узген";
                else if (regionGuid.Equals(new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}")))
                    return "Алай";
                else if (regionGuid.Equals(new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")))
                    return "Чон-Алай";
                else if (regionGuid.Equals(new Guid("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")))
                    return "г.Ош";
                else if (regionGuid.Equals(new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}")))
                    return "г.Джалал-Абад";
                else if (regionGuid.Equals(new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}")))
                    return "Кок-Жангак";
                else if (regionGuid.Equals(new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}")))
                    return "Майлы-Суу";
                else if (regionGuid.Equals(new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}")))
                    return "Таш-Кумыр";
                else if (regionGuid.Equals(new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}")))
                    return "Кара-Куль";
                else if (regionGuid.Equals(new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}")))
                    return "Сузак";
                else if (regionGuid.Equals(new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}")))
                    return "Базар-Коргон";
                else if (regionGuid.Equals(new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}")))
                    return "Ноокен";
                else if (regionGuid.Equals(new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}")))
                    return "Аксы";
                else if (regionGuid.Equals(new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}")))
                    return "Ала-Бука";
                else if (regionGuid.Equals(new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}")))
                    return "Чаткал";
                else if (regionGuid.Equals(new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}")))
                    return "Токтогул";
                else if (regionGuid.Equals(new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")))
                    return "Тогуз-Торо";
                else return "";
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem(Guid districtId)
                {
                    DistrictId = districtId;
                }
                [DataMember]
                public string DistrictName { get; set; }
                private Guid DistrictId { get; set; }
                public Guid GetDistrictId()
                {
                    return DistrictId;
                }
                [DataMember]
                public int AppCounter { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class MonthlyDK_1002
        {
            private static readonly Guid privilege46PaymentId = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");//Денежная компенсация взамен льгот
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
                                                                                                              //Categories
            private static Guid category1 = new Guid("{2E662509-144D-47CA-9F2B-087BB6F4AE91}");//Участник ликвидации последствий аварии на ЧАЭЗ 1989 г.
            private static Guid category2 = new Guid("{DF92F99F-BA8D-415C-8236-F54206AF0F73}");//Участник ликвидации последствий аварии на ЧАЭЗ 1988 г.
            private static Guid category3 = new Guid("{8691D5FB-7611-4AAA-AD84-60D2AADF50BE}");//Участник ликвидации последствий аварии на ЧАЭЗ 1986-87 гг.
            private static Guid category4 = new Guid("{63DFD63A-2868-411F-A52F-039E37B1D39F}");//Участник ВОВ, награжденный орденами славы 3-х степеней
            private static Guid category5 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");//Участник ВОВ
            private static Guid category6 = new Guid("{7EE64986-5A47-49D0-A288-88A537E6D0A0}");//Участник боевых действий на территории других государств
            private static Guid category7 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");//Участник блокады г.Ленинграда
            private static Guid category8 = new Guid("{8C21641E-1AC2-438A-ABDB-D6D17D195BB5}");//Семьям погибших военнослужащих при исполнении обязанностей военной службы
            private static Guid category9 = new Guid("{ECD8E6DF-3C3E-427D-BDC1-58E132A8B03D}");//Семья, потерявшая кормильца - участника ЧАЭС
            private static Guid category10 = new Guid("{93B5323F-E16B-4A76-AEB6-7CE166B0471B}");//Семья погибшего/пропавшего без вести в ВОВ военнослужащего
            private static Guid category11 = new Guid("{B038B840-021C-436E-B34D-4EB0E90DB767}");//Семьи сотрудников МВД, погибших при исполнении сл. обяз. или сл.долга, умерших после увольн. вслед-е ран./трав./забол., получ. в пер.прохожд.службы
            private static Guid category12 = new Guid("{C5728DEE-CE74-41C2-A0CF-B1182615D6B3}");//Реабилитированный, пострадавший в результате репрессий
            private static Guid category13 = new Guid("{24D5389C-9102-4369-A978-E2EF7DFC36C8}");//Почетный донор
            private static Guid category14 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");//Несовершеннолетний узник концлагерей, гетто
            private static Guid category15 = new Guid("{FA1787EF-A156-400E-8CA3-436203D3C322}");//ЛОВЗ Сов.Армии 3 гр. (во время несения службы)
            private static Guid category16 = new Guid("{22CB5768-069B-4E18-9F4C-D3F308AF4E3F}");//ЛОВЗ Сов.Армии 2 гр. (во время несения службы)
            private static Guid category17 = new Guid("{1EA3FA92-E895-4A9D-AD5F-72FE1EE3D5BF}");//ЛОВЗ Сов.Армии 1 гр. (во время несения службы)
            private static Guid category18 = new Guid("{CBD190B1-44AD-4E6B-8B79-34BF60619CF5}");//ЛОВЗ по слуху и зрению до 18 лет
            private static Guid category19 = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");//ЛОВЗ 3 гр. по слуху
            private static Guid category21 = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");//ЛОВЗ 2 гр. по слуху
            private static Guid category23 = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");//ЛОВЗ 1 гр. по слуху
            private static Guid category20 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 3 гр. по зрению
            private static Guid category22 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 2 гр. по зрению
            private static Guid category24 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 1 гр. по зрению
            private static Guid category25 = new Guid("{A4B6BC13-479B-468F-B4EB-D661417B1127}");//Лица, награжденные за работу/службу в тылу в годы ВОВ с группой инв.
            private static Guid category26 = new Guid("{891911A4-C7C9-4E8D-919B-6AE2B7DE1AB7}");//Лица, награжденные за работу/службу в тылу в годы ВОВ без группы инв-ти
            private static Guid category27 = new Guid("{76668EA1-47E2-4F09-AD73-4AF24BF0D55C}");//Лица заболевшие лучевой болезнью (ЧАЭС)
            private static Guid category28 = new Guid("{E14662C0-719D-4B26-886F-55C8BD43A11E}");//Инвалид-реабилитиров., пострадавший в результате репрессий
            private static Guid category29 = new Guid("{BFE0BD8C-032D-4DF2-ACC1-60F2385925E9}");//Инвалид Советской армии при исполнении служеб. Обязанности
            private static Guid category30 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");//Инвалид ВОВ 3 группы
            private static Guid category31 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");//Инвалид ВОВ 2 группы
            private static Guid category32 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");//Инвалид ВОВ 1 группы
            private static Guid category33 = new Guid("{7CC482B7-A2FD-4B2E-8BFE-9CF0B96D8E05}");//Инв.3 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category35 = new Guid("{69E2D977-7C5A-4315-BF6A-6E790D19D7EC}");//Инв.2 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category38 = new Guid("{0A8D29A0-4806-422B-89EF-8F11AE835098}");//Инв.1 гр. - участник ликвидации последствий аварии на ЧАЭC
            private static Guid category34 = new Guid("{8828EAF5-5884-4BB0-B097-3D65496E4168}");//Инв.3 гр.-участник боевых действий на террит.др.государств
            private static Guid category36 = new Guid("{EB091676-B785-42AC-A330-44DFFBFDE1F6}");//Инв.2 гр.-участник боевых действий на террит.др.государств
            private static Guid category37 = new Guid("{3F0DD390-EFF5-42BA-A6D4-BB600F61F793}");//Инв.1 гр.-участник боевых действий на террит.др.государств
            private static Guid category39 = new Guid("{DCAC340F-4132-4514-B90C-581B2B24E37D}");//Дети участника ЧАЭС в возрасте до 18 лет
            private static Guid category40 = new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}");//Дети ВИЧ-инфиц. или больные СПИДом
            private static Guid category41 = new Guid("{B0004A56-4831-4CB8-B12B-C39280493A0B}");//Гражданин, мобилизованный в трудовую армию в годы ВОВ
            private static Guid category42 = new Guid("{A1FD4E39-07A0-4117-A99F-1CBFB9BF9E97}");//Герой СССР, герой КР, награжденный за боевые заслуги
            private static Guid category43 = new Guid("{95EC8C3C-0006-45E6-9A24-0FBA212117AA}");//Герой соц. труда, кавалер ордена трудовой славы 3-х степеней
            private static Guid category44 = new Guid("{92F076ED-8558-416F-B28C-AD80017C8D56}");//Вдова(ец) участ. Блокады Ленинграда
            private static Guid category45 = new Guid("{5F257499-9BF5-4850-AC3B-02264CDB62C8}");//Вдова(ец) УОВ
            private static Guid category46 = new Guid("{93933D4F-DE39-4C43-839F-6BE09DF1C9C5}");//Вдова(ец) умершего ИОВ

            private static List<object> categoryTypes = new List<object>
            {
            category1,category2,category3,category4,category5,category6,category7,category8,category9,category10,category11,
            category12,category13,category14,category15,category16,category17,category18,category19,category20,category21,category22,category23,
            category24,category25,category26,category27,category28,category29,category30,category31,category32,category33,category34,category35,
            category36,category37,category38,category39,category40,category41,category42,category43,category44,category45,category46
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType").Eq(privilege46PaymentId).And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("&OrgId");
                query.AddAttribute("Category");
                query.AddGroupAttribute("&OrgId");
                query.AddGroupAttribute("Category");

                var tempList = new List<TempItem>();

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var categoryId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);

                        if (orgId == Guid.Empty) continue;
                        tempList.Add(new TempItem
                        {
                            CategoryId = categoryId,
                            OrgId = orgId,
                            Count = count
                        });
                    }
                }
                Dictionary<Guid, Decimal> prices = GetPriceList(context.UserId, month, year, context);
                int counter = 1;
                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {

                    if (!prices.ContainsKey(categoryId)) continue;
                    var item = new ReportItem
                    {
                        CategoryName = context.Enums.GetValue(categoryId).Value,
                        Price = prices[categoryId]
                    };
                    var subItems = tempList.Where(x => x.CategoryId == categoryId);

                    item.Total = subItems.Sum(x => x.Count);

                    item.c_Bishkek = subItems.Where(x => bishkekList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.r_Chui = subItems.Where(x => chuiList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.r_Talas = subItems.Where(x => talasList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.r_IK = subItems.Where(x => issyk_kulList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.r_Naryn = subItems.Where(x => narynList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.r_Batken = subItems.Where(x => batkenList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.r_Osh = subItems.Where(x => oshList.Contains(x.OrgId)).Sum(x => x.Count);

                    item.c_Osh = subItems.Where(x => x.OrgId == osh).Sum(x => x.Count);

                    item.r_JA = subItems.Where(x => jalal_abad.Contains(x.OrgId)).Sum(x => x.Count);

                    item.RowNo = counter;

                    items.Add(item);
                    counter++;
                }
                return items;
            }
            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").Eq(privilege46PaymentId);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0m : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ДК. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            private static List<Guid> bishkekList = new List<Guid>//г.Бишкек
    {                                
        //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
        new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
        new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
        new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
        new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
    };
            private static List<Guid> chuiList = new List<Guid>//Чуйская область
    {                                                    
    //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
        new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
        new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
        new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
        new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
        new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
        new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
        new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
        new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
        new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
    };
            private static List<Guid> talasList = new List<Guid>//Таласская область
    {                                   
    //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
        new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
        new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
        new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
        new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
        new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
    };
            private static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
    {
    //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
        new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
        new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
        new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
        new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
        new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
        new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
        new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
    };
            private static List<Guid> narynList = new List<Guid>//Нарынская область
    {
    //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
        new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
        new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
        new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
        new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
        new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
        new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
    };
            private static List<Guid> batkenList = new List<Guid>//Баткенская область
    {
    //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
        new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
        new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
        new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
        new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
        new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
        new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
    };
            private static List<Guid> oshList = new List<Guid>//Ошская область
    {
    //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
        new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
        new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
        new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
        new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
        new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
        new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
        new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
        new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
    };
            private static Guid osh = new Guid("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}");
            private static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
    {
    //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
        new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
        new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
        new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
        new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
        new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
        new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
        new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
        new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
        new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
        new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
        new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
        new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
        new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
    };
            public class TempItem
            {
                public Guid CategoryId { get; set; }
                public Guid OrgId { get; set; }
                public int Count { get; set; }
            }
            public class ReportItem
            {
                public int RowNo { get; set; }
                public string CategoryName { get; set; }
                public decimal Price { get; set; }
                public int Total { get; set; }
                public int c_Bishkek { get; set; }
                public int r_Chui { get; set; }
                public int r_Talas { get; set; }
                public int r_IK { get; set; }
                public int r_Naryn { get; set; }
                public int r_Batken { get; set; }
                public int r_Osh { get; set; }
                public int c_Osh { get; set; }
                public int r_JA { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class FC_1003
        {
            private static readonly Guid privilege46PaymentId = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");

            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            private static readonly Guid lifetimeGrantPayment = new Guid("{3DB68E47-2451-43E0-AB98-9A59C8B52686}");
            private static readonly Guid singleCashBenefit = new Guid("{8FCF2658-55D1-404E-BF87-3D096769FB64}");
            private static readonly Guid pecuniaryCompensationInsteadOfBenefit = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");
            private static readonly Guid singleGrantTo9May = new Guid("{D450DE1B-ECD9-4286-A46A-59371E437C39}");
            private static readonly Guid singleAdditionalGrantTo9May = new Guid("{D450DE1B-ECD9-4286-A46A-59371E437C39}");
            private static readonly Guid sumSinglePaymentToPerMan = new Guid("{62D22220-F570-4C24-9859-6B3E67B26C5A}");

            private static Guid category1 = new Guid("{2E662509-144D-47CA-9F2B-087BB6F4AE91}");//Участник ликвидации последствий аварии на ЧАЭЗ 1989 г.
            private static Guid category2 = new Guid("{DF92F99F-BA8D-415C-8236-F54206AF0F73}");//Участник ликвидации последствий аварии на ЧАЭЗ 1988 г.
            private static Guid category3 = new Guid("{8691D5FB-7611-4AAA-AD84-60D2AADF50BE}");//Участник ликвидации последствий аварии на ЧАЭЗ 1986-87 гг.
            private static Guid category4 = new Guid("{63DFD63A-2868-411F-A52F-039E37B1D39F}");//Участник ВОВ, награжденный орденами славы 3-х степеней
            private static Guid category5 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");//Участник ВОВ
            private static Guid category6 = new Guid("{7EE64986-5A47-49D0-A288-88A537E6D0A0}");//Участник боевых действий на территории других государств
            private static Guid category7 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");//Участник блокады г.Ленинграда
            private static Guid category8 = new Guid("{8C21641E-1AC2-438A-ABDB-D6D17D195BB5}");//Семьям погибших военнослужащих при исполнении обязанностей военной службы
            private static Guid category9 = new Guid("{ECD8E6DF-3C3E-427D-BDC1-58E132A8B03D}");//Семья, потерявшая кормильца - участника ЧАЭС
            private static Guid category10 = new Guid("{93B5323F-E16B-4A76-AEB6-7CE166B0471B}");//Семья погибшего/пропавшего без вести в ВОВ военнослужащего
            private static Guid category11 = new Guid("{B038B840-021C-436E-B34D-4EB0E90DB767}");//Семьи сотрудников МВД, погибших при исполнении сл. обяз. или сл.долга, умерших после увольн. вслед-е ран./трав./забол., получ. в пер.прохожд.службы
            private static Guid category12 = new Guid("{C5728DEE-CE74-41C2-A0CF-B1182615D6B3}");//Реабилитированный, пострадавший в результате репрессий
            private static Guid category13 = new Guid("{24D5389C-9102-4369-A978-E2EF7DFC36C8}");//Почетный донор
            private static Guid category14 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");//Несовершеннолетний узник концлагерей, гетто
            private static Guid category15 = new Guid("{FA1787EF-A156-400E-8CA3-436203D3C322}");//ЛОВЗ Сов.Армии 3 гр. (во время несения службы)
            private static Guid category16 = new Guid("{22CB5768-069B-4E18-9F4C-D3F308AF4E3F}");//ЛОВЗ Сов.Армии 2 гр. (во время несения службы)
            private static Guid category17 = new Guid("{1EA3FA92-E895-4A9D-AD5F-72FE1EE3D5BF}");//ЛОВЗ Сов.Армии 1 гр. (во время несения службы)
            private static Guid category18 = new Guid("{CBD190B1-44AD-4E6B-8B79-34BF60619CF5}");//ЛОВЗ по слуху и зрению до 18 лет
            private static Guid category19 = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");//ЛОВЗ 3 гр. по слуху
            private static Guid category21 = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");//ЛОВЗ 2 гр. по слуху
            private static Guid category23 = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");//ЛОВЗ 1 гр. по слуху
            private static Guid category20 = new Guid("{8B787FCA-62EE-4261-9094-1FFAC1BF4C02}");//ЛОВЗ 3 гр. по зрению
            private static Guid category22 = new Guid("{947E64F0-18EC-4A6B-80C0-FCECFE7C67C2}");//ЛОВЗ 2 гр. по зрению
            private static Guid category24 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 1 гр. по зрению
            private static Guid category25 = new Guid("{A4B6BC13-479B-468F-B4EB-D661417B1127}");//Лица, награжденные за работу/службу в тылу в годы ВОВ с группой инв.
            private static Guid category26 = new Guid("{891911A4-C7C9-4E8D-919B-6AE2B7DE1AB7}");//Лица, награжденные за работу/службу в тылу в годы ВОВ без группы инв-ти
            private static Guid category27 = new Guid("{76668EA1-47E2-4F09-AD73-4AF24BF0D55C}");//Лица заболевшие лучевой болезнью (ЧАЭС)
            private static Guid category28 = new Guid("{E14662C0-719D-4B26-886F-55C8BD43A11E}");//Инвалид-реабилитиров., пострадавший в результате репрессий
            private static Guid category29 = new Guid("{BFE0BD8C-032D-4DF2-ACC1-60F2385925E9}");//Инвалид Советской армии при исполнении служеб. Обязанности
            private static Guid category30 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");//Инвалид ВОВ 3 группы
            private static Guid category31 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");//Инвалид ВОВ 2 группы
            private static Guid category32 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");//Инвалид ВОВ 1 группы
            private static Guid category33 = new Guid("{7CC482B7-A2FD-4B2E-8BFE-9CF0B96D8E05}");//Инв.3 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category35 = new Guid("{69E2D977-7C5A-4315-BF6A-6E790D19D7EC}");//Инв.2 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category38 = new Guid("{0A8D29A0-4806-422B-89EF-8F11AE835098}");//Инв.1 гр. - участник ликвидации последствий аварии на ЧАЭC
            private static Guid category34 = new Guid("{8828EAF5-5884-4BB0-B097-3D65496E4168}");//Инв.3 гр.-участник боевых действий на террит.др.государств
            private static Guid category36 = new Guid("{EB091676-B785-42AC-A330-44DFFBFDE1F6}");//Инв.2 гр.-участник боевых действий на террит.др.государств
            private static Guid category37 = new Guid("{3F0DD390-EFF5-42BA-A6D4-BB600F61F793}");//Инв.1 гр.-участник боевых действий на террит.др.государств
            private static Guid category39 = new Guid("{DCAC340F-4132-4514-B90C-581B2B24E37D}");//Дети участника ЧАЭС в возрасте до 18 лет
            private static Guid category40 = new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}");//Дети ВИЧ-инфиц. или больные СПИДом
            private static Guid category41 = new Guid("{B0004A56-4831-4CB8-B12B-C39280493A0B}");//Гражданин, мобилизованный в трудовую армию в годы ВОВ
            private static Guid category42 = new Guid("{A1FD4E39-07A0-4117-A99F-1CBFB9BF9E97}");//Герой СССР, герой КР, награжденный за боевые заслуги
            private static Guid category43 = new Guid("{95EC8C3C-0006-45E6-9A24-0FBA212117AA}");//Герой соц. труда, кавалер ордена трудовой славы 3-х степеней
            private static Guid category44 = new Guid("{92F076ED-8558-416F-B28C-AD80017C8D56}");//Вдова(ец) участ. Блокады Ленинграда
            private static Guid category45 = new Guid("{5F257499-9BF5-4850-AC3B-02264CDB62C8}");//Вдова(ец) УОВ
            private static Guid category46 = new Guid("{93933D4F-DE39-4C43-839F-6BE09DF1C9C5}");//Вдова(ец) умершего ИОВ
            private static Guid category47 = new Guid("{93b5323f-e16b-4a76-aeb6-7ce166b0471b}");//Семья погибшего/пропавшего без вести в ВОВ военнослужащего

            private static List<object> categoryTypes = new List<object>
            {
                category30,category31,category32,category5,category14,category7,category47,category25,category26,category41
            };

            public static CategoryItem Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType").In(
                    new object[]
                {
                    lifetimeGrantPayment,
                    singleCashBenefit,
                    pecuniaryCompensationInsteadOfBenefit,
                    singleGrantTo9May,
                    singleAdditionalGrantTo9May,
                    sumSinglePaymentToPerMan
                }).And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute("PaymentType");
                query.AddAttribute("Category");
                query.AddGroupAttribute("PaymentType");
                query.AddGroupAttribute("Category");


                var tempList = new List<TempItem>();

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var sum = reader.IsDbNull(1) ? 0m : reader.GetDecimal(1);
                        var paymentId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var categoryId = reader.IsDbNull(3) ? Guid.Empty : reader.GetGuid(3);

                        tempList.Add(new TempItem
                        {
                            CategoryId = categoryId,
                            PaymentId = paymentId,
                            Count = count,
                            Sum = sum
                        });
                    }
                }

                CategoryItem categoryItem = new CategoryItem();
                List<ReportItem> reportItemList = new List<ReportItem>();
                List<object> catList = new List<object>();
                catList.Add(category30);
                catList.Add(category31);
                catList.Add(category32);
                var subItems1 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category3032 = SetCategoryItem(catList, subItems1, "Инвалид ВОВ", 1);
                reportItemList.Add(categoryItem.category3032);
                catList.Clear();
                catList.Add(category5);
                var subItems2 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category5 = SetCategoryItem(catList, subItems2, "Участники ВОВ", 2);
                reportItemList.Add(categoryItem.category5);
                catList.Clear();
                catList.Add(category14);
                var subItems3 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category14 = SetCategoryItem(catList, subItems3, "Несовершеннолетние узники концлагерей", 3);
                reportItemList.Add(categoryItem.category14);
                catList.Clear();
                catList.Add(category7);
                var subItems4 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category7 = SetCategoryItem(catList, subItems4, "Блокадники  Ленинграда", 4);
                reportItemList.Add(categoryItem.category7);
                categoryItem.TotalFirst = SetTotal(reportItemList);

                reportItemList.Clear();
                catList.Clear();
                catList.Add(category47);
                var subItems5 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category47 = SetCategoryItem(catList, subItems5, "Семьи погибших  воинов в ВОВ", 6);
                reportItemList.Add(categoryItem.category47);
                catList.Clear();
                catList.Add(category25);
                var subItems6 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category25 = SetCategoryItem(catList, subItems6, "Труженики тыла с группой инвалидности", 7);
                reportItemList.Add(categoryItem.category25);
                catList.Clear();
                catList.Add(category26);
                var subItems7 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category26 = SetCategoryItem(catList, subItems7, "Труженики тыла (без инвалидности)", 8);
                reportItemList.Add(categoryItem.category26);
                catList.Clear();
                catList.Add(category41);
                var subItems8 = tempList.Where(x => catList.Contains(x.CategoryId));
                categoryItem.category41 = SetCategoryItem(catList, subItems8, "Труд армейцы", 9);
                reportItemList.Add(categoryItem.category41);
                categoryItem.TotalSecond = SetTotal(reportItemList);
                return categoryItem;
            }

            private static ReportItem SetTotal(List<ReportItem> reportItemList)
            {
                ReportItem reportItem = new ReportItem();
                //reportItem.RowNo = 5;
                reportItem.CategoryName = "Итого";
                foreach (ReportItem subItem in reportItemList)
                {
                    reportItem.Count += subItem.Count;
                    reportItem.lifetimeGrantPayment += subItem.lifetimeGrantPayment;
                    reportItem.singleCashBenefit += subItem.singleCashBenefit;
                    reportItem.lifetimeGrantPayment += subItem.pecuniaryCompensationInsteadOfBenefit;
                    reportItem.singleGrantTo9May += subItem.singleGrantTo9May;
                    reportItem.singleAdditionalGrantTo9May += subItem.singleAdditionalGrantTo9May;
                    reportItem.sumSinglePaymentToPerMan += subItem.sumSinglePaymentToPerMan;
                }
                return reportItem;
            }
            private static ReportItem SetCategoryItem(List<object> catList, IEnumerable<TempItem> subItems, string categoryName, int rowNo)
            {
                ReportItem reportItem = new ReportItem();
                reportItem.CategoryName = categoryName;
                reportItem.RowNo = rowNo;
                reportItem.Count = subItems.Count();
                reportItem.lifetimeGrantPayment = subItems.Where(x => x.PaymentId == lifetimeGrantPayment).Sum(x => x.Sum);
                reportItem.singleCashBenefit = subItems.Where(x => x.PaymentId == singleCashBenefit).Sum(x => x.Sum);
                reportItem.pecuniaryCompensationInsteadOfBenefit = subItems.Where(x => x.PaymentId == pecuniaryCompensationInsteadOfBenefit).Sum(x => x.Sum);
                reportItem.singleGrantTo9May = subItems.Where(x => x.PaymentId == singleGrantTo9May).Sum(x => x.Sum);
                reportItem.singleAdditionalGrantTo9May = subItems.Where(x => x.PaymentId == singleAdditionalGrantTo9May).Sum(x => x.Sum);
                reportItem.sumSinglePaymentToPerMan = subItems.Where(x => x.PaymentId == sumSinglePaymentToPerMan).Sum(x => x.Sum);
                return reportItem;
            }


            private static ReportItem GetReportItem(List<ReportItem> items, string categoryName)
            {
                var item = items.FirstOrDefault(x => x.CategoryName == categoryName);
                if (item != null) return item;
                item = new ReportItem
                {
                    CategoryName = categoryName,
                    RowNo = items.Count > 0 ? (items.Max(x => x.RowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }

            public class CategoryItem
            {
                public ReportItem category3032 { get; set; }
                public ReportItem category5 { get; set; }
                public ReportItem category14 { get; set; }
                public ReportItem category7 { get; set; }
                public ReportItem TotalFirst { get; set; }

                public ReportItem category47 { get; set; }
                public ReportItem category25 { get; set; }
                public ReportItem category26 { get; set; }
                public ReportItem category41 { get; set; }
                public ReportItem TotalSecond { get; set; }
            }
            public class TempItem
            {
                public Guid PaymentId { get; set; }
                public Guid CategoryId { get; set; }
                public int Count { get; set; }
                public decimal Sum { get; set; }
            }
            public class ReportItem
            {
                public int RowNo { get; set; }
                public string CategoryName { get; set; }
                public int Count { get; set; }
                public decimal lifetimeGrantPayment { get; set; }
                public decimal singleCashBenefit { get; set; }
                public decimal pecuniaryCompensationInsteadOfBenefit { get; set; }
                public decimal singleGrantTo9May { get; set; }
                public decimal singleAdditionalGrantTo9May { get; set; }
                public decimal sumSinglePaymentToPerMan { get; set; }
            }

        }

        /*******************************************************************************************************************/
        public static class FC_1004
        {
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");

            private static Guid category30 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");//Инвалид ВОВ 3 группы
            private static Guid category31 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");//Инвалид ВОВ 2 группы
            private static Guid category32 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");//Инвалид ВОВ 1 группы

            private static Guid category5 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");//Участник ВОВ

            private static Guid category42 = new Guid("{A1FD4E39-07A0-4117-A99F-1CBFB9BF9E97}");//Герой СССР, герой КР, награжденный за боевые заслуги

            private static Guid category14 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");//Несовершеннолетний узник концлагерей, гетто

            private static Guid category7 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");//Участник блокады г.Ленинграда

            private static Guid category15 = new Guid("{FA1787EF-A156-400E-8CA3-436203D3C322}");//ЛОВЗ Сов.Армии 3 гр. (во время несения службы)
            private static Guid category16 = new Guid("{22CB5768-069B-4E18-9F4C-D3F308AF4E3F}");//ЛОВЗ Сов.Армии 2 гр. (во время несения службы)
            private static Guid category17 = new Guid("{1EA3FA92-E895-4A9D-AD5F-72FE1EE3D5BF}");//ЛОВЗ Сов.Армии 1 гр. (во время несения службы)
            private static Guid category29 = new Guid("{BFE0BD8C-032D-4DF2-ACC1-60F2385925E9}");//Инвалид Советской армии при исполнении служеб. Обязанности

            private static Guid category34 = new Guid("{8828EAF5-5884-4BB0-B097-3D65496E4168}");//Инв.3 гр.-участник боевых действий на террит.др.государств
            private static Guid category36 = new Guid("{EB091676-B785-42AC-A330-44DFFBFDE1F6}");//Инв.2 гр.-участник боевых действий на террит.др.государств
            private static Guid category37 = new Guid("{3F0DD390-EFF5-42BA-A6D4-BB600F61F793}");//Инв.1 гр.-участник боевых действий на террит.др.государств

            private static Guid category6 = new Guid("{7EE64986-5A47-49D0-A288-88A537E6D0A0}");//Участник боевых действий на территории других государств

            private static Guid category33 = new Guid("{7CC482B7-A2FD-4B2E-8BFE-9CF0B96D8E05}");//Инв.3 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category35 = new Guid("{69E2D977-7C5A-4315-BF6A-6E790D19D7EC}");//Инв.2 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category38 = new Guid("{0A8D29A0-4806-422B-89EF-8F11AE835098}");//Инв.1 гр. - участник ликвидации последствий аварии на ЧАЭC

            private static Guid category3 = new Guid("{8691D5FB-7611-4AAA-AD84-60D2AADF50BE}");//Участник ликвидации последствий аварии на ЧАЭЗ 1986-87 гг.

            private static Guid category25 = new Guid("{A4B6BC13-479B-468F-B4EB-D661417B1127}");//Лица, награжденные за работу/службу в тылу в годы ВОВ с группой инв.

            private static Guid category41 = new Guid("{B0004A56-4831-4CB8-B12B-C39280493A0B}");//Гражданин, мобилизованный в трудовую армию в годы ВОВ

            private static Guid category12 = new Guid("{C5728DEE-CE74-41C2-A0CF-B1182615D6B3}");//Реабилитированный, пострадавший в результате репрессий

            private static Guid category1 = new Guid("{2E662509-144D-47CA-9F2B-087BB6F4AE91}");//Участник ликвидации последствий аварии на ЧАЭЗ 1989 г.
            private static Guid category2 = new Guid("{DF92F99F-BA8D-415C-8236-F54206AF0F73}");//Участник ликвидации последствий аварии на ЧАЭЗ 1988 г.

            private static Guid category9 = new Guid("{ECD8E6DF-3C3E-427D-BDC1-58E132A8B03D}");//Семья, потерявшая кормильца - участника ЧАЭС

            private static Guid category39 = new Guid("{DCAC340F-4132-4514-B90C-581B2B24E37D}");//Дети участника ЧАЭС в возрасте до 18 лет

            private static Guid category26 = new Guid("{891911A4-C7C9-4E8D-919B-6AE2B7DE1AB7}");//Лица, награжденные за работу/службу в тылу в годы ВОВ без группы инв-ти

            private static Guid category8 = new Guid("{8C21641E-1AC2-438A-ABDB-D6D17D195BB5}");//Семьям погибших военнослужащих при исполнении обязанностей военной службы

            private static Guid category10 = new Guid("{93B5323F-E16B-4A76-AEB6-7CE166B0471B}");//Семья погибшего/пропавшего без вести в ВОВ военнослужащего

            private static Guid category11 = new Guid("{B038B840-021C-436E-B34D-4EB0E90DB767}");//Семьи сотрудников МВД, погибших при исполнении сл. обяз. или сл.долга, умерших после увольн. вслед-е ран./трав./забол., получ. в пер.прохожд.службы

            private static Guid category45 = new Guid("{5F257499-9BF5-4850-AC3B-02264CDB62C8}");//Вдова(ец) УОВ

            private static Guid category46 = new Guid("{93933D4F-DE39-4C43-839F-6BE09DF1C9C5}");//Вдова(ец) умершего ИОВ

            private static Guid category44 = new Guid("{92F076ED-8558-416F-B28C-AD80017C8D56}");//Вдова(ец) участ. Блокады Ленинграда

            private static Guid category13 = new Guid("{24D5389C-9102-4369-A978-E2EF7DFC36C8}");//Почетный донор

            private static Guid category18 = new Guid("{CBD190B1-44AD-4E6B-8B79-34BF60619CF5}");//ЛОВЗ по слуху и зрению до 18 лет
            private static Guid category19 = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");//ЛОВЗ 3 гр. по слуху
            private static Guid category21 = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");//ЛОВЗ 2 гр. по слуху
            private static Guid category23 = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");//ЛОВЗ 1 гр. по слуху
            private static Guid category20 = new Guid("{8B787FCA-62EE-4261-9094-1FFAC1BF4C02}");//ЛОВЗ 3 гр. по зрению
            private static Guid category22 = new Guid("{947E64F0-18EC-4A6B-80C0-FCECFE7C67C2}");//ЛОВЗ 2 гр. по зрению
            private static Guid category24 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 1 гр. по зрению


            private static List<Guid> categoryGroup1 = new List<Guid>
            {
                category30,category31,category32
            };

            private static List<Guid> categoryGroup2 = new List<Guid>
            {
                category5
            };

            private static List<Guid> categoryGroup3 = new List<Guid>
            {
                category42
            };

            private static List<Guid> categoryGroup4 = new List<Guid>
            {
                category14
            };

            private static List<Guid> categoryGroup5 = new List<Guid>
            {
                category7
            };

            private static List<Guid> categoryGroup6 = new List<Guid>
            {
                category15, category16,category17,category29
            };

            private static List<Guid> categoryGroup7 = new List<Guid>
            {
                category34, category36,category37
            };

            private static List<Guid> categoryGroup8 = new List<Guid>
            {
                category6
            };

            private static List<Guid> categoryGroup9 = new List<Guid>
            {
                category33,category35,category38
            };

            private static List<Guid> categoryGroup10 = new List<Guid>
            {
                category3
            };

            private static List<Guid> categoryGroup11 = new List<Guid>
            {
                category25
            };

            private static List<Guid> categoryGroup12 = new List<Guid>
            {
                category41
            };

            private static List<Guid> categoryGroup13 = new List<Guid>
            {
                category12
            };

            private static List<Guid> categoryGroup14 = new List<Guid>
            {
                category1,category2
            };

            private static List<Guid> categoryGroup15 = new List<Guid>
            {
                category9
            };

            private static List<Guid> categoryGroup16 = new List<Guid>
            {
                category39
            };

            private static List<Guid> categoryGroup17 = new List<Guid>
            {
                category26
            };

            private static List<Guid> categoryGroup18 = new List<Guid>
            {
                category8
            };

            private static List<Guid> categoryGroup19 = new List<Guid>
            {
                category10
            };

            private static List<Guid> categoryGroup20 = new List<Guid>
            {
                category11
            };

            private static List<Guid> categoryGroup21 = new List<Guid>
            {
                category45
            };

            private static List<Guid> categoryGroup22 = new List<Guid>
            {
                category46
            };

            private static List<Guid> categoryGroup23 = new List<Guid>
            {
                category44
            };

            private static List<Guid> categoryGroup24 = new List<Guid>
            {
                category13
            };

            private static List<Guid> categoryGroup25 = new List<Guid>
            {
                category18,category19,category21,category23,category20,category22,category24
            };

            public static ReportItem Execute(WorkflowContext context, int year, int month)
            {
                ReportItem reportItem = new ReportItem();
                reportItem = Build(context, year, "year_0", reportItem);
                reportItem = Build(context, year - 1, "year_1", reportItem);
                reportItem = Build(context, year - 2, "year_2", reportItem);
                return reportItem;
            }

            private static ReportItem Build(WorkflowContext context, int year, string yearPropertyName, ReportItem reportItem)
            {
                var fd = new DateTime(year, 1, 1);
                var ld = new DateTime(year, 12, DateTime.DaysInMonth(year, 12));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute("Category");
                query.AddGroupAttribute("Category");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var sum = reader.IsDbNull(1) ? 0m : reader.GetDecimal(1);
                        var categoryId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        if (categoryId == Guid.Empty) continue;
                        reportItem = calc(reportItem, categoryId, sum, yearPropertyName);
                    }
                }
                return reportItem;
            }


            private static ReportItem setValueByProperty(ReportItem item, string reportItemPropertyName, decimal value, string yearPropertyName)
            {
                if (!string.IsNullOrEmpty(reportItemPropertyName))
                {
                    PropertyInfo propertyInfo = item.GetType().GetProperty(reportItemPropertyName);
                    YearReportItem prevValueReportItem = (YearReportItem)propertyInfo.GetValue(item, null);
                    PropertyInfo propertyInfoYear = prevValueReportItem.GetType().GetProperty(yearPropertyName);
                    decimal prevValueYear = (decimal)propertyInfoYear.GetValue(prevValueReportItem, null);
                    propertyInfoYear.SetValue(prevValueReportItem, prevValueYear + value, null);
                    propertyInfo.SetValue(item, prevValueReportItem, null);
                }
                return item;
            }
            private static ReportItem calc(ReportItem reportItem, Guid categoryId, decimal sum, string yearPropertyName)
            {
                Type type = typeof(FC_1004);
                foreach (var pi in type.GetFields(System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic))
                {
                    if (isList(pi.FieldType))
                    {
                        var listGuid = (List<Guid>)pi.GetValue(null);
                        if (listGuid.Contains(categoryId))
                            setValueByProperty(reportItem, pi.Name, sum, yearPropertyName);
                    }
                }
                return reportItem;
            }
            private static bool isList(Type type)
            {
                return type.IsGenericType && type.GetGenericTypeDefinition() == typeof(List<>);
            }

            [DataContract]
            public class YearReportItem
            {
                public YearReportItem(string CategoryName)
                {
                    categoryName = CategoryName;
                    year_0 = 0;
                    year_1 = 0;
                    year_2 = 0;
                }
                [DataMember]
                public string categoryName { get; set; }
                [DataMember]
                public decimal year_0 { get; set; }
                [DataMember]
                public decimal year_1 { get; set; }
                [DataMember]
                public decimal year_2 { get; set; }
            }
            public class ReportItem
            {
                public ReportItem()
                {
                    categoryGroup1 = new YearReportItem("Инвалиды ВОВ");
                    categoryGroup2 = new YearReportItem("Участники ВОВ");
                    categoryGroup3 = new YearReportItem("Герои КР, Советского Союза");
                    categoryGroup4 = new YearReportItem("Несовершеннолетние узники концлагерей");
                    categoryGroup5 = new YearReportItem("Блокадники г. Ленинграда");
                    categoryGroup6 = new YearReportItem("Инвалиды СА");
                    categoryGroup7 = new YearReportItem("Инвалиды интернационалисты");
                    categoryGroup8 = new YearReportItem("Участники интернационалисты");
                    categoryGroup9 = new YearReportItem("Инвалиды ЧАЭС");
                    categoryGroup10 = new YearReportItem("Участники ЧАЭС 1986-1987 гг.");
                    categoryGroup11 = new YearReportItem("Труженики тыла с группой инвалидности");
                    categoryGroup12 = new YearReportItem("Труд армейцы");
                    categoryGroup13 = new YearReportItem("Реабилитированные и пострадавшие граждане");
                    categoryGroup14 = new YearReportItem("Участники ЧАЭС 1988-1989 гг.");
                    categoryGroup15 = new YearReportItem("СП участников и умерших инвалидов ЧАЭС");
                    categoryGroup16 = new YearReportItem("Дети до 18 лет участников ЧАЭС");
                    categoryGroup17 = new YearReportItem("Труженики тыла (без инвалидности)");
                    categoryGroup18 = new YearReportItem("Семьи погибших военнослужащих");
                    categoryGroup19 = new YearReportItem("Семьи погибших воинов в ВОВ");
                    categoryGroup20 = new YearReportItem("Семьи погибших сотрудников ОВД");
                    categoryGroup21 = new YearReportItem("Вдовы (вдовцы) инвалидов ВОВ");
                    categoryGroup22 = new YearReportItem("Вдовы (вдовцы) участников ВОВ");
                    categoryGroup23 = new YearReportItem("Вдовы блокадников Ленинграда");
                    categoryGroup24 = new YearReportItem("Почетные доноры");
                    categoryGroup25 = new YearReportItem("ЛОВЗ по зрению и слуху");
                }
                public YearReportItem categoryGroup1 { get; set; }
                public YearReportItem categoryGroup2 { get; set; }
                public YearReportItem categoryGroup3 { get; set; }
                public YearReportItem categoryGroup4 { get; set; }
                public YearReportItem categoryGroup5 { get; set; }
                public YearReportItem categoryGroup6 { get; set; }
                public YearReportItem categoryGroup7 { get; set; }
                public YearReportItem categoryGroup8 { get; set; }
                public YearReportItem categoryGroup9 { get; set; }
                public YearReportItem categoryGroup10 { get; set; }
                public YearReportItem categoryGroup11 { get; set; }
                public YearReportItem categoryGroup12 { get; set; }
                public YearReportItem categoryGroup13 { get; set; }
                public YearReportItem categoryGroup14 { get; set; }
                public YearReportItem categoryGroup15 { get; set; }
                public YearReportItem categoryGroup16 { get; set; }
                public YearReportItem categoryGroup17 { get; set; }
                public YearReportItem categoryGroup18 { get; set; }
                public YearReportItem categoryGroup19 { get; set; }
                public YearReportItem categoryGroup20 { get; set; }
                public YearReportItem categoryGroup21 { get; set; }
                public YearReportItem categoryGroup22 { get; set; }
                public YearReportItem categoryGroup23 { get; set; }
                public YearReportItem categoryGroup24 { get; set; }
                public YearReportItem categoryGroup25 { get; set; }
            }


        }

        /*******************************************************************************************************************/
        public static class FC_1005
        {
            #region Объявление ID
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid privilege46PaymentId = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}");

            private static Guid category29 = new Guid("{BFE0BD8C-032D-4DF2-ACC1-60F2385925E9}");//Инвалид Советской армии при исполнении служеб. Обязанности
            private static Guid category33 = new Guid("{7CC482B7-A2FD-4B2E-8BFE-9CF0B96D8E05}");//Инв.3 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category35 = new Guid("{69E2D977-7C5A-4315-BF6A-6E790D19D7EC}");//Инв.2 гр.-участник ликвидации последствий аварии на ЧАЭC
            private static Guid category38 = new Guid("{0A8D29A0-4806-422B-89EF-8F11AE835098}");//Инв.1 гр. - участник ликвидации последствий аварии на ЧАЭC

            private static Guid category18 = new Guid("{CBD190B1-44AD-4E6B-8B79-34BF60619CF5}");//ЛОВЗ по слуху и зрению до 18 лет
            private static Guid category19 = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");//ЛОВЗ 3 гр. по слуху
            private static Guid category21 = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");//ЛОВЗ 2 гр. по слуху
            private static Guid category23 = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");//ЛОВЗ 1 гр. по слуху
            private static Guid category20 = new Guid("{8B787FCA-62EE-4261-9094-1FFAC1BF4C02}");//ЛОВЗ 3 гр. по зрению
            private static Guid category22 = new Guid("{947E64F0-18EC-4A6B-80C0-FCECFE7C67C2}");//ЛОВЗ 2 гр. по зрению
            private static Guid category24 = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");//ЛОВЗ 1 гр. по зрению

            private static Guid category13 = new Guid("{24D5389C-9102-4369-A978-E2EF7DFC36C8}");//Почетный донор

            private static Guid category39 = new Guid("{DCAC340F-4132-4514-B90C-581B2B24E37D}");//Дети участника ЧАЭС в возрасте до 18 лет

            private static Guid category8 = new Guid("{8C21641E-1AC2-438A-ABDB-D6D17D195BB5}");//Семьям погибших военнослужащих при исполнении обязанностей военной службы
            private static Guid category9 = new Guid("{ECD8E6DF-3C3E-427D-BDC1-58E132A8B03D}");//Семья, потерявшая кормильца - участника ЧАЭС

            private static Guid category11 = new Guid("{B038B840-021C-436E-B34D-4EB0E90DB767}");//Семьи сотрудников МВД, погибших при исполнении сл. обяз. или сл.долга, умерших после увольн. вслед-е ран./трав./забол., получ. в пер.прохожд.службы

            public static List<Guid> CategoryType = new List<Guid>
            {
                category29,category33,category35,category38,category19,category21,category23,
                category20,category22,category24, category18,category13,category39,category8,
                category9,category8
            };
            private static List<Guid> categoryGroup1 = new List<Guid>
            {
                category29
            };

            private static List<Guid> categoryGroup2 = new List<Guid>
            {
                category33,category35,category38
            };

            private static List<Guid> categoryGroup3 = new List<Guid>
            {
                category19,category21,category23
            };

            private static List<Guid> categoryGroup4 = new List<Guid>
            {
                category20,category22,category24
            };

            private static List<Guid> categoryGroup5 = new List<Guid>
            {
                category18
            };

            private static List<Guid> categoryGroup6 = new List<Guid>
            {
                category13
            };

            private static List<Guid> categoryGroup7 = new List<Guid>
            {
                category39
            };

            private static List<Guid> categoryGroup8 = new List<Guid>
            {
                category8
            };

            private static List<Guid> categoryGroup9 = new List<Guid>
            {
                category9
            };

            private static List<Guid> categoryGroup10 = new List<Guid>
            {
                category11
            };
            #endregion

            public static ReportItem Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                ReportItem reportItem = new ReportItem();
                Dictionary<Guid, Decimal> prices = GetPriceList(context.UserId, fd, ld, context);
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType").Eq(privilege46PaymentId).And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                var catAttr = query.AddAttribute(query.Source, "Category");
                var sexAttr = query.AddAttribute(personSrc, "Sex");
                query.AddGroupAttribute(catAttr);
                query.AddGroupAttribute(sexAttr);

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var categoryId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var genderId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        if (categoryId == Guid.Empty) continue;
                        if (CategoryType.Contains(categoryId))
                        {
                            if (genderId.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                reportItem = calc(reportItem, categoryId, count, "CountMan");
                            if (genderId.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                reportItem = calc(reportItem, categoryId, count, "CountWoman");
                            reportItem = calc(reportItem, categoryId, prices[categoryId], "PrizeSize");
                        }
                    }
                }
                return reportItem;
            }


            private static ReportItem setValueByProperty(ReportItem item, string reportItemPropertyName, int value, string groupPropertyName)
            {
                if (!string.IsNullOrEmpty(reportItemPropertyName))
                {
                    PropertyInfo propertyInfo = item.GetType().GetProperty(reportItemPropertyName);
                    GroupItem prevValueReportItem = (GroupItem)propertyInfo.GetValue(item, null);
                    PropertyInfo propertyInfoGroup = prevValueReportItem.GetType().GetProperty(groupPropertyName);
                    int prevValueYear = (int)propertyInfoGroup.GetValue(prevValueReportItem, null);
                    propertyInfoGroup.SetValue(prevValueReportItem, prevValueYear + value, null);
                    propertyInfo.SetValue(item, prevValueReportItem, null);
                }
                return item;
            }

            private static ReportItem setValueByProperty(ReportItem item, string reportItemPropertyName, decimal value, string groupPropertyName)
            {
                if (!string.IsNullOrEmpty(reportItemPropertyName))
                {
                    PropertyInfo propertyInfo = item.GetType().GetProperty(reportItemPropertyName);
                    GroupItem prevValueReportItem = (GroupItem)propertyInfo.GetValue(item, null);
                    PropertyInfo propertyInfoGroup = prevValueReportItem.GetType().GetProperty(groupPropertyName);
                    decimal prevValueYear = (decimal)propertyInfoGroup.GetValue(prevValueReportItem, null);
                    propertyInfoGroup.SetValue(prevValueReportItem, prevValueYear + value, null);
                    propertyInfo.SetValue(item, prevValueReportItem, null);
                }
                return item;
            }

            private static ReportItem calc(ReportItem reportItem, Guid categoryId, int count, string PropertyName)
            {
                Type type = typeof(FC_1005);
                foreach (var pi in type.GetFields(System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic))
                {
                    if (isList(pi.FieldType))
                    {
                        var listGuid = (List<Guid>)pi.GetValue(null);
                        if (listGuid.Contains(categoryId))
                            setValueByProperty(reportItem, pi.Name, count, PropertyName);
                    }
                }
                return reportItem;
            }

            private static ReportItem calc(ReportItem reportItem, Guid categoryId, decimal prize, string PropertyName)
            {
                Type type = typeof(FC_1005);
                foreach (var pi in type.GetFields(System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic))
                {
                    if (isList(pi.FieldType))
                    {
                        var listGuid = (List<Guid>)pi.GetValue(null);
                        if (listGuid.Contains(categoryId))
                            setValueByProperty(reportItem, pi.Name, prize, PropertyName);
                    }
                }
                return reportItem;
            }

            private static bool isList(Type type)
            {
                return type.IsGenericType && type.GetGenericTypeDefinition() == typeof(List<>);
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, DateTime fd, DateTime ld, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(fd).And("ExpiryDate").Ge(ld)
                .And("PaymentType").Eq(privilege46PaymentId);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0m : (decimal)row[1]);
                            else
                                throw new ApplicationException("Ошибка при чтении тарифов ДК. Сообщите администрации об этой ошибке.");
                    }
                }
                return catList;
            }

            [DataContract]
            public class GroupItem
            {
                [DataMember]
                public string CategoryName { get; set; }
                [DataMember]
                public int CountMan { get; set; }
                [DataMember]
                public int CountWoman { get; set; }
                [DataMember]
                public decimal PrizeSize { get; set; }

                public GroupItem(string categoryName)
                {
                    CategoryName = categoryName;
                }
            }

            public class ReportItem
            {
                public ReportItem()
                {
                    categoryGroup1 = new GroupItem("Инвалид Советской армии при исполнении служеб. Обязанности");
                    categoryGroup2 = new GroupItem("Инв.-участник ликвидации последствий аварии на ЧАЭC");
                    categoryGroup3 = new GroupItem("ЛОВЗ по слуху");
                    categoryGroup4 = new GroupItem("ЛОВЗ по зрению");
                    categoryGroup5 = new GroupItem("ЛОВЗ по слуху и зрению до 18 лет");
                    categoryGroup6 = new GroupItem("Почетный донор");
                    categoryGroup7 = new GroupItem("Дети участника ЧАЭС в возрасте до 18 лет");
                    categoryGroup8 = new GroupItem("Семьям погибших военнослужащих при исполнении обязанностей военной службы");
                    categoryGroup9 = new GroupItem("Семья, потерявшая кормильца - участника ЧАЭС");
                    categoryGroup10 = new GroupItem("Семьи сотрудников МВД, погибших при исполнении сл. обяз. или сл.долга");
                }
                public GroupItem categoryGroup1 { get; set; }
                public GroupItem categoryGroup2 { get; set; }
                public GroupItem categoryGroup3 { get; set; }
                public GroupItem categoryGroup4 { get; set; }
                public GroupItem categoryGroup5 { get; set; }
                public GroupItem categoryGroup6 { get; set; }
                public GroupItem categoryGroup7 { get; set; }
                public GroupItem categoryGroup8 { get; set; }
                public GroupItem categoryGroup9 { get; set; }
                public GroupItem categoryGroup10 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class MonthlyGrant_1017
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");   // * Уй-булого комок
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid privilege46PaymentId = new Guid("{7BEFD6DA-042C-4A77-90F3-A4424033E4DD}");

            private static readonly Guid twinsId = new Guid("{45D55628-5E72-42B8-8B8D-667346E79046}");
            private static readonly Guid tripleId = new Guid("{8CCAE21E-128A-4728-9479-9C094271C614}");

            private static readonly Guid childUpTo3YearsId = new Guid("{D8FF3DAF-A701-414A-B965-4BF93BB658B9}");
            private static readonly Guid childFrom3To16YearId = new Guid("{D8FF3DAF-A701-414A-B965-4BF93BB658B9}");
            private static readonly Guid studentUpto23YearId = new Guid("{AF79BAD1-83D8-4EEA-8FD4-189342735075}");
            private static readonly Guid studentOlder23YearId = new Guid("{46AEAEA2-D42F-47C9-A571-9F3789413CC3}");
            private static readonly Guid studentOfCommercialUnivercityId = new Guid("{AF79BAD1-83D8-4EEA-8FD4-189342735075}");

            private static readonly List<Guid> studentList = new List<Guid>
            {
                studentUpto23YearId,studentOlder23YearId,studentOfCommercialUnivercityId
            };

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                query.AddAttribute("&OrgId");
                query.AddAttribute("MembershipType");
                query.AddAttribute("EmploymentStatus");
                query.AddAttribute("Amount");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var orgId = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var membershipTypeId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var employmentStatusId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var amount = reader.IsDbNull(3) ? 0m : reader.GetDecimal(3);

                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        if (membershipTypeId.Equals(twinsId) || membershipTypeId.Equals(tripleId))
                        {
                            if (membershipTypeId.Equals(twinsId) && employmentStatusId.Equals(childUpTo3YearsId))
                                item.twinsUpTo3Years += 1;

                            if (membershipTypeId.Equals(tripleId) && employmentStatusId.Equals(childUpTo3YearsId))
                                item.tripletUpTo3Year += 1;

                            if (membershipTypeId.Equals(tripleId) && employmentStatusId.Equals(childFrom3To16YearId))
                                item.tripletFrom3To16Year += 1;

                            item.grantSizeForMonthFirstGroup += amount;
                        }
                        else
                        {
                            if (employmentStatusId.Equals(childUpTo3YearsId))
                            {
                                item.childUpto3Years += 1;
                                item.grantSizeForMonthSecondGroup += amount;
                            }

                            if (employmentStatusId.Equals(childFrom3To16YearId))
                            {
                                item.childFrom3To16Year += 1;
                                item.grantSizeForMonthSecondGroup += amount;
                            }

                            if (studentList.Contains(employmentStatusId))
                            {
                                item.students += 1;
                                item.grantSizeForMonthSecondGroup += amount;
                            }
                        }

                    }

                }
                foreach (var subItem in items)
                {
                    subItem.countGrantReceipientFirstGroup = subItem.twinsUpTo3Years + subItem.tripletUpTo3Year + subItem.tripletFrom3To16Year;
                    subItem.countGrantReceipientSecondGroup = subItem.childUpto3Years + subItem.childFrom3To16Year + subItem.students;
                    if (subItem.countGrantReceipientFirstGroup == 0)
                        subItem.averageGrantFirstGroup = 0;
                    else subItem.averageGrantFirstGroup = subItem.grantSizeForMonthFirstGroup / subItem.countGrantReceipientFirstGroup;
                    if (subItem.countGrantReceipientSecondGroup == 0)
                        subItem.averageGrantSecondGroup = 0;
                    else subItem.averageGrantSecondGroup = subItem.grantSizeForMonthSecondGroup / subItem.countGrantReceipientSecondGroup;

                    subItem.totalCountGrantRecipient = subItem.countGrantReceipientFirstGroup + subItem.countGrantReceipientSecondGroup;
                    if (subItem.totalCountGrantRecipient == 0)
                        subItem.generalAverageGrantToPerMan = 0;
                    else subItem.generalAverageGrantToPerMan = (subItem.grantSizeForMonthFirstGroup + subItem.grantSizeForMonthSecondGroup) / subItem.totalCountGrantRecipient;
                }
                var executeApplicant = ExecuteApplicant(context, year, month);
                foreach (var subItem in executeApplicant)
                {
                    var item = items.Where(x => x.orgName.Equals(subItem.orgName)).FirstOrDefault();
                    if (item != null)
                    {
                        item.applicantCount = subItem.applicantCount;
                    }
                }
                var executeGetSinceBeginOfYear = ExecuteGetSinceBeginOfYear(context, year, month);
                foreach (var subItem in executeGetSinceBeginOfYear)
                {
                    var item = items.Where(x => x.orgName.Equals(subItem.orgName)).FirstOrDefault();
                    if (item != null)
                    {
                        item.grantTotalSinceBeginOfYearFirstGroup += subItem.grantTotalSinceBeginOfYearFirstGroup;
                        item.grantTotalSinceBeginOfYearSecondGroup += subItem.grantTotalSinceBeginOfYearSecondGroup;
                    }
                }

                return items;
            }

            public static List<ReportItem> ExecuteGetSinceBeginOfYear(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, 1, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                query.AddAttribute("&OrgId");
                query.AddAttribute("MembershipType");
                query.AddAttribute("EmploymentStatus");
                query.AddAttribute("Amount");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var orgId = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var membershipTypeId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var employmentStatusId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var amount = reader.IsDbNull(3) ? 0m : reader.GetDecimal(3);

                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        if (membershipTypeId.Equals(twinsId) || membershipTypeId.Equals(tripleId))
                        {
                            item.grantTotalSinceBeginOfYearFirstGroup += amount;
                        }
                        else
                        {
                            if (employmentStatusId.Equals(childUpTo3YearsId))
                            {
                                item.grantTotalSinceBeginOfYearSecondGroup += amount;
                            }

                            if (employmentStatusId.Equals(childFrom3To16YearId))
                            {
                                item.grantTotalSinceBeginOfYearSecondGroup += amount;
                            }

                            if (studentList.Contains(employmentStatusId))
                            {
                                item.grantTotalSinceBeginOfYearSecondGroup += amount;
                            }

                        }

                    }

                }

                return items;
            }


            public static List<ReportItem> ExecuteApplicant(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(appDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("AssignFrom").Lt(ld).And("AssignToMax").Gt(fd);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("&OrgId");
                query.AddAttribute("Applicant");
                query.AddGroupAttribute("&OrgId");
                query.AddGroupAttribute("Applicant");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var applicantId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        item.applicantCount += count;
                    }
                }
                return items;
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.orgName == orgName);
                if (item != null) return item;
                item = new ReportItem
                {
                    orgName = orgName,
                    rowNo = items.Count > 0 ? (items.Max(x => x.rowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }
            public class ReportItem
            {
                public int rowNo { get; set; }
                public string orgName { get; set; }
                public int applicantCount { get; set; }
                public int twinsUpTo3Years { get; set; }
                public int tripletUpTo3Year { get; set; }
                public int tripletFrom3To16Year { get; set; }
                public int countGrantReceipientFirstGroup { get; set; }
                public decimal averageGrantFirstGroup { get; set; }
                public decimal grantSizeForMonthFirstGroup { get; set; }
                public decimal grantTotalSinceBeginOfYearFirstGroup { get; set; }
                public int childUpto3Years { get; set; }
                public int childFrom3To16Year { get; set; }
                public int students { get; set; }
                public int countGrantReceipientSecondGroup { get; set; }
                public decimal averageGrantSecondGroup { get; set; }
                public decimal grantSizeForMonthSecondGroup { get; set; }
                public decimal grantTotalSinceBeginOfYearSecondGroup { get; set; }
                public int totalCountGrantRecipient { get; set; }
                public decimal generalAverageGrantToPerMan { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Event2010_1018
        {
            private static readonly Guid despPaymentTypeId = new Guid("{272F8D91-5B4B-42AC-9D79-A17E77F5496E}");
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");   // * Уй-булого комок
            // Document Defs Id 1e750c67-2ddf-488e-a4c4-d94547433067
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");// "{04D25808-6DE9-42F5-8855-6F68A94A224C}"
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}");
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            private static readonly Guid childUpto18YearsId = new Guid("{608F740E-C44B-4305-88E8-F53D497214C0}");
            private static readonly Guid disabledId = new Guid("{7D08F570-239D-46BF-BF4F-6E3A510ACCD2}");
            private static readonly Guid parentId = new Guid("{238BD896-A3B7-494D-B549-4AAC292EE8F5}");
            private static readonly Guid heavyWoundAprilId = new Guid("{AA83612B-0538-49A3-8841-0F42E7DFCDA6}");
            private static readonly Guid fleshWoundAprilId = new Guid("{2F488FCE-E02E-4875-870C-ABDBF320B726}");
            private static readonly Guid heavyWoundMayId = new Guid("{CEF4185C-77AE-4B7D-BFB7-74598F9F0462}");
            private static readonly Guid fleshWoundMayId = new Guid("{D910F004-ED3B-4A6D-BDC4-7C51854954F6}");
            private static readonly Guid heavyWoundJuneId = new Guid("{6E50CFEE-7F02-4253-9C33-82902EF9192D}");
            private static readonly Guid fleshWoundJuneId = new Guid("{2281A6BD-50DF-49FA-9B8B-11F1F4532B0F}");
            private static readonly Guid familiesOfDeadInAprilEventId = new Guid("{1C4924D0-CAEE-4D65-9B42-1AC992D61326}");
            private static readonly Guid familiesOfDeadInMayEventId = new Guid("{687DAC74-5AF9-4C32-86A8-5ED60873125C}");
            private static readonly Guid familiesOfDeadInJuneEventId = new Guid("{E415799C-2C5B-4FBF-B367-16CC246BEEB3}");
            private static readonly Guid familiesOfMissingInJuneEventId = new Guid("{1FFEA278-CD71-4E9C-81A6-33C2E1581A17}");

            private static readonly List<Guid> categoryList = new List<Guid>
            {
                childUpto18YearsId,disabledId,parentId,heavyWoundAprilId,fleshWoundAprilId,heavyWoundMayId,fleshWoundJuneId,
                familiesOfDeadInAprilEventId,familiesOfDeadInMayEventId,familiesOfDeadInJuneEventId,familiesOfMissingInJuneEventId
            };


            private static readonly List<Guid> Event2010List = new List<Guid>
            {
                childUpto18YearsId,disabledId,parentId
            };
            private static readonly List<Guid> juneEventList = new List<Guid>
            {
                heavyWoundJuneId,fleshWoundJuneId,familiesOfDeadInJuneEventId,familiesOfMissingInJuneEventId
            };

            private static readonly List<Guid> aprilEventList = new List<Guid>
            {
                heavyWoundAprilId,fleshWoundAprilId,familiesOfDeadInAprilEventId
            };
            private static readonly List<Guid> mayEventList = new List<Guid>
            {
                heavyWoundMayId,fleshWoundMayId,familiesOfDeadInMayEventId
            };
            public static List<GroupReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<GroupReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType").Eq(despPaymentTypeId).And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute("&OrgId");
                query.AddAttribute("Category");
                query.AddGroupAttribute("&OrgId");
                query.AddGroupAttribute("Category");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var sum = reader.IsDbNull(1) ? 0m : reader.GetDecimal(1);
                        var orgId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var categoryId = reader.IsDbNull(3) ? Guid.Empty : reader.GetGuid(3);

                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetGroupReportItem(items, orgName);

                        if (categoryList.Contains(categoryId))
                        {
                            if (childUpto18YearsId.Equals(categoryId))
                            {
                                item.currentItem.childUpto18Years += count;
                                item.totalSum += sum;
                                item.totalCount += count;
                            }
                            if (disabledId.Equals(categoryId))
                            {
                                item.currentItem.disabled += count;
                                item.totalSum += sum;
                                item.totalCount += count;
                            }
                            if (parentId.Equals(categoryId))
                            {
                                item.currentItem.parent += count;
                                item.totalSum += sum;
                                item.totalCount += count;
                            }
                            if (aprilEventList.Contains(categoryId))
                            {
                                item.firstItem += count;
                                item.totalSum += sum;
                                item.totalCount += count;
                            }
                            if (mayEventList.Contains(categoryId))
                            {
                                item.secondItem += count;
                                item.totalSum += sum;
                                item.totalCount += count;
                            }
                            if (juneEventList.Contains(categoryId))
                            {
                                item.thirdItem += count;
                                item.totalSum += sum;
                                item.totalCount += count;
                            }
                        }
                    }
                }
                return items;
            }
            static GroupReportItem GetGroupReportItem(List<GroupReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.orgName == orgName);
                if (item != null) return item;
                item = new GroupReportItem
                {
                    orgName = orgName,
                    rowNo = items.Count > 0 ? (items.Max(x => x.rowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }

            public class ReportItem
            {
                public int childUpto18Years { get; set; }
                public int disabled { get; set; }
                public int parent { get; set; }
            }

            public class GroupReportItem
            {
                public GroupReportItem()
                {
                    currentItem = new ReportItem();
                }
                public int rowNo { get; set; }
                public string orgName { get; set; }
                public int totalCount { get; set; }
                public decimal totalSum { get; set; }
                public ReportItem currentItem { get; set; }
                public int firstItem { get; set; }
                public int secondItem { get; set; }
                public int thirdItem { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1019
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");

            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");

            // States                               
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
            private static readonly Guid onPaymentStateTypeId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Оформлен

            //RefuseReasonType
            private static readonly Guid deniedYesDurableGoodsId = new Guid("{EEF4A0D7-9763-4E39-907E-DCC46C929DF0}");
            private static readonly Guid deniedYesFarmAnimalsId = new Guid("{690F141C-2FCD-4014-B309-C7106C0FE1FF}");
            private static readonly Guid deniedFAPCIHigherThanGMI = new Guid("{A71ABA04-F07B-4AFB-B372-24EF87EEAC62}");
            private static readonly Guid deniedNoKidsUpTo18Year = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}");
            private static readonly Guid deniedOtherReason = new Guid("{E7D459E6-C63F-4EEB-A7E8-B4B9A82FB0D0}");
            private static readonly Guid confirmedFamilyWithRetiree = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}");

            static Guid familyMemberDefId = new Guid("{85B03F9E-47D7-4829-8041-0CDCB8486572}");
            static Guid pensionerEnumId = new Guid("{CC14F361-689D-49B7-AC9B-259B0E84C399}");
            static Guid emplPensionerId = new Guid("{8617FB6E-6C54-4C6E-97C3-1A7D2887AA30}");

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(appDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("&State").Eq(refusedStateId).And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("&OrgId");
                query.AddAttribute("RefuseReason");
                query.AddGroupAttribute("&OrgId");
                query.AddGroupAttribute("RefuseReason");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var refuseReasonId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);

                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        if (refuseReasonId.Equals(deniedYesDurableGoodsId))
                        {
                            item.deniedYesDurableGoods += count;
                        }
                        if (refuseReasonId.Equals(deniedYesFarmAnimalsId))
                        {
                            item.deniedYesFarmAnimals += count;
                        }
                        if (refuseReasonId.Equals(deniedFAPCIHigherThanGMI))
                        {
                            item.deniedFAPCIHigherThanGMI += count;
                        }
                        if (refuseReasonId.Equals(deniedNoKidsUpTo18Year))
                        {
                            item.deniedNoKidsUpTo18Year += count;
                        }
                        if (refuseReasonId.Equals(deniedOtherReason))
                        {
                            item.deniedOtherReason += count;
                        }
                        item.countAllDenied += count;
                    }
                }
                GetConfirmedAppBaseData(context, year, month, items);

                return items;
            }


            public static void GetConfirmedAppBaseData(WorkflowContext context, int year, int month, List<ReportItem> items)
            {
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(appDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("&State")
                    .In(new object[]
                    {
                        approvedStateId,
                        onApprovingStateId,
                        onRegisteringStateId,
                        onPaymentStateTypeId
                    })
                    .And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var fMemSrc = query.JoinSource(query.Source, familyMemberDefId, SqlSourceJoinType.Inner, "FamilyMembers");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(query.Source, "EmploymentStatus");
                query.AddAttribute(fMemSrc, "EmploymentStatus");

                var table = new DataTable();

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                var tempList = new HashSet<Guid>();
                foreach (DataRow row in table.Rows)
                {
                    var appID = (Guid)row[0];
                    var orgId = (Guid)row[1];
                    var appStatusId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var fMemStatusId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    if (orgId == Guid.Empty) continue;

                    var orgName = context.Orgs.GetOrgName(orgId);
                    var item = GetReportItem(items, orgName);
                    bool isInList = tempList.Any(x => x == appID);
                    if ((appStatusId == pensionerEnumId ||
                        appStatusId == emplPensionerId ||
                        fMemStatusId == pensionerEnumId ||
                        fMemStatusId == emplPensionerId) && !isInList)
                    {
                        item.confirmedFamilyWithRetiree++;
                    }
                    if (!isInList)
                    {
                        tempList.Add(appID);
                        item.countAllConfirmed++;
                    }
                }
            }

            static ReportItem GetReportItem(List<ReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.orgName == orgName);
                if (item != null) return item;
                item = new ReportItem
                {
                    orgName = orgName,
                    rowNo = items.Count > 0 ? (items.Max(x => x.rowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }

            public class ReportItem
            {
                public int rowNo { get; set; }
                public string orgName { get; set; }
                public int count { get; set; }
                public int deniedYesDurableGoods { get; set; }
                public int deniedYesFarmAnimals { get; set; }
                public int deniedFAPCIHigherThanGMI { get; set; }// family's average per capita income higher than  guaranteed minimum income
                public int deniedNoKidsUpTo18Year { get; set; }
                public int deniedOtherReason { get; set; }
                public int countAllDenied { get; set; }
                public int confirmedFamilyWithRetiree { get; set; }
                public int countAllConfirmed { get; set; }
            }

        }

        /*******************************************************************************************************************/
        public static class Report_1020
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");

            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");

            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");  // ЕСП престарелым гражданам
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");  // ЕСП на инвалида - члена семьи
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");  // ЕСП детям при утере кормильца 
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");  // ЕСП детям, инфецированным ВИЧ/СПИД
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");  // ЕСП детям от матерей с ВИЧ/СПИД до 18 месяцев
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");   // ЕСП круглым сиротам 

            // States                               
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
            private static readonly Guid onPaymentStateTypeId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Оформлен


            private static readonly Guid bankId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid applicantId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly decimal postStaticPercent = 1.3m;

            private static List<Guid> benefitPaymentList = new List<Guid>
            {
                retirementBenefitPaymentId,childBenefitPaymentId,invalidBenefitPaymentId,survivorBenefitPaymentId,
                aidsFromBenefitPaymentId,aidsBenefitPaymentId,orphanBenefitPaymentId
            };
            public static List<ReportItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var itemsBank = CalcBank(context, fd, ld);
                var itemsPost = CalcPost(context, fd, ld);
                foreach (var item in itemsBank)
                {
                    var itemPost = GetReportItem(itemsPost, item.orgName);
                    item.countAllForeignCitizen += itemPost.countAllForeignCitizen;
                    item.countUBKPerson += itemPost.countUBKPerson;
                    item.averageAmountUBK = (item.averageAmountUBK + itemPost.averageAmountUBK) / 2;
                    item.averageSumUBKTIAS = (item.averageSumUBKTIAS + itemPost.averageSumUBKTIAS) / 2;
                    item.countMSBFamily += itemPost.countMSBFamily;
                    item.averageSumMSBTIAS = (item.averageSumMSBTIAS + itemPost.averageSumMSBTIAS) / 2;
                    item.averageAmountMSB = (item.averageAmountMSB + itemPost.averageAmountMSB) / 2;
                    item.Uzbekistan += itemPost.Uzbekistan;
                    item.Tajikistan += itemPost.Tajikistan;
                    item.Belarus += itemPost.Belarus;
                    item.Armenia += itemPost.Armenia;
                    item.Moldova += itemPost.Moldova;
                    item.Kazakhstan += itemPost.Kazakhstan;
                    item.Russia += itemPost.Russia;
                    item.Ukraine += itemPost.Ukraine;
                    item.Others += itemPost.Others;
                }
                return itemsBank;
            }

            public static List<ReportItem> CalcPost(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(postOrderDefId, context.UserId);
                qb.Where("Application").Include("PaymentType")
                    .In(new object[]
                    {
                    uyBulogoKomokPaymentId,
                    retirementBenefitPaymentId,
                    childBenefitPaymentId,
                    survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId,
                    aidsBenefitPaymentId,
                    orphanBenefitPaymentId
                    })
                    .And("&State")
                    .In(new object[]
                    {
                        approvedStateId,
                        onApprovingStateId,
                        onRegisteringStateId,
                        onPaymentStateTypeId
                    })
                    .And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var applicationSrc = query.JoinSource(query.Source, appDefId, SqlSourceJoinType.Inner, "Application");
                var applicantSrc = query.JoinSource(applicationSrc, applicantId, SqlSourceJoinType.Inner, "Applicant");
                query.AddAttribute(applicationSrc, "&Id");
                query.AddAttribute("&OrgId");
                query.AddAttribute(applicationSrc, "PaymentType");
                query.AddAttribute(applicationSrc, "PaymentSum");
                query.AddAttribute(applicationSrc, "DependentCount");
                query.AddAttribute(applicantSrc, "Citizenship");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var appId = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var paymentId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var amount = reader.IsDbNull(3) ? 0m : reader.GetDecimal(3);
                        var countUBKPerson = reader.IsDbNull(4) ? 0 : reader.GetInt32(4);
                        var citizenshipId = reader.IsDbNull(5) ? Guid.Empty : reader.GetGuid(5);
                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        if (paymentId.Equals(uyBulogoKomokPaymentId))
                        {
                            item.countUBKPerson += countUBKPerson;
                            item.countUBKFamily += 1;
                            item.averageAmountUBK += amount;
                            item.averageSumUBKTIAS += (amount + Math.Round((postStaticPercent * amount) / 100, 2));
                        }
                        if (benefitPaymentList.Contains(paymentId))
                        {
                            item.countMSBFamily += 1;
                            item.averageAmountMSB += amount;
                            item.averageSumMSBTIAS += (amount + Math.Round((postStaticPercent * amount) / 100, 2));
                        }
                        if (citizenshipId.Equals(new Guid("{70A7AFF3-D6AE-4A9E-92B7-C850487DBFB2}")))
                            item.Uzbekistan += 1;
                        if (citizenshipId.Equals(new Guid("{DDD66E3B-4731-41D0-99CD-5C13C4B1DFAB}")))
                            item.Tajikistan += 1;
                        if (citizenshipId.Equals(new Guid("{0DDD3EFE-67B3-4D58-9A85-26EF0F68C9B8}")))
                            item.Belarus += 1;
                        if (citizenshipId.Equals(new Guid("{4A4FF97B-EFE0-4CAB-97B6-BAD9F7E8E6F6}")))
                            item.Armenia += 1;
                        if (citizenshipId.Equals(new Guid("{89294ABB-88D9-432A-AFBE-CC7FAF63A77A}")))
                            item.Moldova += 1;
                        if (citizenshipId.Equals(new Guid("{6D47C8D9-BD38-45BC-83C2-789D2D20FB31}")))
                            item.Kazakhstan += 1;
                        if (citizenshipId.Equals(new Guid("{70F5BD8E-9CF8-412D-BE52-7284EB2888E2}")))
                            item.Russia += 1;
                        if (citizenshipId.Equals(new Guid("{D9924C3B-6081-4487-9857-0AD2C0A4F9EE}")))
                            item.Ukraine += 1;
                        if (citizenshipId.Equals(new Guid("{EA91668C-9C5B-49BB-BCAD-3FB329766C8A}")))
                            item.Others += 1;
                    }
                }
                foreach (var item in items)
                {
                    item.countAllForeignCitizen = item.Uzbekistan + item.Tajikistan + item.Belarus + item.Armenia + item.Moldova + item.Kazakhstan + item.Russia + item.Ukraine + item.Others;
                    var countMSBFamily = 0;
                    var countUBKFamily = 0;
                    if (item.countMSBFamily == 0) countMSBFamily = 1;
                    else countMSBFamily = item.countMSBFamily;
                    if (item.countUBKFamily == 0) countUBKFamily = 1;
                    else countUBKFamily = item.countUBKFamily;
                    item.averageAmountMSB = Math.Round(item.averageAmountMSB / countMSBFamily, 2);
                    item.averageAmountUBK = Math.Round(item.averageAmountUBK / countUBKFamily, 2);
                }
                return items;
            }


            public static List<ReportItem> CalcBank(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(bankOrderDefId, context.UserId);
                qb.Where("Application").Include("PaymentType")
                    .In(new object[]
                    {
                    uyBulogoKomokPaymentId,
                    retirementBenefitPaymentId,
                    childBenefitPaymentId,
                    survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId,
                    aidsBenefitPaymentId,
                    orphanBenefitPaymentId
                    })
                    .And("&State")
                    .In(new object[]
                    {
                        approvedStateId,
                        onApprovingStateId,
                        onRegisteringStateId,
                        onPaymentStateTypeId
                    })
                    .And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var applicationSrc = query.JoinSource(query.Source, appDefId, SqlSourceJoinType.Inner, "Application");
                var bankSrc = query.JoinSource(applicationSrc, bankId, SqlSourceJoinType.LeftOuter, "Bank");
                var applicantSrc = query.JoinSource(applicationSrc, applicantId, SqlSourceJoinType.Inner, "Applicant");
                query.AddAttribute(applicationSrc, "&Id");
                query.AddAttribute("&OrgId");
                query.AddAttribute(applicationSrc, "PaymentType");
                query.AddAttribute(bankSrc, "Percent");
                query.AddAttribute(applicationSrc, "PaymentSum");
                query.AddAttribute(applicationSrc, "DependentCount");
                query.AddAttribute(applicantSrc, "Citizenship");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        //var appId = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var paymentId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var percentOfBank = reader.IsDbNull(3) ? 0f : reader.GetDouble(3);

                        var amount = reader.IsDbNull(4) ? 0m : reader.GetDecimal(4);
                        var countUBKPerson = reader.IsDbNull(5) ? 0 : reader.GetInt32(5);
                        var citizenshipId = reader.IsDbNull(6) ? Guid.Empty : reader.GetGuid(6);
                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        if (paymentId.Equals(uyBulogoKomokPaymentId))
                        {
                            item.countUBKPerson += countUBKPerson;
                            item.countUBKFamily += 1;
                            item.averageAmountUBK += amount;
                            if (percentOfBank > 0)
                            {
                                item.averageSumUBKTIAS += (amount + Math.Round((Convert.ToDecimal(percentOfBank) * Convert.ToDecimal(amount)) / 100, 2));
                            }
                            else
                            {
                                item.averageSumUBKTIAS += (amount + Math.Round((postStaticPercent * amount) / 100, 2));
                            }
                        }
                        if (benefitPaymentList.Contains(paymentId))
                        {
                            item.countMSBFamily += 1;
                            item.averageAmountMSB += amount;
                            if (percentOfBank > 0)
                            {
                                item.averageSumMSBTIAS += (amount + Math.Round((Convert.ToDecimal(percentOfBank) * Convert.ToDecimal(amount)) / 100, 2));
                            }
                            else
                            {
                                item.averageSumMSBTIAS += (amount + Math.Round((postStaticPercent * amount) / 100, 2));
                            }
                        }
                        if (citizenshipId.Equals(new Guid("{70A7AFF3-D6AE-4A9E-92B7-C850487DBFB2}")))
                            item.Uzbekistan += 1;
                        if (citizenshipId.Equals(new Guid("{DDD66E3B-4731-41D0-99CD-5C13C4B1DFAB}")))
                            item.Tajikistan += 1;
                        if (citizenshipId.Equals(new Guid("{0DDD3EFE-67B3-4D58-9A85-26EF0F68C9B8}")))
                            item.Belarus += 1;
                        if (citizenshipId.Equals(new Guid("{4A4FF97B-EFE0-4CAB-97B6-BAD9F7E8E6F6}")))
                            item.Armenia += 1;
                        if (citizenshipId.Equals(new Guid("{89294ABB-88D9-432A-AFBE-CC7FAF63A77A}")))
                            item.Moldova += 1;
                        if (citizenshipId.Equals(new Guid("{6D47C8D9-BD38-45BC-83C2-789D2D20FB31}")))
                            item.Kazakhstan += 1;
                        if (citizenshipId.Equals(new Guid("{70F5BD8E-9CF8-412D-BE52-7284EB2888E2}")))
                            item.Russia += 1;
                        if (citizenshipId.Equals(new Guid("{D9924C3B-6081-4487-9857-0AD2C0A4F9EE}")))
                            item.Ukraine += 1;
                        if (citizenshipId.Equals(new Guid("{EA91668C-9C5B-49BB-BCAD-3FB329766C8A}")))
                            item.Others += 1;
                    }
                }
                foreach (var item in items)
                {
                    item.countAllForeignCitizen = item.Uzbekistan + item.Tajikistan + item.Belarus + item.Armenia + item.Moldova + item.Kazakhstan + item.Russia + item.Ukraine + item.Others;
                    var countMSBFamily = 0;
                    var countUBKFamily = 0;
                    if (item.countMSBFamily == 0) countMSBFamily = 1;
                    else countMSBFamily = item.countMSBFamily;
                    if (item.countUBKFamily == 0) countUBKFamily = 1;
                    else countUBKFamily = item.countUBKFamily;
                    item.averageAmountMSB = Math.Round(item.averageAmountMSB / countMSBFamily, 2);
                    item.averageAmountUBK = Math.Round(item.averageAmountUBK / countUBKFamily, 2);
                }
                return items;
            }

            static ReportItem GetReportItem(List<ReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.orgName == orgName);
                if (item != null) return item;
                item = new ReportItem
                {
                    orgName = orgName,
                    rowNo = items.Count > 0 ? (items.Max(x => x.rowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }
            public class ReportItem
            {
                public int rowNo { get; set; }
                public string orgName { get; set; }
                public int countAllForeignCitizen { get; set; }
                public int countUBKFamily { get; set; }
                public int countUBKPerson { get; set; }
                public decimal averageAmountUBK { get; set; } //UBK-Uy bulogo komok
                public decimal averageSumUBKTIAS { get; set; } // TIAS-taking into account services
                public int countMSBFamily { get; set; } //MSB-monthly social benefit
                public decimal averageAmountMSB { get; set; }
                public decimal averageSumMSBTIAS { get; set; }
                public int Uzbekistan { get; set; }
                public int Tajikistan { get; set; }
                public int Belarus { get; set; }
                public int Armenia { get; set; }
                public int Moldova { get; set; }
                public int Kazakhstan { get; set; }
                public int Russia { get; set; }
                public int Ukraine { get; set; }
                public int Others { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1021
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");

            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");

            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");  // ЕСП престарелым гражданам
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");  // ЕСП на инвалида - члена семьи
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");  // ЕСП детям при утере кормильца 
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");  // ЕСП детям, инфецированным ВИЧ/СПИД
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");  // ЕСП детям от матерей с ВИЧ/СПИД до 18 месяцев
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");   // ЕСП круглым сиротам 

            // States                               
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
            private static readonly Guid onPaymentStateTypeId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Оформлен


            private static readonly Guid bankId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid applicantId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid statusOfRefugee = new Guid("{2E815185-6075-4207-8271-541970BDC3EF}");
            // new Guid("{C7682621-4931-4125-8F0D-F568295B668B}");
            private static readonly decimal postStaticPercent = 1.3m;

            private static List<Guid> benefitPaymentList = new List<Guid>
            {
                retirementBenefitPaymentId,childBenefitPaymentId,invalidBenefitPaymentId,survivorBenefitPaymentId,
                aidsFromBenefitPaymentId,aidsBenefitPaymentId,orphanBenefitPaymentId
            };

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(appDefId, context.UserId);
                qb.Where("PaymentType")
                    .In(new object[]
                    {
                    uyBulogoKomokPaymentId,
                    retirementBenefitPaymentId,
                    childBenefitPaymentId,
                    survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId,
                    aidsBenefitPaymentId,
                    orphanBenefitPaymentId
                    })
                    .And("&State")
                    .In(new object[]
                    {
                        approvedStateId,
                        onApprovingStateId,
                        onRegisteringStateId,
                        onPaymentStateTypeId
                    }).And("Applicant").Include("DocumentType").Eq(statusOfRefugee).End()
                        .And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var bankSrc = query.JoinSource(query.Source, bankId, SqlSourceJoinType.LeftOuter, "Bank");
                var applicantSrc = query.JoinSource(query.Source, applicantId, SqlSourceJoinType.Inner, "Applicant");
                query.AddAttribute("&Id");
                query.AddAttribute("&OrgId");
                query.AddAttribute("PaymentType");
                query.AddAttribute(bankSrc, "Percent");
                query.AddAttribute("PaymentSum");
                query.AddAttribute("DependentCount");
                query.AddAttribute(applicantSrc, "Citizenship");


                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        //if (bankSrc == Guid.Empty) continue;
                        var appId = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var paymentId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var percentOfBank = reader.IsDbNull(3) ? 0f : reader.GetDouble(3);
                        var amount = reader.IsDbNull(4) ? 0m : reader.GetDecimal(4);
                        var countUBKPerson = reader.IsDbNull(5) ? 0 : reader.GetInt32(5);
                        var citizenshipId = reader.IsDbNull(6) ? Guid.Empty : reader.GetGuid(6);


                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);



                        if (paymentId.Equals(uyBulogoKomokPaymentId))
                        {
                            item.countUBKPerson += countUBKPerson;
                            item.countUBKFamily += 1;
                            item.averageAmountUBK += amount;
                            if (percentOfBank > 0)
                            {
                                item.averageSumUBKTIAS += (amount + Math.Round((Convert.ToDecimal(percentOfBank) * Convert.ToDecimal(amount)) / 100, 2));
                            }
                            else
                            {
                                item.averageSumUBKTIAS += (amount + Math.Round((postStaticPercent * amount) / 100, 2));
                            }
                        }
                        if (benefitPaymentList.Contains(paymentId))
                        {
                            item.countMSBFamily += 1;
                            item.averageAmountMSB += amount;
                            if (percentOfBank > 0)
                            {
                                item.averageSumMSBTIAS += (amount + Math.Round((Convert.ToDecimal(percentOfBank) * Convert.ToDecimal(amount)) / 100, 2));
                            }
                            else
                            {
                                item.averageSumMSBTIAS += (amount + Math.Round((postStaticPercent * amount) / 100, 2));
                            }
                        }

                        if (citizenshipId.Equals(new Guid("{70A7AFF3-D6AE-4A9E-92B7-C850487DBFB2}")))
                            item.Uzbekistan += 1;
                        if (citizenshipId.Equals(new Guid("{DDD66E3B-4731-41D0-99CD-5C13C4B1DFAB}")))
                            item.Tajikistan += 1;
                        if (citizenshipId.Equals(new Guid("{3521D5A1-448F-4FD2-BD5B-B191F05F1262}")))
                            item.China += 1;
                        if (citizenshipId.Equals(new Guid("{E598DFA1-E503-4F3C-8DEC-D185F58F548F}")))
                            item.Turkey += 1;
                        if (citizenshipId.Equals(new Guid("{049FA841-4D56-4936-989D-501C54D32F92}")))
                            item.Pakistan += 1;
                        if (citizenshipId.Equals(new Guid("{6D47C8D9-BD38-45BC-83C2-789D2D20FB31}")))
                            item.Kazakhstan += 1;
                        if (citizenshipId.Equals(new Guid("{70F5BD8E-9CF8-412D-BE52-7284EB2888E2}")))
                            item.Russia += 1;
                        if (citizenshipId.Equals(new Guid("{EA91668C-9C5B-49BB-BCAD-3FB329766C8A}")))
                            item.Others += 1;

                    }
                }

                foreach (var item in items)
                {
                    item.countAllForeignCitizen = item.Uzbekistan + item.Tajikistan + item.China + item.Turkey + item.Pakistan + item.Kazakhstan + item.Russia + item.Others;
                    var countMSBFamily = 0;
                    var countUBKFamily = 0;
                    if (item.countMSBFamily == 0) countMSBFamily = 1;
                    else countMSBFamily = item.countMSBFamily;
                    if (item.countUBKFamily == 0) countUBKFamily = 1;
                    else countUBKFamily = item.countUBKFamily;
                    item.averageAmountMSB = Math.Round(item.averageAmountMSB / countMSBFamily, 2);
                    item.averageAmountUBK = Math.Round(item.averageAmountUBK / countUBKFamily, 2);
                }
                return items;
            }

            static ReportItem GetReportItem(List<ReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.orgName == orgName);
                if (item != null) return item;
                item = new ReportItem
                {
                    orgName = orgName,
                    rowNo = items.Count > 0 ? (items.Max(x => x.rowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }
            public class ReportItem
            {
                public int rowNo { get; set; }
                public string orgName { get; set; }
                public int countAllForeignCitizen { get; set; }
                public int countUBKFamily { get; set; }
                public int countUBKPerson { get; set; }
                public decimal averageAmountUBK { get; set; } //UBK-Uy bulogo komok
                public decimal averageSumUBKTIAS { get; set; } // TIAS-taking into account services
                public int countMSBFamily { get; set; } //MSB-monthly social benefit
                public decimal averageAmountMSB { get; set; }
                public decimal averageSumMSBTIAS { get; set; }
                public int Uzbekistan { get; set; }
                public int Tajikistan { get; set; }
                public int China { get; set; }
                public int Turkey { get; set; }
                public int Pakistan { get; set; }
                public int Kazakhstan { get; set; }
                public int Russia { get; set; }
                public int Others { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class FC_1022
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}"); //Банковский счет
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}"); //Почтовое поручения
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");

            private static readonly Guid categoryType1Id = new Guid("{12C16D1F-1AF5-4BB0-931A-2D1D9F07E1A5}");//Детям погибшего в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid categoryType2Id = new Guid("{1BFDE4A6-D55F-435A-A34E-B77FAAEA265B}");//Родителям погибшего в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid categoryType3Id = new Guid("{4F53C318-8590-453C-9A06-B7CD9DB29888}");//Вдовам погибшего в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid categoryType4Id = new Guid("{E049D13F-DE27-4644-8473-E1F50F5C5611}");//Лицам, признанным инвалидами  в событиях 17-18 марта 2002 года  в Аксыйском районе Джалал-Абадской области
            private static readonly Guid paymentTypeESPId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности

            private static readonly Guid familyMemberDefId = new Guid("{85B03F9E-47D7-4829-8041-0CDCB8486572}");
            private static readonly Guid membershipTypeId = new Guid("{586102C3-962A-49CB-A914-87F2139986A3}");
            private static readonly Guid applicantId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");

            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");
            private static readonly Guid aksyOrgIdId = new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"); 
            private static readonly Guid leninskiiOrgId = new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}");


            private static readonly List<Guid> SocialBenefitsList = new List<Guid>
            {
                retirementBenefitPaymentId,childBenefitPaymentId,invalidBenefitPaymentId,
                survivorBenefitPaymentId,aidsFromBenefitPaymentId,aidsBenefitPaymentId,
                orphanBenefitPaymentId
            };
            private static readonly Guid despAksyPaymentTypeId = new Guid("{E590688C-FE0E-4DE2-BEFC-35887CD23ABA}");

            private static readonly List<Guid> AksyCategoryList = new List<Guid>
            {
                categoryType1Id, categoryType2Id,categoryType3Id,categoryType4Id
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(postOrderDefId, context.UserId);
                qb.Where("Application")
                   .Include("PaymentCategory")
                   .In(new object[]
                    {
                        categoryType1Id,
                        categoryType2Id,
                        categoryType3Id,
                        categoryType4Id
                    }).End().And("ExpiryDate").Ge(fd);

                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var applicationSrc = query.JoinSource(query.Source, appDefId, SqlSourceJoinType.Inner, "Application");
                var applicantSrc = query.JoinSource(applicationSrc, applicantId, SqlSourceJoinType.Inner, "Applicant");

                var assignmentSrc = query.JoinSource(applicationSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                var personSrc = query.JoinSource(assignmentSrc, applicantId, SqlSourceJoinType.Inner, "Person");                
                query.AddCondition(ExpressionOperation.And, appDefId, "&OrgId", ConditionOperation.In, new object[]
                {
                    aksyOrgIdId, leninskiiOrgId
                });

                query.AddAttribute(applicationSrc, "Town");
                query.AddAttribute(applicationSrc, "Street");
                query.AddAttribute(applicationSrc, "House");
                query.AddAttribute(applicationSrc, "Apartment");

                query.AddAttribute(applicantSrc, "FirstName");
                query.AddAttribute(applicantSrc, "MiddleName");
                query.AddAttribute(applicantSrc, "LastName");
                query.AddAttribute(applicantSrc, "BirthDate");

                query.AddAttribute(personSrc, "FirstName");
                query.AddAttribute(personSrc, "MiddleName");
                query.AddAttribute(personSrc, "LastName");
                query.AddAttribute(personSrc, "BirthDate");
                query.AddAttribute(assignmentSrc, "MembershipType");
                query.AddAttribute(assignmentSrc, "Amount");
                query.AddAttribute(applicationSrc, "&Id");
                query.AddAttribute(applicationSrc, "PaymentSum");
                query.AddAttribute(applicationSrc, "PaymentCategory");
                query.AddAttribute(applicationSrc, "PaymentType");
                query.AddAttribute(personSrc, "PIN");
                query.AddAttribute(query.Source, "&Id");

                var qbB = new QueryBuilder(bankOrderDefId, context.UserId);
                qbB.Where("Application")
                   .Include("PaymentCategory")
                   .In(new object[]
                    {
                        categoryType1Id,
                        categoryType2Id,
                        categoryType3Id,
                        categoryType4Id
                    }).End().And("ExpiryDate").Ge(fd);
                SqlQuery queryBank = SqlQueryBuilder.Build(context.DataContext, qbB.Def);
                var applicationBankSrc = queryBank.JoinSource(queryBank.Source, appDefId, SqlSourceJoinType.Inner, "Application");
                var applicantBankSrc = queryBank.JoinSource(applicationBankSrc, applicantId, SqlSourceJoinType.Inner, "Applicant");

                var assignmentBankSrc = queryBank.JoinSource(applicationBankSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                var personBankSrc = queryBank.JoinSource(assignmentBankSrc, applicantId, SqlSourceJoinType.Inner, "Person");
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "&OrgId", ConditionOperation.In, new object[]
                {
                    aksyOrgIdId, leninskiiOrgId
                });

                queryBank.AddAttribute(applicationBankSrc, "Town");
                queryBank.AddAttribute(applicationBankSrc, "Street");
                queryBank.AddAttribute(applicationBankSrc, "House");
                queryBank.AddAttribute(applicationBankSrc, "Apartment");

                queryBank.AddAttribute(applicantBankSrc, "FirstName");
                queryBank.AddAttribute(applicantBankSrc, "MiddleName");
                queryBank.AddAttribute(applicantBankSrc, "LastName");
                queryBank.AddAttribute(applicantBankSrc, "BirthDate");

                queryBank.AddAttribute(personBankSrc, "FirstName");
                queryBank.AddAttribute(personBankSrc, "MiddleName");
                queryBank.AddAttribute(personBankSrc, "LastName");
                queryBank.AddAttribute(personBankSrc, "BirthDate");
                queryBank.AddAttribute(assignmentBankSrc, "MembershipType");
                queryBank.AddAttribute(assignmentBankSrc, "Amount");
                queryBank.AddAttribute(applicationBankSrc, "&Id");
                queryBank.AddAttribute(applicationBankSrc, "PaymentSum");
                queryBank.AddAttribute(applicationBankSrc, "PaymentCategory");
                queryBank.AddAttribute(applicationBankSrc, "PaymentType");
                queryBank.AddAttribute(personBankSrc, "PIN");
                queryBank.AddAttribute(queryBank.Source, "&Id");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var town = reader.IsDbNull(0) ? "-" : reader.GetString(0);
                        var street = reader.IsDbNull(1) ? "-" : reader.GetString(1);
                        var house = reader.IsDbNull(2) ? "-" : reader.GetString(2);
                        var apartment = reader.IsDbNull(3) ? "-" : reader.GetString(3);

                        var firstNameApplicant = reader.IsDbNull(4) ? "-" : reader.GetString(4);
                        var middleNameApplicant = reader.IsDbNull(5) ? "-" : reader.GetString(5);
                        var lastNameApplicant = reader.IsDbNull(6) ? "-" : reader.GetString(6);
                        var birthDateApplicant = reader.IsDbNull(7) ? DateTime.MinValue : reader.GetDateTime(7);

                        var firstNameMember = reader.IsDbNull(8) ? "-" : reader.GetString(8);
                        var middleNameMember = reader.IsDbNull(9) ? "-" : reader.GetString(9);
                        var lastNameMember = reader.IsDbNull(10) ? "-" : reader.GetString(10);
                        var birthDateMember = reader.IsDbNull(11) ? DateTime.MinValue : reader.GetDateTime(11);

                        var membershipTypeId = reader.IsDbNull(12) ? Guid.Empty : reader.GetGuid(12);
                        var amountMember = reader.IsDbNull(13) ? 0m : reader.GetDecimal(13);
                        var applicantId = reader.IsDbNull(14) ? Guid.Empty : reader.GetGuid(14);
                        var paymentSumApplicant = reader.IsDbNull(15) ? 0m : reader.GetDecimal(15);
                        var categoryId = reader.IsDbNull(16) ? Guid.Empty : reader.GetGuid(16);
                        var paymentTypeId = reader.IsDbNull(17) ? Guid.Empty : reader.GetGuid(17);
                        var assignPersonPINId = reader.IsDbNull(18) ? "-" : reader.GetString(18);
                        var orderId = reader.IsDbNull(19) ? Guid.Empty : reader.GetGuid(19);


                        decimal socPaySumApp = GetSocialAmountByPersonId(context, assignPersonPINId, fd);
                       
                        //if (AksyCategoryList.Contains(categoryId))
                        var item = GetReportItem(items, applicantId);
                        if (orderId != Guid.Empty)
                        {
                           
                            item.applicant.address = town + " " + street + " " + house + " " + apartment;
                            item.applicant.fullName = firstNameApplicant + " " + middleNameApplicant + " " + lastNameApplicant;

                            item.applicant.membershipType = "";
                            item.applicant.yearOfBirth = birthDateApplicant;

                            if (despAksyPaymentTypeId.Equals(paymentTypeId))
                            {
                                item.applicant.priceAddSocialBenefit = paymentSumApplicant;
                                item.applicant.sumFromBeginOfYearAddSocialBenefit = paymentSumApplicant * month;
                            }
                            //if (AksyCategoryList.Contains(paymentTypeId))
                            
                            //item.applicant.priceSocialBenefit = socPaySumApp;
                            //item.applicant.sumFromBeginOfYear = socPaySumApp * month;
                    
                            item.applicant.totalSumFromBeginOfYear = item.applicant.sumFromBeginOfYearAddSocialBenefit + item.applicant.sumFromBeginOfYear;
                            item.applicant.categoryName = context.Enums.GetValue(categoryId).Value;

                            if (!membershipTypeId.Equals(Guid.Empty))
                            {
                                var memberOfFamily = new SubReportItem();
                                memberOfFamily.fullName = firstNameMember + " " + middleNameMember + " " + lastNameMember;
                                memberOfFamily.membershipType = context.Enums.GetValue(membershipTypeId).Value;
                                memberOfFamily.yearOfBirth = birthDateMember;

                                if (despAksyPaymentTypeId.Equals(paymentTypeId))
                                {
                                    memberOfFamily.priceAddSocialBenefit = amountMember;
                                    memberOfFamily.sumFromBeginOfYearAddSocialBenefit = amountMember * month;
                                }
                                if (AksyCategoryList.Contains(paymentTypeId))
                                {
                                    memberOfFamily.priceSocialBenefit = amountMember;
                                    memberOfFamily.sumFromBeginOfYear = amountMember * month;
                                }
                                memberOfFamily.totalSumFromBeginOfYear = memberOfFamily.sumFromBeginOfYearAddSocialBenefit + memberOfFamily.sumFromBeginOfYear;
                                memberOfFamily.categoryName = context.Enums.GetValue(categoryId).Value;
                                item.membersOfFamily.Add(memberOfFamily);
                            }
                        }
                        item.applicant.priceSocialBenefit = socPaySumApp;
                        item.applicant.sumFromBeginOfYear = socPaySumApp * month;
                    }
                }
                using (var reader = new SqlQueryReader(context.DataContext, queryBank))
                {
                    while (reader.Read())
                    {
                        var town = reader.IsDbNull(0) ? "-" : reader.GetString(0);
                        var street = reader.IsDbNull(1) ? "-" : reader.GetString(1);
                        var house = reader.IsDbNull(2) ? "-" : reader.GetString(2);
                        var apartment = reader.IsDbNull(3) ? "-" : reader.GetString(3);

                        var firstNameApplicant = reader.IsDbNull(4) ? "-" : reader.GetString(4);
                        var middleNameApplicant = reader.IsDbNull(5) ? "-" : reader.GetString(5);
                        var lastNameApplicant = reader.IsDbNull(6) ? "-" : reader.GetString(6);
                        var birthDateApplicant = reader.IsDbNull(7) ? DateTime.MinValue : reader.GetDateTime(7);

                        var firstNameMember = reader.IsDbNull(8) ? "-" : reader.GetString(8);
                        var middleNameMember = reader.IsDbNull(9) ? "-" : reader.GetString(9);
                        var lastNameMember = reader.IsDbNull(10) ? "-" : reader.GetString(10);
                        var birthDateMember = reader.IsDbNull(11) ? DateTime.MinValue : reader.GetDateTime(11);

                        var membershipTypeId = reader.IsDbNull(12) ? Guid.Empty : reader.GetGuid(12);
                        var amountMember = reader.IsDbNull(13) ? 0m : reader.GetDecimal(13);
                        var applicantId = reader.IsDbNull(14) ? Guid.Empty : reader.GetGuid(14);
                        var paymentSumApplicant = reader.IsDbNull(15) ? 0m : reader.GetDecimal(15);
                        var categoryId = reader.IsDbNull(16) ? Guid.Empty : reader.GetGuid(16);
                        var paymentTypeId = reader.IsDbNull(17) ? Guid.Empty : reader.GetGuid(17);
                        var assignPersonPINId = reader.IsDbNull(18) ? "-" : reader.GetString(18);
                        var orderId = reader.IsDbNull(19) ? Guid.Empty : reader.GetGuid(19);

                        decimal socPaySumApp = GetSocialAmountByPersonId(context, assignPersonPINId, fd);

                        //if (AksyCategoryList.Contains(categoryId))
                        var item = GetReportItem(items, applicantId);
                        if (orderId != Guid.Empty)
                        {
                           // var item = GetReportItem(items, applicantId);
                            item.applicant.address = town + " " + street + " " + house + " " + apartment;
                            item.applicant.fullName = firstNameApplicant + " " + middleNameApplicant + " " + lastNameApplicant;

                            item.applicant.membershipType = "";
                            item.applicant.yearOfBirth = birthDateApplicant;

                            if (despAksyPaymentTypeId.Equals(paymentTypeId))
                            {
                                item.applicant.priceAddSocialBenefit = paymentSumApplicant;
                                item.applicant.sumFromBeginOfYearAddSocialBenefit = paymentSumApplicant * month;
                            }
                            //if (AksyCategoryList.Contains(paymentTypeId))
                            
                            //item.applicant.priceSocialBenefit = socPaySumApp;
                            //item.applicant.sumFromBeginOfYear = socPaySumApp * month;
                    
                            item.applicant.totalSumFromBeginOfYear = item.applicant.sumFromBeginOfYearAddSocialBenefit + item.applicant.sumFromBeginOfYear;
                            item.applicant.categoryName = context.Enums.GetValue(categoryId).Value;

                            if (!membershipTypeId.Equals(Guid.Empty))
                            {
                                var memberOfFamily = new SubReportItem();
                                memberOfFamily.fullName = firstNameMember + " " + middleNameMember + " " + lastNameMember;
                                memberOfFamily.membershipType = context.Enums.GetValue(membershipTypeId).Value;
                                memberOfFamily.yearOfBirth = birthDateMember;

                                if (despAksyPaymentTypeId.Equals(paymentTypeId))
                                {
                                    memberOfFamily.priceAddSocialBenefit = amountMember;
                                    memberOfFamily.sumFromBeginOfYearAddSocialBenefit = amountMember * month;
                                }
                                if (AksyCategoryList.Contains(paymentTypeId))
                                {
                                    memberOfFamily.priceSocialBenefit = amountMember;
                                    memberOfFamily.sumFromBeginOfYear = amountMember * month;
                                }
                                memberOfFamily.totalSumFromBeginOfYear = memberOfFamily.sumFromBeginOfYearAddSocialBenefit + memberOfFamily.sumFromBeginOfYear;
                                memberOfFamily.categoryName = context.Enums.GetValue(categoryId).Value;
                                item.membersOfFamily.Add(memberOfFamily);
                            }                            
                        }
                        item.applicant.priceSocialBenefit = socPaySumApp;
                        item.applicant.sumFromBeginOfYear = socPaySumApp * month;
                    }
                }
                foreach (var item in items)
                {
                    item.totalSBsumFromBeginOfYear = item.applicant.sumFromBeginOfYear;
                    item.totalAddSBsumFromBeginOfYear = item.applicant.sumFromBeginOfYearAddSocialBenefit;
                    item.totalSumFromBeginOfYear = item.applicant.totalSumFromBeginOfYear;

                    foreach (var subItem in item.membersOfFamily)
                    {
                        item.totalSBsumFromBeginOfYear = item.totalSBsumFromBeginOfYear + subItem.sumFromBeginOfYear;
                        item.totalAddSBsumFromBeginOfYear = item.totalAddSBsumFromBeginOfYear + subItem.sumFromBeginOfYearAddSocialBenefit;
                        item.totalSumFromBeginOfYear = item.totalSumFromBeginOfYear + subItem.totalSumFromBeginOfYear;
                    }
                }

                return items;
            }

            static decimal GetSocialAmountByPersonId(WorkflowContext context, string assignPersonPINId, DateTime fd)
            {
                var qb = new QueryBuilder(assignmentDefId);
                qb.Where("Person").Include("PIN").Eq(assignPersonPINId).End().And("PaymentType").Eq(paymentTypeESPId)/*.And("ExpiryDate").Ge(fd)*/;
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Amount");
                query.TopNo = 1;
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    if(reader.Read())
                    {
                        return reader.IsDbNull(0) ? 0 : reader.GetDecimal(0);
                    }
                }
                return 0;
                /*
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;*/
            }
            static ReportItem GetReportItem(List<ReportItem> items, Guid _applicantId)
            {
                var item = items.FirstOrDefault(x => x.getApplicantId().Equals(_applicantId));
                if (item != null) return item;
                item = new ReportItem(_applicantId);
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                private Guid applicantId { get; set; }
                [DataMember]
                public SubReportItem applicant { get; set; }
                [DataMember]
                public List<SubReportItem> membersOfFamily { get; set; }

                public decimal totalSBsumFromBeginOfYear { get; set; }
                public decimal totalAddSBsumFromBeginOfYear { get; set; }
                public decimal totalSumFromBeginOfYear { get; set; }

                public Guid getApplicantId()
                {
                    return applicantId;
                }
                public ReportItem(Guid ApplicantId)
                {
                    applicantId = ApplicantId;
                    applicant = new SubReportItem();
                    membersOfFamily = new List<SubReportItem>();
                }
            }

            [DataContract]
            public class SubReportItem
            {
                [DataMember]
                public string fullName { get; set; }
                [DataMember]
                public string address { get; set; }
                [DataMember]
                public string membershipType { get; set; }
                [DataMember]
                public DateTime yearOfBirth { get; set; }
                [DataMember]
                public decimal priceSocialBenefit { get; set; }
                [DataMember]
                public decimal sumFromBeginOfYear { get; set; }
                [DataMember]
                public decimal priceAddSocialBenefit { get; set; }
                [DataMember]
                public decimal sumFromBeginOfYearAddSocialBenefit { get; set; }
                [DataMember]
                public decimal totalSumFromBeginOfYear { get; set; }
                [DataMember]
                public string categoryName { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1023
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");

            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");

            // States                               
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
            private static readonly Guid onPaymentStateTypeId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Оформлен

            //RefuseReasonType
            private static readonly Guid deniedYesDurableGoodsId = new Guid("{EEF4A0D7-9763-4E39-907E-DCC46C929DF0}");
            private static readonly Guid deniedYesFarmAnimalsId = new Guid("{690F141C-2FCD-4014-B309-C7106C0FE1FF}");
            private static readonly Guid deniedFAPCIHigherThanGMI = new Guid("{A71ABA04-F07B-4AFB-B372-24EF87EEAC62}");
            private static readonly Guid deniedNoKidsUpTo18Year = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}");
            private static readonly Guid deniedOtherReason = new Guid("{E7D459E6-C63F-4EEB-A7E8-B4B9A82FB0D0}");
            private static readonly Guid confirmedFamilyWithRetiree = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}");

            static Guid familyMemberDefId = new Guid("{85B03F9E-47D7-4829-8041-0CDCB8486572}");
            static Guid pensionerEnumId = new Guid("{CC14F361-689D-49B7-AC9B-259B0E84C399}");
            static Guid emplPensionerId = new Guid("{8617FB6E-6C54-4C6E-97C3-1A7D2887AA30}");

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(appDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("&State").Eq(refusedStateId).And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("&OrgId");
                query.AddAttribute("RefuseReason");
                query.AddGroupAttribute("&OrgId");
                query.AddGroupAttribute("RefuseReason");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var orgId = reader.IsDbNull(1) ? Guid.Empty : reader.GetGuid(1);
                        var refuseReasonId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);

                        if (orgId == Guid.Empty) continue;
                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(items, orgName);
                        if (refuseReasonId.Equals(deniedYesDurableGoodsId))
                        {
                            item.deniedYesDurableGoods += count;
                        }
                        if (refuseReasonId.Equals(deniedYesFarmAnimalsId))
                        {
                            item.deniedYesFarmAnimals += count;
                        }
                        if (refuseReasonId.Equals(deniedFAPCIHigherThanGMI))
                        {
                            item.deniedFAPCIHigherThanGMI += count;
                        }
                        if (refuseReasonId.Equals(deniedNoKidsUpTo18Year))
                        {
                            item.deniedNoKidsUpTo18Year += count;
                        }
                        if (refuseReasonId.Equals(deniedOtherReason))
                        {
                            item.deniedOtherReason += count;
                        }
                        item.countAllDenied += count;
                    }
                }
                GetConfirmedAppBaseData(context, year, month, items);

                return items;
            }


            public static void GetConfirmedAppBaseData(WorkflowContext context, int year, int month, List<ReportItem> items)
            {
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(appDefId, context.UserId);
                qb.Where("PaymentType").Eq(uyBulogoKomokPaymentId).And("&State")
                    .In(new object[]
                    {
                        approvedStateId,
                        onApprovingStateId,
                        //onRegisteringStateId,
                        onPaymentStateTypeId
                    })
                    .And("RegDate").Ge(fd).And("RegDate").Le(ld);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var fMemSrc = query.JoinSource(query.Source, familyMemberDefId, SqlSourceJoinType.Inner, "FamilyMembers");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(query.Source, "EmploymentStatus");
                query.AddAttribute(fMemSrc, "EmploymentStatus");

                var table = new DataTable();

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                var tempList = new HashSet<Guid>();
                foreach (DataRow row in table.Rows)
                {
                    var appID = (Guid)row[0];
                    var orgId = (Guid)row[1];
                    var appStatusId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var fMemStatusId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    if (orgId == Guid.Empty) continue;

                    var orgName = context.Orgs.GetOrgName(orgId);
                    var item = GetReportItem(items, orgName);
                    bool isInList = tempList.Any(x => x == appID);
                    if ((appStatusId == pensionerEnumId ||
                        appStatusId == emplPensionerId ||
                        fMemStatusId == pensionerEnumId ||
                        fMemStatusId == emplPensionerId) && !isInList)
                    {
                        item.confirmedFamilyWithRetiree++;
                    }
                    if (!isInList)
                    {
                        tempList.Add(appID);
                        item.countAllConfirmed++;
                    }
                }
            }

            static ReportItem GetReportItem(List<ReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.orgName == orgName);
                if (item != null) return item;
                item = new ReportItem
                {
                    orgName = orgName,
                    rowNo = items.Count > 0 ? (items.Max(x => x.rowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }

            public class ReportItem
            {
                public int rowNo { get; set; }
                public string orgName { get; set; }
                public int count { get; set; }
                public int deniedYesDurableGoods { get; set; }
                public int deniedYesFarmAnimals { get; set; }
                public int deniedFAPCIHigherThanGMI { get; set; }// family's average per capita income higher than  guaranteed minimum income
                public int deniedNoKidsUpTo18Year { get; set; }
                public int deniedOtherReason { get; set; }
                public int countAllDenied { get; set; }
                public int confirmedFamilyWithRetiree { get; set; }
                public int countAllConfirmed { get; set; }
            }

        }

        /*******************************************************************************************************************/
        public static class FC_1024
        {
            private static readonly Guid uyBulogoKomokPaymentId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}");

            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");

            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");  // ЕСП престарелым гражданам
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");  // ЕСП на инвалида - члена семьи
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");  // ЕСП детям при утере кормильца 
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");  // ЕСП детям, инфецированным ВИЧ/СПИД
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");  // ЕСП детям от матерей с ВИЧ/СПИД до 18 месяцев
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");   // ЕСП круглым сиротам 

            // States                               
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан
            private static readonly Guid onPaymentStateTypeId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Оформлен

            private static readonly Guid childUpTo3Id = new Guid("{D8FF3DAF-A701-414A-B965-4BF93BB658B9}"); //Ребенок до 3-х лет
            private static readonly Guid childUpTo16Id = new Guid("{8024982A-4AFB-4074-9D63-3EEFE22420E0}");  //Ребенок от 3-х до 16 лет  
            private static readonly Guid childUpTo1618Id = new Guid("{8024982A-4AFB-4074-9D63-3EEFE22420E0}");  //Учащийся 16-18л

            private static readonly Guid childISPCategoryId = new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}"); //Дети, больные ДЦП
            private static readonly Guid childDisableCategoryId = new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}");//ЛОВЗ (до 18 лет)
            private static readonly Guid childenAidsCategoryId = new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}"); //Дети ВИЧ-инфиц.или больные СПИДом
            private static readonly Guid childFromAidsCategoryId = new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}"); //Дети, рожденные от матерей,живущих с ВИЧ-СПИДом
            private static readonly Guid childhood1CategoryId = new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}");
            private static readonly Guid childhood2CategoryId = new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}");
            private static readonly Guid childhood3CategoryId = new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}");
            private static readonly Guid commonDeseas1CategoryId = new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}");
            private static readonly Guid commonDeseas2CategoryId = new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}");
            private static readonly Guid commonDeseas3CategoryId = new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}");
            private static readonly Guid alpineRetirementCategoryId = new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}");
            private static readonly Guid retirementCategoryId = new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}");
            private static readonly Guid heroMotherCategoryId = new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}");
            private static readonly Guid orphanChildren = new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}");
            private static readonly Guid childSurvivorsCategoryId = new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}");
            private static readonly List<Guid> childUpTo18YearList = new List<Guid>
            {
                childUpTo3Id,
                childUpTo16Id,
                childUpTo1618Id
            };
            private static readonly List<Guid> msbList = new List<Guid>
            {
                    retirementBenefitPaymentId,
                    childBenefitPaymentId,
                    survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId,
                    aidsBenefitPaymentId,
                    orphanBenefitPaymentId
            };
            private static readonly Guid twinsId = new Guid("{45D55628-5E72-42B8-8B8D-667346E79046}"); // Двойня
            private static readonly Guid tripletsId = new Guid("{8CCAE21E-128A-4728-9479-9C094271C614}"); // Тройня
            public class ReportItem
            {
                public ReportItem()
                {
                    childUpTo18YearUBK = new SubItem();
                    twinsUpTo3YearUBK = new SubItem();
                    tripletsUpTo16YearUBK = new SubItem();
                    allReceiverUBK = new SubItem();
                    allFamilyUBK = new SubItem();
                    disabledChildCerebralPalsy = new SubItem();
                    disabledChildUpTo18Year = new SubItem();
                    disabledChildAIDS = new SubItem();
                    disabledChildBurnFromAIDSMothers = new SubItem();
                    disabledChildUpTo18YearAll = new SubItem();
                    disabledChildFirstCategory = new SubItem();
                    disabledChildSecondCategory = new SubItem();
                    disabledChildThirdCategory = new SubItem();
                    disabledChildWithCategoriesAll = new SubItem();
                    disabledGeneralIlnessFirstCategory = new SubItem();
                    disabledGeneralIlnessSecondCategory = new SubItem();
                    disabledGeneralIlnessThirdCategory = new SubItem();
                    disabledGeneralIlnessWithCategoriesAll = new SubItem();
                    agedCitizens = new SubItem();
                    agedHighlandResident = new SubItem();
                    motherHeroine = new SubItem();
                    childLoseBreadWinner = new SubItem();
                    childOrphan = new SubItem();
                }
                public SubItem childUpTo18YearUBK { get; set; }
                public SubItem twinsUpTo3YearUBK { get; set; }
                public SubItem tripletsUpTo16YearUBK { get; set; }
                public SubItem allReceiverUBK { get; set; }
                public decimal averageSumPriceUBK { get; set; }
                public SubItem allFamilyUBK { get; set; }
                public SubItem disabledChildCerebralPalsy { get; set; }
                public SubItem disabledChildUpTo18Year { get; set; }
                public SubItem disabledChildAIDS { get; set; }
                public SubItem disabledChildBurnFromAIDSMothers { get; set; }
                public SubItem disabledChildUpTo18YearAll { get; set; }

                public SubItem disabledChildFirstCategory { get; set; }
                public SubItem disabledChildSecondCategory { get; set; }
                public SubItem disabledChildThirdCategory { get; set; }
                public SubItem disabledChildWithCategoriesAll { get; set; }

                public SubItem disabledGeneralIlnessFirstCategory { get; set; }
                public SubItem disabledGeneralIlnessSecondCategory { get; set; }
                public SubItem disabledGeneralIlnessThirdCategory { get; set; }
                public SubItem disabledGeneralIlnessWithCategoriesAll { get; set; }

                public SubItem agedCitizens { get; set; }
                public SubItem agedHighlandResident { get; set; }
                public SubItem motherHeroine { get; set; }
                public SubItem childLoseBreadWinner { get; set; }
                public SubItem childOrphan { get; set; }
            }

            public class SubItem
            {
                public int Count { get; set; }
                public decimal SumOfPrices { get; set; }
            }
            public static ReportItem Execute(WorkflowContext context, int year, int month)
            {
                var item = new ReportItem();
                var fd = new DateTime(year, month, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(assignmentDefId, context.UserId);
                qb.Where("PaymentType")
                    .In(new object[]
                    {
                    uyBulogoKomokPaymentId,
                    retirementBenefitPaymentId,
                    childBenefitPaymentId,
                    survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId,
                    aidsBenefitPaymentId,
                    orphanBenefitPaymentId
                    })
                    //.And("&State")
                    //.In(new object[]
                    //{
                    //    approvedStateId,
                    //    onApprovingStateId,
                    //    onRegisteringStateId,
                    //    onPaymentStateTypeId
                    //})
                    .And("EffectiveDate").Lt(ld).And("ExpiryDate").Gt(fd);
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
                query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                query.AddAttribute("Category");
                query.AddAttribute("PaymentType");
                query.AddAttribute("EmploymentStatus");
                query.AddAttribute("MembershipType");
                query.AddGroupAttribute("Category");
                query.AddGroupAttribute("PaymentType");
                query.AddGroupAttribute("EmploymentStatus");
                query.AddGroupAttribute("MembershipType");

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {

                    while (reader.Read())
                    {
                        var count = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var sum = reader.IsDbNull(1) ? 0m : reader.GetDecimal(1);
                        var categoryId = reader.IsDbNull(2) ? Guid.Empty : reader.GetGuid(2);
                        var paymentTypeId = reader.IsDbNull(3) ? Guid.Empty : reader.GetGuid(3);
                        var employmentStatusId = reader.IsDbNull(4) ? Guid.Empty : reader.GetGuid(4);
                        var membershipTypeId = reader.IsDbNull(5) ? Guid.Empty : reader.GetGuid(5);

                        if (paymentTypeId.Equals(uyBulogoKomokPaymentId))
                        {
                            item.allReceiverUBK.Count += count;
                            item.allReceiverUBK.SumOfPrices += sum;
                            if (employmentStatusId.Equals(childUpTo3Id) && membershipTypeId.Equals(twinsId))
                            {
                                item.twinsUpTo3YearUBK.Count += count;
                                item.twinsUpTo3YearUBK.SumOfPrices += sum;
                            }
                            else if (employmentStatusId.Equals(childUpTo16Id) && membershipTypeId.Equals(tripletsId))
                            {
                                item.tripletsUpTo16YearUBK.Count += count;
                                item.tripletsUpTo16YearUBK.SumOfPrices += sum;
                            }
                            else if (childUpTo18YearList.Contains(employmentStatusId))
                            {
                                item.childUpTo18YearUBK.Count += count;
                                item.childUpTo18YearUBK.SumOfPrices += sum;
                            }
                        }
                        if (msbList.Contains(paymentTypeId))
                        {
                            if (categoryId.Equals(childISPCategoryId))
                            {
                                item.disabledChildCerebralPalsy.Count += count;
                                item.disabledChildCerebralPalsy.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childDisableCategoryId))
                            {
                                item.disabledChildUpTo18Year.Count += count;
                                item.disabledChildUpTo18Year.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childenAidsCategoryId))
                            {
                                item.disabledChildAIDS.Count += count;
                                item.disabledChildAIDS.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childFromAidsCategoryId))
                            {
                                item.disabledChildBurnFromAIDSMothers.Count += count;
                                item.disabledChildBurnFromAIDSMothers.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childhood1CategoryId))
                            {
                                item.disabledChildFirstCategory.Count += count;
                                item.disabledChildFirstCategory.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childhood2CategoryId))
                            {
                                item.disabledChildSecondCategory.Count += count;
                                item.disabledChildSecondCategory.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childhood3CategoryId))
                            {
                                item.disabledChildThirdCategory.Count += count;
                                item.disabledChildThirdCategory.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(commonDeseas1CategoryId))
                            {
                                item.disabledGeneralIlnessFirstCategory.Count += count;
                                item.disabledGeneralIlnessFirstCategory.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(commonDeseas2CategoryId))
                            {
                                item.disabledGeneralIlnessSecondCategory.Count += count;
                                item.disabledGeneralIlnessSecondCategory.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(commonDeseas3CategoryId))
                            {
                                item.disabledGeneralIlnessThirdCategory.Count += count;
                                item.disabledGeneralIlnessThirdCategory.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(retirementCategoryId))
                            {
                                item.agedCitizens.Count += count;
                                item.agedCitizens.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(alpineRetirementCategoryId))
                            {
                                item.agedHighlandResident.Count += count;
                                item.agedHighlandResident.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(heroMotherCategoryId))
                            {
                                item.motherHeroine.Count += count;
                                item.motherHeroine.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childSurvivorsCategoryId))
                            {
                                item.childLoseBreadWinner.Count += count;
                                item.childLoseBreadWinner.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(childSurvivorsCategoryId))
                            {
                                item.childLoseBreadWinner.Count += count;
                                item.childLoseBreadWinner.SumOfPrices += sum;
                            }
                            if (categoryId.Equals(orphanChildren))
                            {
                                item.childOrphan.Count += count;
                                item.childOrphan.SumOfPrices += sum;
                            }
                        }
                    }
                }
                if (item.allReceiverUBK.SumOfPrices > 0)
                    item.averageSumPriceUBK = Math.Round((item.allReceiverUBK.SumOfPrices / item.allReceiverUBK.Count), 2);
                else item.averageSumPriceUBK = item.allReceiverUBK.Count / 1;
                return item;
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1027
        {
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Инвалиды ВОВ",
                    "Участники ВОВ",
                    "Несовершеннолетние узники концлагерей",
                    "Блокадники Ленинграда",
                    "Всего:"
                };
                var items = new List<ReportItem>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportItem();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, year, month, orgId, items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, int month, Guid orgId, ReportItem item4, ReportItem item3, ReportItem item2, ReportItem item1, ReportItem item0)
            {
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var itemDefSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(itemDefSrc, "Category");
                    query.AddAttribute(itemDefSrc, "PaymentPrice");
                    query.AddAttribute(itemDefSrc, "AppCount");
                    query.AddAttribute(itemDefSrc, "NeedAmountPercent");
                    query.AddAttribute(itemDefSrc, "PostSection2AppCount");
                    query.AddAttribute(itemDefSrc, "PostSection2NeedAmount");
                    query.AddAttribute(itemDefSrc, "PostSection1NeedAmount");
                    query.AddAttribute(itemDefSrc, "PostPercent");
                    query.AddAttribute(itemDefSrc, "PostNeedAmountPercent");
                    query.AddAttribute(itemDefSrc, "BankSection2AppCount");
                    query.AddAttribute(itemDefSrc, "BankSection2NeedAmount");
                    query.AddAttribute(itemDefSrc, "BankSection1NeedAmount");
                    query.AddAttribute(itemDefSrc, "BankPercent");
                    query.AddAttribute(itemDefSrc, "BankNeedAmountPercent");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var category = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var paymentPrice = row[2] is DBNull ? 0m : (decimal)row[2];
                        var appCount = row[3] is DBNull ? 0 : (int)row[3];
                        var needAmountPercent = row[4] is DBNull ? 0m : (decimal)row[4];
                        var postSection2AppCount = row[5] is DBNull ? 0 : (int)row[5];
                        var postSection2NeedAmount = row[6] is DBNull ? 0m : (decimal)row[6];
                        var postSection1NeedAmount = row[7] is DBNull ? 0m : (decimal)row[7];
                        var postPercent = row[8] is DBNull ? 0m : (decimal)row[8];
                        var postNeedAmountPercent = row[9] is DBNull ? 0m : (decimal)row[9];
                        var bankSection2AppCount = row[10] is DBNull ? 0 : (int)row[10];
                        var bankSection2NeedAmount = row[11] is DBNull ? 0m : (decimal)row[11];
                        var bankSection1NeedAmount = row[12] is DBNull ? 0m : (decimal)row[12];
                        var bankPercent = row[13] is DBNull ? 0m : (decimal)row[13];
                        var bankNeedAmountPercent = row[14] is DBNull ? 0m : (decimal)row[14];

                        if (category == category1 || category == category2 || category == category3)
                        {
                            if (paymentPrice != 0) item0.gr3 = paymentPrice;
                            if (appCount != 0) item0.gr4 += appCount;
                            if (needAmountPercent != 0) item0.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item0.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item0.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item0.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item0.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item0.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item0.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item0.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item0.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item0.gr14 = bankPercent;
                            if (bankNeedAmountPercent != 0) item0.gr15 += bankNeedAmountPercent;
                        }
                        if (category == category4 || category == category5)
                        {
                            if (paymentPrice != 0) item1.gr3 = paymentPrice;
                            if (appCount != 0) item1.gr4 += appCount;
                            if (needAmountPercent != 0) item1.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item1.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item1.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item1.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item1.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item1.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item1.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item1.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item1.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item1.gr14 += bankPercent;
                            if (bankNeedAmountPercent != 0) item1.gr15 += bankNeedAmountPercent;
                        }
                        if (category == category6)
                        {
                            if (paymentPrice != 0) item2.gr3 = paymentPrice;
                            if (appCount != 0) item2.gr4 += appCount;
                            if (needAmountPercent != 0) item2.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item2.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item2.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item2.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item2.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item2.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item2.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item2.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item2.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item2.gr14 += bankPercent;
                            if (bankNeedAmountPercent != 0) item2.gr15 += bankNeedAmountPercent;
                        }
                        if (category == category7)
                        {
                            if (paymentPrice != 0) item3.gr3 = paymentPrice;
                            if (appCount != 0) item3.gr4 += appCount;
                            if (needAmountPercent != 0) item3.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item3.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item3.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item3.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item3.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item3.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item3.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item3.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item3.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item3.gr14 += bankPercent;
                            if (bankNeedAmountPercent != 0) item3.gr15 += bankNeedAmountPercent;
                        }

                        item4.gr4 = item0.gr4 + item1.gr4 + item2.gr4 + item3.gr4;
                        item4.gr5 = item0.gr5 + item1.gr5 + item2.gr5 + item3.gr5;
                        item4.gr6 = item0.gr6 + item1.gr6 + item2.gr6 + item3.gr6;
                        item4.gr7 = item0.gr7 + item1.gr7 + item2.gr7 + item3.gr7;
                        item4.gr8 = item0.gr8 + item1.gr8 + item2.gr8 + item3.gr8;
                        item4.gr9 = item0.gr9 + item1.gr9 + item2.gr9 + item3.gr9;
                        item4.gr10 = item0.gr10 + item1.gr10 + item2.gr10 + item3.gr10;

                        item4.gr11 = item0.gr11 + item1.gr11 + item2.gr11 + item3.gr11;
                        item4.gr12 = item0.gr12 + item1.gr12 + item2.gr12 + item3.gr12;
                        item4.gr13 = item0.gr13 + item1.gr13 + item2.gr13 + item3.gr13;
                        item4.gr14 = item0.gr14 + item1.gr14 + item2.gr14 + item3.gr14;
                        item4.gr15 = item0.gr15 + item1.gr15 + item2.gr15 + item3.gr15;
                    }
                }
            }
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}"); //Надбавка к ПС
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}"); //Строка надбавки ПС            
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные
            //Инваиды ВОВ
            private static readonly Guid category1 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");//Инвалид ВОВ 3 группы
            private static readonly Guid category2 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");//Инвалид ВОВ 2 группы
            private static readonly Guid category3 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");//Инвалид ВОВ 1 группы
            //Участники ВОВ
            private static readonly Guid category4 = new Guid("{63DFD63A-2868-411F-A52F-039E37B1D39F}");//Участник ВОВ, награжденный орденами славы 3-х степеней
            private static readonly Guid category5 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");//Участник ВОВ

            private static readonly Guid category6 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");//Несовершеннолетний узник концлагерей, гетто
            private static readonly Guid category7 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");//Участник блокады г.Ленинграда            

            public class ReportItem
            {
                public int rowNo { get; set; }
                public string rowName { get; set; }
                public decimal gr3 { get; set; }
                public int gr4 { get; set; }
                public decimal gr5 { get; set; }
                public int gr6 { get; set; }
                public decimal gr7 { get; set; }
                public decimal gr8 { get; set; }
                public decimal gr9 { get; set; }
                public decimal gr10 { get; set; }
                public int gr11 { get; set; }
                public decimal gr12 { get; set; }
                public decimal gr13 { get; set; }
                public decimal gr14 { get; set; }
                public decimal gr15 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1028
        {
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Инвалиды ВОВ",
                    "Участники ВОВ",
                    "Несовершеннолетние узники концлагерей",
                    "Блокадники Ленинграда",
                    "Всего:"
                };
                var items = new List<ReportItem>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportItem();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, year, month, orgId, items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, int month, Guid orgId, ReportItem item4, ReportItem item3, ReportItem item2, ReportItem item1, ReportItem item0)
            {
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var itemDefSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(itemDefSrc, "Category");
                    query.AddAttribute(itemDefSrc, "PaymentPrice");
                    query.AddAttribute(itemDefSrc, "AppCount");
                    query.AddAttribute(itemDefSrc, "NeedAmountPercent");
                    query.AddAttribute(itemDefSrc, "PostSection2AppCount");
                    query.AddAttribute(itemDefSrc, "PostSection2NeedAmount");
                    query.AddAttribute(itemDefSrc, "PostSection1NeedAmount");
                    query.AddAttribute(itemDefSrc, "PostPercent");
                    query.AddAttribute(itemDefSrc, "PostNeedAmountPercent");
                    query.AddAttribute(itemDefSrc, "BankSection2AppCount");
                    query.AddAttribute(itemDefSrc, "BankSection2NeedAmount");
                    query.AddAttribute(itemDefSrc, "BankSection1NeedAmount");
                    query.AddAttribute(itemDefSrc, "BankPercent");
                    query.AddAttribute(itemDefSrc, "BankNeedAmountPercent");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var category = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var paymentPrice = row[2] is DBNull ? 0m : (decimal)row[2];
                        var appCount = row[3] is DBNull ? 0 : (int)row[3];
                        var needAmountPercent = row[4] is DBNull ? 0m : (decimal)row[4];
                        var postSection2AppCount = row[5] is DBNull ? 0 : (int)row[5];
                        var postSection2NeedAmount = row[6] is DBNull ? 0m : (decimal)row[6];
                        var postSection1NeedAmount = row[7] is DBNull ? 0m : (decimal)row[7];
                        var postPercent = row[8] is DBNull ? 0m : (decimal)row[8];
                        var postNeedAmountPercent = row[9] is DBNull ? 0m : (decimal)row[9];
                        var bankSection2AppCount = row[10] is DBNull ? 0 : (int)row[10];
                        var bankSection2NeedAmount = row[11] is DBNull ? 0m : (decimal)row[11];
                        var bankSection1NeedAmount = row[12] is DBNull ? 0m : (decimal)row[12];
                        var bankPercent = row[13] is DBNull ? 0m : (decimal)row[13];
                        var bankNeedAmountPercent = row[14] is DBNull ? 0m : (decimal)row[14];

                        if (category == category1 || category == category2 || category == category3)
                        {
                            if (paymentPrice != 0) item0.gr3 = paymentPrice;
                            if (appCount != 0) item0.gr4 += appCount;
                            if (needAmountPercent != 0) item0.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item0.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item0.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item0.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item0.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item0.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item0.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item0.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item0.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item0.gr14 = bankPercent;
                            if (bankNeedAmountPercent != 0) item0.gr15 += bankNeedAmountPercent;
                        }
                        if (category == category4 || category == category5)
                        {
                            if (paymentPrice != 0) item1.gr3 = paymentPrice;
                            if (appCount != 0) item1.gr4 += appCount;
                            if (needAmountPercent != 0) item1.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item1.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item1.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item1.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item1.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item1.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item1.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item1.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item1.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item1.gr14 += bankPercent;
                            if (bankNeedAmountPercent != 0) item1.gr15 += bankNeedAmountPercent;
                        }
                        if (category == category6)
                        {
                            if (paymentPrice != 0) item2.gr3 = paymentPrice;
                            if (appCount != 0) item2.gr4 += appCount;
                            if (needAmountPercent != 0) item2.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item2.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item2.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item2.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item2.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item2.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item2.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item2.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item2.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item2.gr14 += bankPercent;
                            if (bankNeedAmountPercent != 0) item2.gr15 += bankNeedAmountPercent;
                        }
                        if (category == category7)
                        {
                            if (paymentPrice != 0) item3.gr3 = paymentPrice;
                            if (appCount != 0) item3.gr4 += appCount;
                            if (needAmountPercent != 0) item3.gr5 += needAmountPercent;
                            if (postSection2AppCount != 0) item3.gr6 += postSection2AppCount;
                            if (postSection2NeedAmount != 0) item3.gr7 += postSection2NeedAmount;
                            if (postSection1NeedAmount != 0) item3.gr8 += postSection1NeedAmount;
                            if (postPercent != 0) item3.gr9 += postPercent;
                            if (postNeedAmountPercent != 0) item3.gr10 += postNeedAmountPercent;

                            if (bankSection2AppCount != 0) item3.gr11 += bankSection2AppCount;
                            if (bankSection2NeedAmount != 0) item3.gr12 += bankSection2NeedAmount;
                            if (bankSection1NeedAmount != 0) item3.gr13 += bankSection1NeedAmount;
                            if (bankPercent != 0) item3.gr14 += bankPercent;
                            if (bankNeedAmountPercent != 0) item3.gr15 += bankNeedAmountPercent;
                        }

                        item4.gr4 = item0.gr4 + item1.gr4 + item2.gr4 + item3.gr4;
                        item4.gr5 = item0.gr5 + item1.gr5 + item2.gr5 + item3.gr5;
                        item4.gr6 = item0.gr6 + item1.gr6 + item2.gr6 + item3.gr6;
                        item4.gr7 = item0.gr7 + item1.gr7 + item2.gr7 + item3.gr7;
                        item4.gr8 = item0.gr8 + item1.gr8 + item2.gr8 + item3.gr8;
                        item4.gr9 = item0.gr9 + item1.gr9 + item2.gr9 + item3.gr9;
                        item4.gr10 = item0.gr10 + item1.gr10 + item2.gr10 + item3.gr10;

                        item4.gr11 = item0.gr11 + item1.gr11 + item2.gr11 + item3.gr11;
                        item4.gr12 = item0.gr12 + item1.gr12 + item2.gr12 + item3.gr12;
                        item4.gr13 = item0.gr13 + item1.gr13 + item2.gr13 + item3.gr13;
                        item4.gr14 = item0.gr14 + item1.gr14 + item2.gr14 + item3.gr14;
                        item4.gr15 = item0.gr15 + item1.gr15 + item2.gr15 + item3.gr15;
                    }
                }
            }
            private static readonly Guid reportDefId = new Guid("{86122C43-3E74-4A03-9F87-B29D1DA32961}"); //Заявка к ПС
            private static readonly Guid reportItemDefId = new Guid("{5251BDA5-6302-4086-ADE3-022C98F219DA}"); //Строка ПС            
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные
            //Инваиды ВОВ
            private static readonly Guid category1 = new Guid("{62960950-7E8F-420F-BCE6-D7F92CA4EA93}");//Инвалид ВОВ 3 группы
            private static readonly Guid category2 = new Guid("{626357F4-5133-4426-A712-2E785E556F6E}");//Инвалид ВОВ 2 группы
            private static readonly Guid category3 = new Guid("{32B76FDF-145B-492C-A850-BE903B7AB6CA}");//Инвалид ВОВ 1 группы
            //Участники ВОВ
            private static readonly Guid category4 = new Guid("{63DFD63A-2868-411F-A52F-039E37B1D39F}");//Участник ВОВ, награжденный орденами славы 3-х степеней
            private static readonly Guid category5 = new Guid("{677A9F5A-79F3-43F1-948E-AE10F6007677}");//Участник ВОВ

            private static readonly Guid category6 = new Guid("{C8B1465C-F377-4D9B-B23C-04FFC6836597}");//Несовершеннолетний узник концлагерей, гетто
            private static readonly Guid category7 = new Guid("{145C4F38-9BCF-44B3-95D0-EA1B8D1B869B}");//Участник блокады г.Ленинграда
            public class ReportItem
            {
                public int rowNo { get; set; }
                public string rowName { get; set; }
                public decimal gr3 { get; set; }
                public int gr4 { get; set; }
                public decimal gr5 { get; set; }
                public int gr6 { get; set; }
                public decimal gr7 { get; set; }
                public decimal gr8 { get; set; }
                public decimal gr9 { get; set; }
                public decimal gr10 { get; set; }
                public int gr11 { get; set; }
                public decimal gr12 { get; set; }
                public decimal gr13 { get; set; }
                public decimal gr14 { get; set; }
                public decimal gr15 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1029
        {
            private static readonly Guid reportDefId = new Guid("{4447EA34-67AB-46F2-BE03-A406CAC4EABC}"); //Заявка на финансирование ДК
            private static readonly Guid reportItemDefId = new Guid("{66605D33-A39E-4709-8534-C1505C041182}");  //Строки заявки ДК

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //На выплате

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "AppCount");
                query.AddAttribute(query.Source, "Month");
                query.AddAttribute(query.Source, "Year");
                query.AddAttribute(query.Source, "NeedAmount");
                query.AddOrderAttribute(query.Source, "&OrgName");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var appId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var appCount = row[2] is DBNull ? 0 : (int)row[2];
                    var currentMonth = row[3] is DBNull ? 0 : (int)row[3];
                    var fromYear = row[4] is DBNull ? 0 : (int)row[4];
                    var needAmount = row[5] is DBNull ? 0m : (decimal)row[5];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (month == currentMonth) rayon.gr1 += appCount;
                        if (fromYear == year) rayon.gr2 += (decimal)needAmount;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr1 { get; set; }
                [DataMember]
                public decimal gr2 { get; set; }

                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1029a
        {
            private static readonly Guid reportDefId = new Guid("{86122C43-3E74-4A03-9F87-B29D1DA32961}"); //Заявка на финансирование ПК
            private static readonly Guid reportItemDefId = new Guid("{5251BDA5-6302-4086-ADE3-022C98F219DA}");  //Строки заявки ПК

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //На выплате

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "AppCount");
                query.AddAttribute(query.Source, "Month");
                query.AddAttribute(query.Source, "Year");
                query.AddAttribute(query.Source, "NeedAmount");
                query.AddOrderAttribute(query.Source, "&OrgName");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var appId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var appCount = row[2] is DBNull ? 0 : (int)row[2];
                    var currentMonth = row[3] is DBNull ? 0 : (int)row[3];
                    var fromYear = row[4] is DBNull ? 0 : (int)row[4];
                    var needAmount = row[5] is DBNull ? 0m : (decimal)row[5];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (month == currentMonth) rayon.gr1 += appCount;
                        if (fromYear == year) rayon.gr2 += (decimal)needAmount;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr1 { get; set; }
                [DataMember]
                public decimal gr2 { get; set; }

                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }
        
        /*******************************************************************************************************************/
        public static class Report_1029b
        {
            private static readonly Guid reportDefId = new Guid("{AD72B200-60BA-412B-ADBF-F32D3BE2D40C}"); //Заявка на финансирование ПК
            private static readonly Guid reportItemDefId = new Guid("{F3FCDA28-FEBB-43A0-AD73-848BB175089E}");  //Строки заявки ПК

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //На выплате

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "AppCount");
                query.AddAttribute(query.Source, "Month");
                query.AddAttribute(query.Source, "Year");
                query.AddAttribute(query.Source, "NeedAmount");
                query.AddOrderAttribute(query.Source, "&OrgName");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var appId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var appCount = row[2] is DBNull ? 0 : (int)row[2];
                    var currentMonth = row[3] is DBNull ? 0 : (int)row[3];
                    var fromYear = row[4] is DBNull ? 0 : (int)row[4];
                    var needAmount = row[5] is DBNull ? 0m : (decimal)row[5];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (month == currentMonth) rayon.gr1 += appCount;
                        if (fromYear == year) rayon.gr2 += (decimal)needAmount;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr1 { get; set; }
                [DataMember]
                public decimal gr2 { get; set; }

                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1030
        {
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначение
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}"); //Банковский счет
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}"); //Почтовое поручения
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные

            private static readonly Guid payTypeEnumId1 = new Guid("{D450DE1B-ECD9-4286-A46A-59371E437C39}"); //Ежегодная выплата к 9 мая
            private static readonly Guid payTypeEnumId2 = new Guid("{62D22220-F570-4C24-9859-6B3E67B26C5A}"); //Ежегодная дополнительная единовременная выплата к 9 мая
            private static readonly Guid payTypeEnumId3 = new Guid("{8FCF2658-55D1-404E-BF87-3D096769FB64}"); //Единовременное денежное пособие (фонд Президента)          

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();

                SqlQuery query = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignSrc = query.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                {
                    canceledStateId, onApprovingStateId
                });
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[] { payTypeEnumId1, payTypeEnumId2, payTypeEnumId3 });

                query.AddAttribute(orderSrc, "&Id");
                query.AddAttribute(appSrc, "PaymentSum");
                query.AddAttribute(appSrc, "PaymentType");
                query.AddAttribute(appSrc, "&OrgId");
                query.AddOrderAttribute(query.Source, "&OrgName");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var paymentSum = row[1] is DBNull ? 0m : (decimal)row[1];
                    var paymentType = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var orgId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (paymentType == payTypeEnumId1) rayon.gr1++;
                        if (paymentSum != 0) rayon.gr2 += (decimal)paymentSum;
                        if (paymentType == payTypeEnumId2) rayon.gr6++;
                        if (paymentSum != 0) rayon.gr7 += (decimal)paymentSum;
                        if (paymentType == payTypeEnumId3) rayon.gr11++;
                        if (paymentSum != 0) rayon.gr12 += (decimal)paymentSum;
                        rayon.gr16 = rayon.gr1 + rayon.gr6 + rayon.gr11;
                        rayon.gr17 = rayon.gr2 + rayon.gr7 + rayon.gr12;
                    }
                }
                SqlQuery queryBank = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderBankSrc = queryBank.JoinSource(queryBank.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appBankSrc = queryBank.JoinSource(orderBankSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignBankSrc = queryBank.JoinSource(appBankSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                {
                    canceledStateId, onApprovingStateId
                });
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[] { payTypeEnumId1, payTypeEnumId2, payTypeEnumId3 });

                queryBank.AddAttribute(orderBankSrc, "&Id");
                queryBank.AddAttribute(appBankSrc, "PaymentSum");
                queryBank.AddAttribute(appBankSrc, "PaymentType");
                queryBank.AddAttribute(appBankSrc, "&OrgId");
                queryBank.AddOrderAttribute(appBankSrc, "&OrgName");

                table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, queryBank))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var paymentSum = row[1] is DBNull ? 0m : (decimal)row[1];
                    var paymentType = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var orgId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (paymentType == payTypeEnumId1) rayon.gr1++;
                        if (paymentSum != 0) rayon.gr2 += (decimal)paymentSum;
                        if (paymentType == payTypeEnumId2) rayon.gr6++;
                        if (paymentSum != 0) rayon.gr7 += (decimal)paymentSum;
                        if (paymentType == payTypeEnumId3) rayon.gr11++;
                        if (paymentSum != 0) rayon.gr12 += (decimal)paymentSum;
                        rayon.gr16 = rayon.gr1 + rayon.gr6 + rayon.gr11;
                        rayon.gr17 = rayon.gr2 + rayon.gr7 + rayon.gr12;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }
            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr1 { get; set; }
                [DataMember]
                public decimal gr2 { get; set; }
                [DataMember]
                public int gr6 { get; set; }
                [DataMember]
                public decimal gr7 { get; set; }
                [DataMember]
                public int gr11 { get; set; }
                [DataMember]
                public decimal gr12 { get; set; }
                [DataMember]
                public int gr16 { get; set; }
                [DataMember]
                public decimal gr17 { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class MonthlySocialBenefits_1032
        {
            private static readonly Guid reportDefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");  //Заявка на финансирование ЕСП
            private static readonly Guid reportItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}"); //Строка заявки ЕСП
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assigneDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначение
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");  // ЕСП престарелым гражданам
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");  // ЕСП на инвалида - члена семьи
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");  // ЕСП детям при утере кормильца 
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");  // ЕСП детям, инфецированным ВИЧ/СПИД
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");  // ЕСП детям от матерей с ВИЧ/СПИД до 18 месяцев
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");   // ЕСП круглым сиротам 
            private static readonly Guid koefDefId = new Guid("{0E5266D9-D589-406A-94E6-3D3C09B6A456}"); //Горный коэффициент

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //На выплате

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {
                new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {
                new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {
                new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
                new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(itemSrc, "Category");
                query.AddAttribute(itemSrc, "AppCount");
                query.AddAttribute(itemSrc, "PostSection2NeedAmount");
                query.AddAttribute(itemSrc, "BankSection2NeedAmount");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var orgId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var catId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var appCount = row[3] is DBNull ? 0 : (int)row[3];
                    var postS2NeedAmount = row[4] is DBNull ? 0m : (decimal)row[4];
                    var bankS2NeedAmount = row[5] is DBNull ? 0m : (decimal)row[5];
                    //var koef = row[5] is DBNull ? 0f : (double)row[5];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (appCount != 0)
                        {
                            if ((catId.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}"))) || (catId.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}"))) || (catId.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}"))) || (catId.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}"))))
                            {
                                //Дети ОВЗ до 18 лет
                                if (catId.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}")))
                                {
                                    rayon.gr2 += appCount;
                                }
                                //Дети, больные ДЦП
                                if (catId.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}")))
                                {
                                    rayon.gr3 += appCount;
                                }
                                //Дети, рожденные от матерей,живущих с ВИЧ-СПИДом
                                if (catId.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}")))
                                {
                                    rayon.gr4 += appCount;
                                }
                                //Дети ВИЧ-инфиц. или больные СПИДом
                                if (catId.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}")))
                                {
                                    rayon.gr5 += appCount;
                                }
                                rayon.gr6 = rayon.gr2 + rayon.gr3 + rayon.gr4 + rayon.gr5;
                            }

                            //Инвалиды с детства
                            if ((catId.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) || (catId.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}"))) || (catId.Equals(new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}"))))
                            {
                                if (catId.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) //ЛОВЗ с  детства 1 гр.
                                {
                                    rayon.gr7 += appCount;
                                }
                                if (catId.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}"))) //ЛОВЗ с  детства 2 гр.
                                {
                                    rayon.gr8 += appCount;
                                }
                                if (catId.Equals(new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}"))) //ЛОВЗ с  детства 3 гр.
                                {
                                    rayon.gr9 += appCount;
                                }
                                rayon.gr10 = rayon.gr7 + rayon.gr8 + rayon.gr9;
                            }
                            //Общ.заболевание
                            if ((catId.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}"))) || (catId.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}"))) || (catId.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))))
                            {
                                if (catId.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}"))) //ЛОВЗ от общего заболевания 1 гр.
                                {
                                    rayon.gr11 += appCount;
                                }
                                if (catId.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}")))  //ЛОВЗ от общего заболевания 2 гр.
                                {
                                    rayon.gr12 += appCount;
                                }
                                if (catId.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}")))  //ЛОВЗ от общего заболевания 3 гр.
                                {
                                    rayon.gr13 += appCount;
                                }
                                rayon.gr14 = rayon.gr11 + rayon.gr12 + rayon.gr13;
                            }
                            //Дети в случае потери кормилца
                            if ((catId.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) || (catId.Equals(new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}"))))
                            {
                                if (catId.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) //УК
                                {
                                    rayon.gr15 += appCount;
                                }
                                if (catId.Equals(new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}"))) //Круглая сирота
                                {
                                    rayon.gr16 += appCount;
                                }
                                //rayon.gr17 = rayon.gr15 + rayon.gr16;
                            }
                            //Престарелые, при отсутствии права на пенсионное обеспечение
                            if (catId.Equals(new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}")))
                            {
                                rayon.gr17 += appCount;
                            }
                            if (catId.Equals(new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}")))
                            {
                                rayon.gr18 += appCount;
                            }
                            //Награжден. медалью "батыр-эне" - мать-героиня
                            if (catId.Equals(new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}")))
                            {
                                rayon.gr19 += appCount;
                            }
                            rayon.gr20 = rayon.gr6 + rayon.gr10 + rayon.gr14 + rayon.gr15 + rayon.gr16 + rayon.gr17 + rayon.gr18 + rayon.gr19;
                        }
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr2 { get; set; }
                [DataMember]
                public int gr3 { get; set; }
                [DataMember]
                public int gr4 { get; set; }
                [DataMember]
                public int gr5 { get; set; }
                [DataMember]
                public int gr6 { get; set; }
                [DataMember]
                public int gr7 { get; set; }
                [DataMember]
                public int gr8 { get; set; }
                [DataMember]
                public int gr9 { get; set; }
                [DataMember]
                public int gr10 { get; set; }
                [DataMember]
                public int gr11 { get; set; }
                [DataMember]
                public int gr12 { get; set; }
                [DataMember]
                public int gr13 { get; set; }
                [DataMember]
                public int gr14 { get; set; }
                [DataMember]
                public int gr15 { get; set; }
                [DataMember]
                public int gr16 { get; set; }
                [DataMember]
                public int gr17 { get; set; }
                [DataMember]
                public int gr18 { get; set; }
                [DataMember]
                public int gr19 { get; set; }
                [DataMember]
                public int gr20 { get; set; }
                [DataMember]
                public int gr21 { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1032A //active code
        {
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assigneDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначение
            private static readonly Guid reportDefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}"); //Заявка на финансирование Уй-булоого комок
            private static readonly Guid reportItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}"); //Строка заявки Уй-булого комок
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid ubkEnumId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}"); // 

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //На выплате

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(itemSrc, "PaymentType");
                query.AddAttribute(query.Source, "DocCount");
                query.AddAttribute(itemSrc, "AppCount");
                query.AddAttribute(itemSrc, "PostSection2NeedAmount");
                query.AddAttribute(itemSrc, "BankSection2NeedAmount");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var orgId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var paymentType = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var docCount = row[3] is DBNull ? 0 : (int)row[3];
                    var appCount = row[4] is DBNull ? 0 : (int)row[4];
                    var postNeedAmount = row[5] is DBNull ? 0m : (decimal)row[5];
                    var bankNeedAmount = row[6] is DBNull ? 0m : (decimal)row[6];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr1 = docCount;
                        //опекун
                        if (paymentType.Equals(new Guid("{3F7B2602-49D9-4611-A64B-D1E1B4873D13}")))
                            rayon.gr3 += appCount;
                        //двойня
                        if (paymentType.Equals(new Guid("{7FD8CE36-0E0E-4C0B-B21D-6EB0521AB75B}")))
                            rayon.gr4 += appCount;
                        //тройня
                        if (paymentType.Equals(new Guid("{8BC11C2E-AD05-4A96-A434-9C4A57CB03F0}")))
                            rayon.gr5 += appCount;
                        //всего численность
                        if (paymentType.Equals(new Guid("{330FA388-7596-4D4B-903B-33D4D069707D}")))
                        {
                            rayon.gr6 += appCount;
                            rayon.gr7 += Math.Round(postNeedAmount) + Math.Round(bankNeedAmount);
                            if ((decimal)rayon.gr7 != 0)
                            {
                                rayon.gr8 = Math.Round(rayon.gr7) / rayon.gr6;
                            }
                        }
                        rayon.gr2 = rayon.gr6 - rayon.gr5 - rayon.gr4 - rayon.gr3;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr1 { get; set; }
                [DataMember]
                public int gr2 { get; set; }
                [DataMember]
                public int gr3 { get; set; }
                [DataMember]
                public int gr4 { get; set; }
                [DataMember]
                public int gr5 { get; set; }
                [DataMember]
                public int gr6 { get; set; }
                [DataMember]
                public decimal gr7 { get; set; }
                [DataMember]
                public decimal gr8 { get; set; }

                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }
        /*******************************************************************************************************************/
        public static class Report_1032DSO //active code
        {
            private static readonly Guid reportDefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");  //Заявка на финансирование ЕСП
            private static readonly Guid reportItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}"); //Строка заявки ЕСП
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assigneDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначение
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");  // ЕСП престарелым гражданам
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");  // ЕСП на инвалида - члена семьи
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");  // ЕСП детям при утере кормильца 
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");  // ЕСП детям, инфецированным ВИЧ/СПИД
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");  // ЕСП детям от матерей с ВИЧ/СПИД до 18 месяцев
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");   // ЕСП круглым сиротам 
            private static readonly Guid koefDefId = new Guid("{0E5266D9-D589-406A-94E6-3D3C09B6A456}"); //Горный коэффициент

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //На выплате

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {
            new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {
                new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {
                new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
                new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(itemSrc, "Category");
                query.AddAttribute(itemSrc, "AppCount");
                query.AddAttribute(itemSrc, "PostSection2NeedAmount");
                query.AddAttribute(itemSrc, "BankSection2NeedAmount");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var orgId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var catId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var appCount = row[3] is DBNull ? 0 : (int)row[3];
                    var postS2NeedAmount = row[4] is DBNull ? 0m : (decimal)row[4];
                    var bankS2NeedAmount = row[5] is DBNull ? 0m : (decimal)row[5];
                    //var koef = row[5] is DBNull ? 0f : (double)row[5];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (appCount != 0)
                        {
                            rayon.gr56 += appCount;
                            rayon.gr57 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                            rayon.gr58 = rayon.gr57 / rayon.gr56;

                            //Инвалиды с детства
                            if ((catId.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) || (catId.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}"))) || (catId.Equals(new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}"))))
                            {
                                if (catId.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}")))
                                {
                                    rayon.gr1 += appCount;
                                    rayon.gr3 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                    rayon.gr2 = rayon.gr3 / rayon.gr1;
                                }
                                if (catId.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}")))
                                {
                                    rayon.gr4 += appCount;
                                    rayon.gr6 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                    rayon.gr5 = rayon.gr6 / rayon.gr4;
                                }
                                if (catId.Equals(new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}")))
                                {
                                    rayon.gr7 += appCount;
                                    rayon.gr9 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                    rayon.gr8 = rayon.gr9 / rayon.gr7;
                                }
                                rayon.gr10 += appCount;
                                rayon.gr11 += rayon.gr3 + rayon.gr6 + rayon.gr9;
                            }
                            //Дети ЛОВЗ до 18 лет
                            if (catId.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}")))
                            {
                                rayon.gr12 += appCount;
                                rayon.gr14 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr13 = rayon.gr14 / rayon.gr12;

                            }
                            if (catId.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}")))
                            {
                                rayon.gr15 += appCount;
                                rayon.gr17 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr16 = rayon.gr17 / rayon.gr15;
                            }
                            if (catId.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}")))
                            {
                                rayon.gr18 += appCount;
                                rayon.gr20 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr19 = rayon.gr20 / rayon.gr18;
                            }
                            //Дети ВИЧ-инфиц. или больные СПИДом
                            if (catId.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}")))
                            {
                                rayon.gr21 += appCount;
                                rayon.gr23 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr22 = rayon.gr23 / rayon.gr21;
                            }
                            rayon.gr24 = rayon.gr12 + rayon.gr15 + rayon.gr18 + rayon.gr21;
                            rayon.gr25 = rayon.gr14 + rayon.gr17 + rayon.gr20 + rayon.gr23;
                            //Общ.заболевание
                            /*if ((catId.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) || (catId.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}"))) || (catId.Equals(new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}"))))
                            {*/
                            if (catId.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}")))
                            {
                                rayon.gr26 += appCount;
                                rayon.gr28 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr27 = rayon.gr28 / rayon.gr26;
                            }
                            if (catId.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}")))
                            {
                                rayon.gr29 += appCount;
                                rayon.gr31 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr30 = rayon.gr31 / rayon.gr29;
                            }
                            if (catId.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}")))
                            {
                                rayon.gr32 += appCount;
                                rayon.gr34 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr33 = rayon.gr34 / rayon.gr32;
                            }
                            rayon.gr35 = rayon.gr26 + rayon.gr29 + rayon.gr32;
                            rayon.gr36 = rayon.gr28 + rayon.gr31 + rayon.gr34;
                            //}
                            //Дети в случае потери кормилца
                            if ((catId.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) || (catId.Equals(new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}"))))
                            {
                                if (catId.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}")))
                                {
                                    rayon.gr37 += appCount;
                                    rayon.gr39 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                    rayon.gr38 = rayon.gr39 / rayon.gr37;
                                }
                                if (catId.Equals(new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}")))
                                {
                                    rayon.gr40 += appCount;
                                    rayon.gr42 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                    rayon.gr41 = rayon.gr42 / rayon.gr40;
                                }
                                rayon.gr43 += appCount;
                                rayon.gr44 += rayon.gr39 + rayon.gr42;
                            }
                            //Престарелые, при отсутствии права на пенсионное обеспечение
                            if (catId.Equals(new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}")))
                            {
                                rayon.gr45 += appCount;
                                rayon.gr47 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr46 = rayon.gr47 / rayon.gr45;
                            }
                            if (catId.Equals(new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}")))
                            {
                                rayon.gr48 += appCount;
                                rayon.gr50 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr49 = rayon.gr50 / rayon.gr48;
                            }
                            rayon.gr51 = rayon.gr45 + rayon.gr48;
                            rayon.gr52 = rayon.gr47 + rayon.gr50;

                            //Награжден. медалью "батыр-эне" - мать-героиня
                            if (catId.Equals(new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}")))
                            {
                                rayon.gr53 += appCount;
                                rayon.gr55 += (decimal)postS2NeedAmount + (decimal)bankS2NeedAmount;
                                rayon.gr54 = rayon.gr55 / rayon.gr53;
                            }
                        }
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr1 { get; set; }
                [DataMember]
                public decimal gr2 { get; set; }
                [DataMember]
                public decimal gr3 { get; set; }
                [DataMember]
                public int gr4 { get; set; }
                [DataMember]
                public decimal gr5 { get; set; }
                [DataMember]
                public decimal gr6 { get; set; }
                [DataMember]
                public int gr7 { get; set; }
                [DataMember]
                public decimal gr8 { get; set; }
                [DataMember]
                public decimal gr9 { get; set; }
                [DataMember]
                public int gr10 { get; set; }
                [DataMember]
                public decimal gr11 { get; set; }
                [DataMember]
                public int gr12 { get; set; }
                [DataMember]
                public decimal gr13 { get; set; }
                [DataMember]
                public decimal gr14 { get; set; }
                [DataMember]
                public int gr15 { get; set; }
                [DataMember]
                public decimal gr16 { get; set; }
                [DataMember]
                public decimal gr17 { get; set; }
                [DataMember]
                public int gr18 { get; set; }
                [DataMember]
                public decimal gr19 { get; set; }
                [DataMember]
                public decimal gr20 { get; set; }
                [DataMember]
                public int gr21 { get; set; }
                [DataMember]
                public decimal gr22 { get; set; }
                [DataMember]
                public decimal gr23 { get; set; }
                [DataMember]
                public int gr24 { get; set; }
                [DataMember]
                public decimal gr25 { get; set; }
                [DataMember]
                public int gr26 { get; set; }
                [DataMember]
                public decimal gr27 { get; set; }
                [DataMember]
                public decimal gr28 { get; set; }
                [DataMember]
                public int gr29 { get; set; }
                [DataMember]
                public decimal gr30 { get; set; }
                [DataMember]
                public decimal gr31 { get; set; }
                [DataMember]
                public int gr32 { get; set; }
                [DataMember]
                public decimal gr33 { get; set; }
                [DataMember]
                public decimal gr34 { get; set; }
                [DataMember]
                public int gr35 { get; set; }
                [DataMember]
                public decimal gr36 { get; set; }
                [DataMember]
                public int gr37 { get; set; }
                [DataMember]
                public decimal gr38 { get; set; }
                [DataMember]
                public decimal gr39 { get; set; }
                [DataMember]
                public int gr40 { get; set; }
                [DataMember]
                public decimal gr41 { get; set; }
                [DataMember]
                public decimal gr42 { get; set; }
                [DataMember]
                public int gr43 { get; set; }
                [DataMember]
                public decimal gr44 { get; set; }
                [DataMember]
                public int gr45 { get; set; }
                [DataMember]
                public decimal gr46 { get; set; }
                [DataMember]
                public decimal gr47 { get; set; }
                [DataMember]
                public int gr48 { get; set; }
                [DataMember]
                public decimal gr49 { get; set; }
                [DataMember]
                public decimal gr50 { get; set; }
                [DataMember]
                public int gr51 { get; set; }
                [DataMember]
                public decimal gr52 { get; set; }
                [DataMember]
                public int gr53 { get; set; }
                [DataMember]
                public decimal gr54 { get; set; }
                [DataMember]
                public decimal gr55 { get; set; }
                [DataMember]
                public int gr56 { get; set; }
                [DataMember]
                public decimal gr57 { get; set; }
                [DataMember]
                public decimal gr58 { get; set; }

                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1036 //active code
        {
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначение
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid ubkEnumId = new Guid("{3193A90D-380B-4428-B7B1-04C548AA902E}"); // 
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}"); //Банковский счет
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}"); //Почтовое поручения
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid appStateId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //На выплате
            private static readonly Guid intersoftId = new Guid("{063FC105-DC9B-48CE-9A4E-91384C93AE8F}");


            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var orderItems = new List<Guid>();
                SqlQuery query = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var prersonSrc = query.JoinSource(appSrc, personDefId, SqlSourceJoinType.Inner, "Applicant");
                var assignSrc = query.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                var assPersonSrc = query.JoinSource(assignSrc, personDefId, SqlSourceJoinType.Inner, "Person");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, ubkEnumId);
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.Equal, approvedStateId);
                query.AddCondition(ExpressionOperation.And, appDefId, "&State", ConditionOperation.Equal, appStateId);
                query.AddCondition(ExpressionOperation.And, appDefId, "&OrgId", ConditionOperation.In, appStateId);
                query.AddCondition(ExpressionOperation.And, appDefId, "&OrgId", ConditionOperation.In, new object[] { intersoftId, null });

                query.AddAttribute(orderSrc, "&Id");
                query.AddAttribute(prersonSrc, "Sex");
                query.AddAttribute(assignSrc, "EmploymentStatus");
                query.AddAttribute(assignSrc, "MembershipType");
                query.AddAttribute(assPersonSrc, "Sex");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(appSrc, "&Id");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orderId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var appGender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var empStatus = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var memberType = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var memberGender = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                    var orgId = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                    var appId = row[6] is DBNull ? Guid.Empty : (Guid)row[6];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (orderId != Guid.Empty)
                    {
                        //if (appId == Guid.Empty) continue;
                        if (!orderItems.Contains(appId))
                        {
                            if (appGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr2++;
                            if (appGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr3++;
                            orderItems.Add(appId);
                        }
                        //Ребенок до 3-х лет + Ребенок от 3-х до 16 лет
                        if ((empStatus.Equals(new Guid("{D8FF3DAF-A701-414A-B965-4BF93BB658B9}"))) || (empStatus.Equals(new Guid("{8024982A-4AFB-4074-9D63-3EEFE22420E0}"))))
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr6++;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr7++;
                        }
                        if (memberType.Equals(new Guid("{9BF3B519-C0B8-4344-BF29-47B062C07454}"))) //Опекаемый
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr8 += 1;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr9 += 1;
                        }

                        if (memberType.Equals(new Guid("{45D55628-5E72-42B8-8B8D-667346E79046}"))) //Двойня
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr10 += 1;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr11 += 1;
                        }

                        if (memberType.Equals(new Guid("{8CCAE21E-128A-4728-9479-9C094271C614}"))) //Тройня и более
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr12 += 1;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr13 += 1;
                        }
                        rayon.gr4 = rayon.gr6 + rayon.gr8 + rayon.gr10 + rayon.gr12;
                        rayon.gr5 = rayon.gr7 + rayon.gr9 + rayon.gr11 + rayon.gr13;
                    }
                }
                SqlQuery queryBank = new SqlQuery(orderPaymentDefId, context.DataContext);
                orderSrc = queryBank.JoinSource(queryBank.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                appSrc = queryBank.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                prersonSrc = queryBank.JoinSource(appSrc, personDefId, SqlSourceJoinType.Inner, "Applicant");
                assignSrc = queryBank.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                assPersonSrc = queryBank.JoinSource(assignSrc, personDefId, SqlSourceJoinType.Inner, "Person");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, ubkEnumId);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.Equal, approvedStateId);
                query.AddCondition(ExpressionOperation.And, appDefId, "&State", ConditionOperation.Equal, appStateId);
                query.AddCondition(ExpressionOperation.And, appDefId, "&OrgId", ConditionOperation.NotIn, new object[] { intersoftId, null });

                queryBank.AddAttribute(orderSrc, "&Id");
                queryBank.AddAttribute(prersonSrc, "Sex");
                queryBank.AddAttribute(assignSrc, "EmploymentStatus");
                queryBank.AddAttribute(assignSrc, "MembershipType");
                queryBank.AddAttribute(assPersonSrc, "Sex");
                queryBank.AddAttribute(queryBank.Source, "&OrgId");
                queryBank.AddAttribute(appSrc, "&Id");

                var tableBank = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, queryBank))
                {
                    reader.Open();
                    reader.Fill(tableBank);
                    reader.Close();
                }
                foreach (DataRow row in tableBank.Rows)
                {
                    var orderId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var appGender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var empStatus = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var memberType = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var memberGender = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                    var orgId = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                    var appId = row[6] is DBNull ? Guid.Empty : (Guid)row[6];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (orderId != Guid.Empty)
                    {
                        //if (appId == Guid.Empty) continue;

                        if (!orderItems.Contains(appId))
                        {
                            if (appGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr2++;
                            //Женский
                            if (appGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr3++;
                            orderItems.Add(appId);
                        }
                        //Ребенок до 3-х лет + Ребенок от 3-х до 16 лет
                        if ((empStatus.Equals(new Guid("{D8FF3DAF-A701-414A-B965-4BF93BB658B9}"))) || (empStatus.Equals(new Guid("{8024982A-4AFB-4074-9D63-3EEFE22420E0}"))))
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr6++;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr7++;
                        }

                        if (memberType.Equals(new Guid("{9BF3B519-C0B8-4344-BF29-47B062C07454}"))) //Опекаемый
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr8 += 1;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr9 += 1;
                        }

                        if (memberType.Equals(new Guid("{45D55628-5E72-42B8-8B8D-667346E79046}"))) //Двойня
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr10 += 1;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr11 += 1;
                        }

                        if (memberType.Equals(new Guid("{8CCAE21E-128A-4728-9479-9C094271C614}"))) //Тройня и более
                        {
                            if (memberGender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                rayon.gr12 += 1;
                            else if (memberGender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                rayon.gr13 += 1;
                        }
                        rayon.gr4 = rayon.gr6 + rayon.gr8 + rayon.gr10 + rayon.gr12;
                        rayon.gr5 = rayon.gr7 + rayon.gr9 + rayon.gr11 + rayon.gr13;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }
            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr2 { get; set; }
                [DataMember]
                public int gr3 { get; set; }
                [DataMember]
                public int gr4 { get; set; }
                [DataMember]
                public int gr5 { get; set; }
                [DataMember]
                public int gr6 { get; set; }
                [DataMember]
                public int gr7 { get; set; }
                [DataMember]
                public int gr8 { get; set; }
                [DataMember]
                public int gr9 { get; set; }
                [DataMember]
                public int gr10 { get; set; }
                [DataMember]
                public int gr11 { get; set; }
                [DataMember]
                public int gr12 { get; set; }
                [DataMember]
                public int gr13 { get; set; }
                [DataMember]
                public int gr14 { get; set; }
                [DataMember]
                public decimal gr15 { get; set; }
                [DataMember]
                public string gr16 { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_1037 //active code
        {
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначение
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person

            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}"); //Банковский счет
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}"); //Почтовое поручения            

            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");  // ЕСП престарелым гражданам
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");  // ЕСП на инвалида - члена семьи
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");  // ЕСП по инвалидности
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");  // ЕСП детям при утере кормильца 
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");  // ЕСП детям, инфецированным ВИЧ/СПИД
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");  // ЕСП детям от матерей с ВИЧ/СПИД до 18 месяцев
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");   // ЕСП круглым сиротам
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");

            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении

            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); //Утвержденные

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                SqlQuery query = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignSrc = query.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                var assPersonSrc = query.JoinSource(assignSrc, personDefId, SqlSourceJoinType.Inner, "Person");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In,
                new object[] {
                                retirementBenefitPaymentId,
                                childBenefitPaymentId,
                                invalidBenefitPaymentId,
                                survivorBenefitPaymentId,
                                aidsFromBenefitPaymentId,
                                aidsBenefitPaymentId,
                                orphanBenefitPaymentId
                             });
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.Equal, approvedStateId);

                query.AddAttribute(appSrc, "&Id");
                query.AddAttribute(orderSrc, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(assignSrc, "Category");
                query.AddAttribute(assPersonSrc, "Sex");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var orderId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var orgId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var category = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var gender = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (orderId != Guid.Empty)
                    {
                        //if (appId != Guid.Empty) continue;
                        if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                            rayon.gr2 += 1;
                        if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                            rayon.gr3 += 1;
                        if ((category.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) || (category.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}"))) || (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr4 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr5 += 1;

                            if (category.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) //ЛОВЗ с  детства 1 гр.
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr6 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr7 += 1;
                            }
                            if (category.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}")))  //ЛОВЗ с  детства 2 гр.
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr8 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr9 += 1;
                            }
                            if (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}")))  //ЛОВЗ с  детства 3 гр.
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr10 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr11 += 1;
                            }
                        }
                        if ((category.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}"))) || (category.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}"))) ||
                            (category.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}"))) || (category.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr12 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr13 += 1;

                            if (category.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}"))) //ЛОВЗ(до 18 лет)
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr14 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr15 += 1;
                            }
                            if (category.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}"))) //Дети, больные ДЦП
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr16 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr17 += 1;
                            }
                            if (category.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}"))) //Дети, рожденные от матерей,живущих с ВИЧ-СПИДом
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr18 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr19 += 1;
                            }
                            if (category.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}"))) //Дети ВИЧ-инфиц. или больные СПИДом
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr20 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr21 += 1;
                            }
                        }
                        //Общее заболевания
                        if ((category.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}"))) || (category.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}"))) || (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr22 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr23 += 1;
                            if (category.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}"))) //2 гр.общего заболевания
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr24 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr25 += 1;
                            }
                            if (category.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}")))
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                    rayon.gr26 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                    rayon.gr27 += 1;
                            }
                            if (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))) //3 гр. общего заболевания
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr28 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr29 += 1;
                            }
                        }
                        //УК - КС
                        if ((category.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) || (category.Equals(new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr30 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr31 += 1;

                            if (category.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) //ук
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr32 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr33 += 1;
                            }
                            if (category.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //КС
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr34 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr35 += 1;
                            }
                        }
                        //gr36 gr37
                        if (category.Equals(new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}"))) //
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr36 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr37 += 1;
                        }
                        if (category.Equals(new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}")))  //Престарелые жители высокогорья
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr38 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr39 += 1;
                        }
                        if (category.Equals(new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}")))
                        {
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr40 += 1;
                        }
                    }
                }
                SqlQuery queryBank = new SqlQuery(orderPaymentDefId, context.DataContext);
                orderSrc = queryBank.JoinSource(queryBank.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                appSrc = queryBank.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                assignSrc = queryBank.JoinSource(appSrc, assignmentDefId, SqlSourceJoinType.Inner, "Assignments");
                assPersonSrc = queryBank.JoinSource(assignSrc, personDefId, SqlSourceJoinType.Inner, "Person");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In,
                new object[] {
                                retirementBenefitPaymentId,
                                childBenefitPaymentId,
                                invalidBenefitPaymentId,
                                survivorBenefitPaymentId,
                                aidsFromBenefitPaymentId,
                                aidsBenefitPaymentId,
                                orphanBenefitPaymentId
                             });
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.Equal, approvedStateId);

                queryBank.AddAttribute(appSrc, "&Id");
                queryBank.AddAttribute(orderSrc, "&Id");
                queryBank.AddAttribute(queryBank.Source, "&OrgId");
                queryBank.AddAttribute(assignSrc, "Category");
                queryBank.AddAttribute(assPersonSrc, "Sex");

                var tableBank = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, queryBank))
                {
                    reader.Open();
                    reader.Fill(tableBank);
                    reader.Close();
                }
                foreach (DataRow row in tableBank.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var orderId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var orgId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var category = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var gender = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (orderId != Guid.Empty)
                    {
                        //if (appId != Guid.Empty) continue;
                        if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                            rayon.gr2 += 1;
                        if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                            rayon.gr3 += 1;
                        if ((category.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) || (category.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}"))) || (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr4 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr5 += 1;

                            if (category.Equals(new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}"))) //ЛОВЗ с  детства 1 гр.
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr6 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr7 += 1;
                            }
                            if (category.Equals(new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}")))  //ЛОВЗ с  детства 2 гр.
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr8 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr9 += 1;
                            }
                            if (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}")))  //ЛОВЗ с  детства 3 гр.
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr10 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr11 += 1;
                            }
                        }
                        if ((category.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}"))) || (category.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}"))) ||
                            (category.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}"))) || (category.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr12 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr13 += 1;

                            if (category.Equals(new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}"))) //ЛОВЗ(до 18 лет)
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr14 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr15 += 1;
                            }
                            if (category.Equals(new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}"))) //Дети, больные ДЦП
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr16 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr17 += 1;
                            }
                            if (category.Equals(new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}"))) //Дети, рожденные от матерей,живущих с ВИЧ-СПИДом
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr18 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr19 += 1;
                            }
                            if (category.Equals(new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}"))) //Дети ВИЧ-инфиц. или больные СПИДом
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr20 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr21 += 1;
                            }
                        }
                        //Общее заболевания
                        if ((category.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}"))) || (category.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}"))) || (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr22 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr23 += 1;
                            if (category.Equals(new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}"))) //2 гр.общего заболевания
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr24 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr25 += 1;
                            }
                            if (category.Equals(new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}")))
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}")))
                                    rayon.gr26 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}")))
                                    rayon.gr27 += 1;
                            }
                            if (category.Equals(new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}"))) //3 гр. общего заболевания
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr28 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr29 += 1;
                            }
                        }
                        //УК - КС
                        if ((category.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) || (category.Equals(new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}"))))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr30 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr31 += 1;

                            if (category.Equals(new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}"))) //ук
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr32 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr33 += 1;
                            }
                            if (category.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //КС
                            {
                                if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                    rayon.gr34 += 1;
                                if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                    rayon.gr35 += 1;
                            }
                        }
                        //gr36 gr37
                        if (category.Equals(new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}"))) //
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr36 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr37 += 1;
                        }
                        if (category.Equals(new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}")))
                        {
                            if (gender.Equals(new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}"))) //муж.
                                rayon.gr38 += 1;
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr39 += 1;
                        }
                        //Награжден. медалью "батыр-эне" - мать-героиня
                        if (category.Equals(new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}")))
                        {
                            if (gender.Equals(new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}"))) //жен.
                                rayon.gr40 += 1;
                        }
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }
            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr2 { get; set; }
                [DataMember]
                public int gr3 { get; set; }
                [DataMember]
                public int gr4 { get; set; }
                [DataMember]
                public int gr5 { get; set; }
                [DataMember]
                public int gr6 { get; set; }
                [DataMember]
                public int gr7 { get; set; }
                [DataMember]
                public int gr8 { get; set; }
                [DataMember]
                public int gr9 { get; set; }
                [DataMember]
                public int gr10 { get; set; }
                [DataMember]
                public int gr11 { get; set; }
                [DataMember]
                public int gr12 { get; set; }
                [DataMember]
                public int gr13 { get; set; }
                [DataMember]
                public int gr14 { get; set; }
                [DataMember]
                public int gr15 { get; set; }
                [DataMember]
                public int gr16 { get; set; }
                [DataMember]
                public int gr17 { get; set; }
                [DataMember]
                public int gr18 { get; set; }
                [DataMember]
                public int gr19 { get; set; }
                [DataMember]
                public int gr20 { get; set; }
                [DataMember]
                public int gr21 { get; set; }
                [DataMember]
                public int gr22 { get; set; }
                [DataMember]
                public int gr23 { get; set; }
                [DataMember]
                public int gr24 { get; set; }
                [DataMember]
                public int gr25 { get; set; }
                [DataMember]
                public int gr26 { get; set; }
                [DataMember]
                public int gr27 { get; set; }
                [DataMember]
                public int gr28 { get; set; }
                [DataMember]
                public int gr29 { get; set; }
                [DataMember]
                public int gr30 { get; set; }
                [DataMember]
                public int gr31 { get; set; }
                [DataMember]
                public int gr32 { get; set; }
                [DataMember]
                public int gr33 { get; set; }
                [DataMember]
                public int gr34 { get; set; }
                [DataMember]
                public int gr35 { get; set; }
                [DataMember]
                public int gr36 { get; set; }
                [DataMember]
                public int gr37 { get; set; }
                [DataMember]
                public int gr38 { get; set; }
                [DataMember]
                public int gr39 { get; set; }
                [DataMember]
                public int gr40 { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }
        /*******************************************************************************************************************/
        public static class Report_2001
        {
            static Guid reportNo1DefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");//Уй-булого комок (от 0 до 16 лет)
            static Guid reportNo1ItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");//Rows Уй-булого комок (от 0 до 16 лет)

            static Guid reportNo2DefId = new Guid("{0C6A34A9-CF41-4750-B21D-9913672A0C76}");//ЕПМС
            static Guid reportNo2ItemDefId = new Guid("{760233C7-3FC3-4417-95AE-F399B8B0208F}");//Rows ЕПМС

            static Guid reportNo3DefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");//Социальное пособие  (АСЖ)
            static Guid reportNo3ItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}");//Rows Социальное пособие  (АСЖ)

            static Guid reportNo4DefId = new Guid("{9580E9AE-5949-4B83-90F0-EED511B63477}");//ДЕСП
            static Guid reportNo4ItemDefId = new Guid("{D2FCA75E-34E4-4E85-93B5-6917C4F18BC2}");//Rows ДЕСП

            private static readonly Guid BenefitPaymentId0 = new Guid("{330FA388-7596-4D4B-903B-33D4D069707D}");   // Уй-булого комок от 0 до 16 лет

            private static readonly Guid BenefitPaymentId1 = new Guid("{7F1B9709-8F99-473F-9AE0-2DDCD74BDE6E}");   // * Пособие матерям родившим двойню до достижения 3-лет
            private static readonly Guid BenefitPaymentId2 = new Guid("{9BC8A898-31F8-4F55-8C14-28F641142370}");   // * ЕПМС на ребенка до 3-х лет
            private static readonly Guid BenefitPaymentId3 = new Guid("{64ACC17D-78B8-492E-AC81-7B1E4750F53A}");   // * ЕПМС матерям родившим тройню и более до достижения 16-лет
            private static readonly Guid BenefitPaymentId4 = new Guid("{D24151CF-C8B0-4851-B0EC-6D6EB382DC61}"); //* ЕПМС семьям по малообеспеченности
            private static readonly Guid BenefitPaymentId5 = new Guid("{BCE5B287-7495-4AD1-96A8-F52040A4CABF}"); //*ЕПМС малоимущим (опекаемым, сиротам) 
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден

            private static readonly List<Guid> benefitList = new List<Guid>
            {
                 new Guid("{64ACC17D-78B8-492E-AC81-7B1E4750F53A}"),
                 new Guid("{D24151CF-C8B0-4851-B0EC-6D6EB382DC61}"),
                 new Guid("{BCE5B287-7495-4AD1-96A8-F52040A4CABF}")
            };
            public static List<GeneralReportItem> Execute(WorkflowContext context, int year, int month)
            {
                List<GeneralReportItem> reportItems = new List<GeneralReportItem>();
                for (int i = 1; i < 5; i++)
                {
                    QueryBuilder qb = new QueryBuilder(reportNo1DefId, context.UserId);
                    SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                    SqlQuerySource itemSrc = query.Source;
                    switch (i)
                    {
                        case 1:
                            {
                                qb = new QueryBuilder(reportNo1DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo1ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                query.AddCondition(ExpressionOperation.And, reportNo1ItemDefId, "PaymentType", ConditionOperation.Equal, BenefitPaymentId0);
                                break;
                            }
                        case 2:
                            {
                                qb = new QueryBuilder(reportNo2DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo2ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.In, new object[] { BenefitPaymentId3, BenefitPaymentId4, BenefitPaymentId5 });
                                break;
                            }
                        case 3:
                            {
                                qb = new QueryBuilder(reportNo2DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo2ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.In, new object[] { BenefitPaymentId2, BenefitPaymentId1 });
                                //query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.Equal, BenefitPaymentId1);
                                break;
                            }
                        case 4:
                            {
                                qb = new QueryBuilder(reportNo3DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo3ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                break;
                            }

                    }
                    query.AddAttribute("&OrgId");
                    query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostNeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostPercent", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);

                    query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankNeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection1NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankPercent", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                    query.AddGroupAttribute("&OrgId");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var postSection2AppCount = row[1] is DBNull ? 0 : (int)row[1];
                        var postNeedAmount = row[2] is DBNull ? 0m : (decimal)row[2];
                        var postSection1NeedAmount = row[3] is DBNull ? 0m : (decimal)row[3];
                        var postSection2NeedAmount = row[4] is DBNull ? 0m : (decimal)row[4];
                        var postPercent = row[5] is DBNull ? 0m : (decimal)row[5];
                        var postSection2DocCount = row[6] is DBNull ? 0 : (int)row[6];

                        var bankSection2AppCount = row[7] is DBNull ? 0 : (int)row[7];
                        var bankNeedAmount = row[8] is DBNull ? 0m : (decimal)row[8];
                        var bankSection1NeedAmount = row[9] is DBNull ? 0m : (decimal)row[9];
                        var bankSection2NeedAmount = row[10] is DBNull ? 0m : (decimal)row[10];
                        var bankPercent = row[11] is DBNull ? 0m : (decimal)row[11];
                        var bankSection2DocCount = row[12] is DBNull ? 0 : (int)row[12];

                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(reportItems, orgName, orgId);
                        switch (i)
                        {
                            case 1:
                            {
                                item.postReportItem.ubkPayment.Section2AppCount = postSection2AppCount;
                                item.postReportItem.ubkPayment.NeedAmount = postNeedAmount;
                                item.postReportItem.ubkPayment.Section1NeedAmount = postSection1NeedAmount;
                                item.postReportItem.ubkPayment.Section2NeedAmount = postSection2NeedAmount;
                                item.postReportItem.ubkPayment.Percent = postPercent;
                                item.postReportItem.ubkPayment.Section2DocCount = postSection2DocCount;

                                item.bankReportItem.ubkPayment.Section2AppCount = bankSection2AppCount;
                                item.bankReportItem.ubkPayment.NeedAmount = bankNeedAmount;
                                item.bankReportItem.ubkPayment.Section1NeedAmount = bankSection1NeedAmount;
                                item.bankReportItem.ubkPayment.Section2NeedAmount = bankSection2NeedAmount;
                                item.bankReportItem.ubkPayment.Percent = bankPercent;
                                item.bankReportItem.ubkPayment.Section2DocCount = bankSection2DocCount;
                                break;
                            }
                            case 2:
                            {

                                item.postReportItem.lifMonthlyGrantMoreThan3Year.Section2AppCount = postSection2AppCount;
                                item.postReportItem.lifMonthlyGrantMoreThan3Year.NeedAmount = postNeedAmount;
                                item.postReportItem.lifMonthlyGrantMoreThan3Year.Section1NeedAmount = postSection1NeedAmount;
                                item.postReportItem.lifMonthlyGrantMoreThan3Year.Section2NeedAmount = postSection2NeedAmount;
                                item.postReportItem.lifMonthlyGrantMoreThan3Year.Percent = postPercent;
                                item.postReportItem.lifMonthlyGrantMoreThan3Year.Section2DocCount = postSection2DocCount;

                                item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section2AppCount = bankSection2AppCount;
                                item.bankReportItem.lifMonthlyGrantMoreThan3Year.NeedAmount = bankNeedAmount;
                                item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section1NeedAmount = bankSection1NeedAmount;
                                item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section2NeedAmount = bankSection2NeedAmount;
                                item.bankReportItem.lifMonthlyGrantMoreThan3Year.Percent = bankPercent;
                                item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section2DocCount = bankSection2DocCount;
                                break;
                            }
                            case 3:
                            {
                                item.postReportItem.lifMonthlyGrantUpTo3Year.Section2AppCount = postSection2AppCount;
                                item.postReportItem.lifMonthlyGrantUpTo3Year.NeedAmount = postNeedAmount;
                                item.postReportItem.lifMonthlyGrantUpTo3Year.Section1NeedAmount = postSection1NeedAmount;
                                item.postReportItem.lifMonthlyGrantUpTo3Year.Section2NeedAmount = postSection2NeedAmount;
                                item.postReportItem.lifMonthlyGrantUpTo3Year.Percent = postPercent;
                                item.postReportItem.lifMonthlyGrantUpTo3Year.Section2DocCount = postSection2DocCount;

                                item.bankReportItem.lifMonthlyGrantUpTo3Year.Section2AppCount = bankSection2AppCount;
                                item.bankReportItem.lifMonthlyGrantUpTo3Year.NeedAmount = bankNeedAmount;
                                item.bankReportItem.lifMonthlyGrantUpTo3Year.Section1NeedAmount = bankSection1NeedAmount;
                                item.bankReportItem.lifMonthlyGrantUpTo3Year.Section2NeedAmount = bankSection2NeedAmount;
                                item.bankReportItem.lifMonthlyGrantUpTo3Year.Percent = bankPercent;
                                item.bankReportItem.lifMonthlyGrantUpTo3Year.Section2DocCount = bankSection2DocCount;
                                break;
                            }
                            case 4:
                            {
                                item.postReportItem.sbPayment.Section2AppCount = postSection2AppCount;
                                item.postReportItem.sbPayment.NeedAmount = postNeedAmount;
                                item.postReportItem.sbPayment.Section1NeedAmount = postSection1NeedAmount;
                                item.postReportItem.sbPayment.Section2NeedAmount = postSection2NeedAmount;
                                item.postReportItem.sbPayment.Percent = postPercent;
                                item.postReportItem.sbPayment.Section2DocCount = postSection2DocCount;

                                item.bankReportItem.sbPayment.Section2AppCount = bankSection2AppCount;
                                item.bankReportItem.sbPayment.NeedAmount = bankNeedAmount;
                                item.bankReportItem.sbPayment.Section1NeedAmount = bankSection1NeedAmount;
                                item.bankReportItem.sbPayment.Section2NeedAmount = bankSection2NeedAmount;
                                item.bankReportItem.sbPayment.Percent = bankPercent;
                                item.bankReportItem.sbPayment.Section2DocCount = postSection2DocCount;
                                break;
                            }
                        }
                    }
                }

                foreach (var item in reportItems)
                {
                    var ubkPayment = new ReportItem("Уй булого комок");
                    ubkPayment.Section2DocCount = item.postReportItem.ubkPayment.Section2DocCount + item.bankReportItem.ubkPayment.Section2DocCount;
                    ubkPayment.Section2AppCount = item.postReportItem.ubkPayment.Section2AppCount + item.bankReportItem.ubkPayment.Section2AppCount;
                    ubkPayment.NeedAmount = item.postReportItem.ubkPayment.NeedAmount + item.bankReportItem.ubkPayment.NeedAmount;
                    ubkPayment.Section1NeedAmount = item.postReportItem.ubkPayment.Section1NeedAmount + item.bankReportItem.ubkPayment.Section1NeedAmount;
                    ubkPayment.Section2NeedAmount = item.postReportItem.ubkPayment.Section2NeedAmount + item.bankReportItem.ubkPayment.Section2NeedAmount;
                    ubkPayment.Percent = item.postReportItem.ubkPayment.Percent + item.bankReportItem.ubkPayment.Percent;
                    item.totalReportItem.ubkPayment = ubkPayment;
                    item.totalReportItem.UbkNeedAmountWithPercent = ubkPayment.NeedAmount + ubkPayment.Percent;
                    if (ubkPayment.Section2AppCount == 0) item.totalReportItem.UbkAverageSumForPerson = Math.Round(ubkPayment.NeedAmount / 1, 2);
                    else item.totalReportItem.UbkAverageSumForPerson = Math.Round(ubkPayment.NeedAmount / ubkPayment.Section2AppCount, 2);

                    var sbPayment = new ReportItem("Соц.пособия");
                    sbPayment.Section2DocCount = item.postReportItem.sbPayment.Section2DocCount + item.bankReportItem.sbPayment.Section2DocCount;
                    sbPayment.Section2AppCount = item.postReportItem.sbPayment.Section2AppCount + item.bankReportItem.sbPayment.Section2AppCount;
                    sbPayment.NeedAmount = item.postReportItem.sbPayment.NeedAmount + item.bankReportItem.sbPayment.NeedAmount;
                    sbPayment.Section1NeedAmount = item.postReportItem.sbPayment.Section1NeedAmount + item.bankReportItem.sbPayment.Section1NeedAmount;
                    sbPayment.Section2NeedAmount = item.postReportItem.sbPayment.Section2NeedAmount + item.bankReportItem.sbPayment.Section2NeedAmount;
                    sbPayment.Percent = item.postReportItem.sbPayment.Percent + item.bankReportItem.sbPayment.Percent;
                    item.totalReportItem.sbPayment = sbPayment;
                    item.totalReportItem.SbNeedAmountWithPercent = sbPayment.NeedAmount + sbPayment.Percent;
                    if (sbPayment.Section2AppCount == 0) item.totalReportItem.SbAverageSumForPerson = Math.Round(sbPayment.NeedAmount / 1, 2);
                    else item.totalReportItem.SbAverageSumForPerson = Math.Round(sbPayment.NeedAmount / sbPayment.Section2AppCount, 2);

                    var lifMonthlyGrantMoreThan3Year = new ReportItem("ЕПМС более трех лет");
                    lifMonthlyGrantMoreThan3Year.Section2DocCount = item.postReportItem.lifMonthlyGrantMoreThan3Year.Section2DocCount + item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section2DocCount;
                    lifMonthlyGrantMoreThan3Year.Section2AppCount = item.postReportItem.lifMonthlyGrantMoreThan3Year.Section2AppCount + item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section2AppCount;
                    lifMonthlyGrantMoreThan3Year.NeedAmount = item.postReportItem.lifMonthlyGrantMoreThan3Year.NeedAmount + item.bankReportItem.lifMonthlyGrantMoreThan3Year.NeedAmount;
                    lifMonthlyGrantMoreThan3Year.Section1NeedAmount = item.postReportItem.lifMonthlyGrantMoreThan3Year.Section1NeedAmount + item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section1NeedAmount;
                    lifMonthlyGrantMoreThan3Year.Section2NeedAmount = item.postReportItem.lifMonthlyGrantMoreThan3Year.Section2NeedAmount + item.bankReportItem.lifMonthlyGrantMoreThan3Year.Section2NeedAmount;
                    lifMonthlyGrantMoreThan3Year.Percent = item.postReportItem.lifMonthlyGrantMoreThan3Year.Percent + item.bankReportItem.lifMonthlyGrantMoreThan3Year.Percent;
                    item.totalReportItem.lifMonthlyGrantMoreThan3Year = lifMonthlyGrantMoreThan3Year;
                    item.totalReportItem.MoreThan3YearNeedAmountWithPercent = lifMonthlyGrantMoreThan3Year.NeedAmount + lifMonthlyGrantMoreThan3Year.Percent;
                    if (lifMonthlyGrantMoreThan3Year.Section2AppCount == 0) item.totalReportItem.MoreThan3YearAverageSumForPerson = Math.Round(lifMonthlyGrantMoreThan3Year.NeedAmount / 1, 2);
                    else item.totalReportItem.MoreThan3YearAverageSumForPerson = Math.Round(lifMonthlyGrantMoreThan3Year.NeedAmount / lifMonthlyGrantMoreThan3Year.Section2AppCount, 2);

                    var lifMonthlyGrantUpTo3Year = new ReportItem("до 3 лет");
                    lifMonthlyGrantUpTo3Year.Section2DocCount = item.postReportItem.lifMonthlyGrantUpTo3Year.Section2DocCount + item.bankReportItem.lifMonthlyGrantUpTo3Year.Section2DocCount;
                    lifMonthlyGrantUpTo3Year.Section2AppCount = item.postReportItem.lifMonthlyGrantUpTo3Year.Section2AppCount + item.bankReportItem.lifMonthlyGrantUpTo3Year.Section2AppCount;
                    lifMonthlyGrantUpTo3Year.NeedAmount = item.postReportItem.lifMonthlyGrantUpTo3Year.NeedAmount + item.bankReportItem.lifMonthlyGrantUpTo3Year.NeedAmount;
                    lifMonthlyGrantUpTo3Year.Section1NeedAmount = item.postReportItem.lifMonthlyGrantUpTo3Year.Section1NeedAmount + item.bankReportItem.lifMonthlyGrantUpTo3Year.Section1NeedAmount;
                    lifMonthlyGrantUpTo3Year.Section2NeedAmount = item.postReportItem.lifMonthlyGrantUpTo3Year.Section2NeedAmount + item.bankReportItem.lifMonthlyGrantUpTo3Year.Section2NeedAmount;
                    lifMonthlyGrantUpTo3Year.Percent = item.postReportItem.lifMonthlyGrantUpTo3Year.Percent + item.bankReportItem.lifMonthlyGrantUpTo3Year.Percent;
                    item.totalReportItem.lifMonthlyGrantUpTo3Year = lifMonthlyGrantUpTo3Year;
                    item.totalReportItem.UpTo3YearNeedAmountWithPercent = lifMonthlyGrantUpTo3Year.NeedAmount + lifMonthlyGrantUpTo3Year.Percent;
                    if (lifMonthlyGrantUpTo3Year.Section2AppCount == 0) item.totalReportItem.UpTo3YearAverageSumForPerson = Math.Round(lifMonthlyGrantUpTo3Year.NeedAmount / 1, 2);
                    else item.totalReportItem.UpTo3YearAverageSumForPerson = Math.Round(lifMonthlyGrantUpTo3Year.NeedAmount / lifMonthlyGrantUpTo3Year.Section2AppCount, 2);

                    if (bishkekList.Contains(item.getOrgId())) item.ParentRegion = "аг.Бишкек";
                    if (chuiList.Contains(item.getOrgId())) item.ParentRegion = "аЧуйская область";
                    if (talasList.Contains(item.getOrgId())) item.ParentRegion = "бТаласская область";
                    if (issyk_kulList.Contains(item.getOrgId())) item.ParentRegion = "вИссык-Кульская область";
                    if (narynList.Contains(item.getOrgId())) item.ParentRegion = "гНарынская область";
                    if (batkenList.Contains(item.getOrgId())) item.ParentRegion = "дБаткенская область";
                    if (oshList.Contains(item.getOrgId())) item.ParentRegion = "еОшская область";
                    if (osh.Contains(item.getOrgId())) item.ParentRegion = "жг.Ош";
                    if (jalal_abad.Contains(item.getOrgId())) item.ParentRegion = "зДжалал-Абадская область";
                }
                return reportItems;
            }
            static GeneralReportItem GetReportItem(List<GeneralReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new GeneralReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class GeneralReportItem
            {
                public GeneralReportItem(Guid orgId)
                {
                    OrgId = orgId;
                    postReportItem = new PostReportItem();
                    bankReportItem = new BankReportItem();
                    totalReportItem = new TotalReportItem();
                }
                public Guid getOrgId()
                {
                    return OrgId;
                }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public string ParentRegion { get; set; }
                [DataMember]
                public string OrgName { get; set; }

                [DataMember]
                public PostReportItem postReportItem { get; set; }
                [DataMember]
                public BankReportItem bankReportItem { get; set; }
                [DataMember]
                public TotalReportItem totalReportItem { get; set; }
            }

            [DataContract]
            public class PostReportItem
            {
                [DataMember]
                public ReportItem ubkPayment { get; set; }
                [DataMember]
                public ReportItem sbPayment { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrantUpTo3Year { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrantMoreThan3Year { get; set; }
                public PostReportItem()
                {
                    ubkPayment = new ReportItem("Уй булого комок");
                    sbPayment = new ReportItem("Соц.пособия");
                    lifMonthlyGrantMoreThan3Year = new ReportItem("ЕПМС более трех лет");
                    lifMonthlyGrantUpTo3Year = new ReportItem("до 3 лет");
                }

            }

            [DataContract]
            public class BankReportItem
            {
                [DataMember]
                public ReportItem ubkPayment { get; set; }
                [DataMember]
                public ReportItem sbPayment { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrantUpTo3Year { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrantMoreThan3Year { get; set; }

                public BankReportItem()
                {
                    ubkPayment = new ReportItem("Уй булого комок");
                    sbPayment = new ReportItem("Соц.пособия");
                    lifMonthlyGrantMoreThan3Year = new ReportItem("ЕПМС более трех лет");
                    lifMonthlyGrantUpTo3Year = new ReportItem("до 3 лет");
                }

            }

            [DataContract]
            public class TotalReportItem
            {
                [DataMember]
                public ReportItem ubkPayment { get; set; }
                [DataMember]
                public ReportItem sbPayment { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrantUpTo3Year { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrantMoreThan3Year { get; set; }
                [DataMember]
                public decimal UbkNeedAmountWithPercent { get; set; }
                [DataMember]
                public decimal UbkAverageSumForPerson { get; set; }
                [DataMember]
                public decimal SbNeedAmountWithPercent { get; set; }
                [DataMember]
                public decimal SbAverageSumForPerson { get; set; }
                [DataMember]

                public decimal MoreThan3YearNeedAmountWithPercent { get; set; }
                [DataMember]
                public decimal MoreThan3YearAverageSumForPerson { get; set; }
                [DataMember]

                public decimal UpTo3YearNeedAmountWithPercent { get; set; }
                [DataMember]
                public decimal UpTo3YearAverageSumForPerson { get; set; }

                public TotalReportItem()
                {
                    ubkPayment = new ReportItem("Уй булого комок");
                    sbPayment = new ReportItem("Соц.пособия");
                    lifMonthlyGrantMoreThan3Year = new ReportItem("ЕПМС более трех лет");
                    lifMonthlyGrantUpTo3Year = new ReportItem("до 3 лет");
                }
            }

            [DataContract]
            public class ReportItem
            {
                public ReportItem(string paymentName)
                {
                    PaymentName = paymentName;
                }
                [DataMember]
                public string PaymentName { get; set; }
                [DataMember]
                public int Section2DocCount { get; set; }
                [DataMember]
                public int Section2AppCount { get; set; }
                [DataMember]
                public decimal NeedAmount { get; set; }
                [DataMember]
                public decimal Section1NeedAmount { get; set; }
                [DataMember]
                public decimal Section2NeedAmount { get; set; }
                [DataMember]
                public decimal Percent { get; set; }
            }

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
        }
        /*******************************************************************************************************************/
        public static class Report_2001A  //active code  
        {
            private static readonly Guid reportDefId = new Guid("{9580E9AE-5949-4B83-90F0-EED511B63477}"); //Заявка на финансирование ДЕСП
            private static readonly Guid reportItemDefId = new Guid("{D2FCA75E-34E4-4E85-93B5-6917C4F18BC2}");  //Строка ДЕСП
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");
            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var itemSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                query.AddAttribute(itemSrc, "AppCount");
                query.AddAttribute(itemSrc, "Category");
                query.AddAttribute(itemSrc, "PostNeedAmount");
                query.AddAttribute(itemSrc, "BankNeedAmount");
                query.AddAttribute(itemSrc, "PostPercent");
                query.AddAttribute(itemSrc, "BankPercent");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(itemSrc, "PostSection1NeedAmount");
                query.AddAttribute(itemSrc, "BankSection1NeedAmount");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appCount = row[0] is DBNull ? 0 : (int)row[0];
                    var category = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var postNeedAmount = row[2] is DBNull ? 0m : (decimal)row[2];
                    var bankNeedAmount = row[3] is DBNull ? 0m : (decimal)row[3];
                    var postPercent = row[4] is DBNull ? 0m : (decimal)row[4];
                    var bankPercent = row[5] is DBNull ? 0m : (decimal)row[5];
                    var appId = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                    var orgId = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                    var postNeedSec1Amount = row[8] is DBNull ? 0m : (decimal)row[8];
                    var bankNeedSec1Amount = row[9] is DBNull ? 0m : (decimal)row[9];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        /*Дети погибшего в событиях 2010 г. до 18 лет*/
                        if (category.Equals(new Guid("{608F740E-C44B-4305-88E8-F53D497214C0}")))
                            rayon.Cat18years += appCount;
                        /*Получившие вред здоровью в событиях 2010 г., имеющие заключение СМЭ   / Признанные ЛОВЗ в следствие событий 2010 г.*/
                        if ((category.Equals(new Guid("{ECDF4DE6-299E-4C6A-843F-49362C32EB96}"))) || (category.Equals(new Guid("{7D08F570-239D-46BF-BF4F-6E3A510ACCD2}"))))
                            rayon.CatLOVZ += appCount;
                        //Родители погибшего ед. ребенка в событиях 2010 г. по достижении пенсионного возраста
                        if (category.Equals(new Guid("{238BD896-A3B7-494D-B549-4AAC292EE8F5}")))
                            rayon.CatParents += appCount;
                        if (appCount != 0) rayon.AppCount += appCount;

                        rayon.PostBankNeedAmount += postNeedAmount + bankNeedAmount/* + postNeedSec1Amount + bankNeedSec1Amount*/;
                        rayon.PostPercent += postPercent;
                        rayon.BankPercent += bankPercent;
                        rayon.PostBankPercent += postPercent + bankPercent;
                        rayon.PostBankNeedAmountPercent = rayon.PostBankNeedAmount + rayon.PostBankPercent;
                    }
                }
                // RegionReportItem regionReportItem = new RegionReportItem();
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    //regionReportItem.BishkekCityRegion.Add(subItem);
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    //regionReportItem.ChuyRegion.Add(subItem);
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    //regionReportItem.TalasRegion.Add(subItem);
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    //regionReportItem.YssykKolRegion.Add(subItem);
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    //regionReportItem.NarynRegion.Add(subItem);
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    //regionReportItem.BatkenRegion.Add(subItem);
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    //regionReportItem.OshRegion.Add(subItem);
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    //regionReportItem.OshCityRegion.Add(subItem);
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                    //regionReportItem.JalalAbadRegion.Add(subItem);
                }
                return items;
            }

            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int Cat18years { get; set; }
                [DataMember]
                public int CatLOVZ { get; set; }

                [DataMember]
                public int CatParents { get; set; }
                [DataMember]
                public int AppCount { get; set; }
                [DataMember]
                public decimal PostBankNeedAmount { get; set; }
                [DataMember]
                public decimal PostPercent { get; set; }
                [DataMember]
                public decimal BankPercent { get; set; }
                [DataMember]
                public decimal PostBankPercent { get; set; }
                [DataMember]
                public decimal PostBankNeedAmountPercent { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_2001B  ////active code
        {
            private static readonly Guid reportDefId = new Guid("{73A632C4-9F82-4861-BF3A-E5C895A3B00F}"); //Заявка на финансирование ДЕСП (Аксы)
            private static readonly Guid reportItemDefId = new Guid("{ED58934E-989C-4AE6-AB19-A432F06E43E0}");
            private static readonly Guid socialBenefitReportDefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");

            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}");
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                CalcItems(context, year, month, items);
                return items;
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month, List<ReportItem> items)
            {
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);

                var itemSrc = query.JoinSource(query.Source, reportItemDefId, SqlSourceJoinType.Inner, "Rows");

                query.AddAttribute(itemSrc, "AppCount");
                query.AddAttribute(itemSrc, "PostNeedAmount");
                query.AddAttribute(itemSrc, "BankNeedAmount");
                query.AddAttribute(itemSrc, "PostPercent");
                query.AddAttribute(itemSrc, "BankPercent");
                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(itemSrc, "PostSection1NeedAmount");
                query.AddAttribute(itemSrc, "BankSection1NeedAmount");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appCount = row[0] is DBNull ? 0 : (int)row[0];
                    var postNeedAmount = row[1] is DBNull ? 0m : (decimal)row[1];
                    var bankNeedAmount = row[2] is DBNull ? 0m : (decimal)row[2];
                    var postPercent = row[3] is DBNull ? 0m : (decimal)row[3];
                    var bankPercent = row[4] is DBNull ? 0m : (decimal)row[4];
                    var appId = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                    var orgId = row[6] is DBNull ? Guid.Empty : (Guid)row[6];                    
                    var postNeedSec1Amount = row[7] is DBNull ? 0m : (decimal)row[7];
                    var bankNeedSec1Amount = row[8] is DBNull ? 0m : (decimal)row[8];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon);

                    if (appId != Guid.Empty)
                    {
                        rayon.AppCount += appCount;
                        rayon.PostBankNeedAmount += postNeedAmount + bankNeedAmount /*+ postNeedSec1Amount + bankNeedSec1Amount*/;
                        rayon.PostPercent += postPercent;
                        rayon.BankPercent += bankPercent;
                        decimal percent = 0m;
                        percent += postPercent + bankPercent;
                        rayon.PostBankPercent = percent / 1000;
                        rayon.PostBankNeedAmountPercent = rayon.PostBankNeedAmount + rayon.PostBankPercent;
                    }
                }
                return items;
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }
            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                public int AppCount { get; set; }
                [DataMember]
                public decimal PostBankNeedAmount { get; set; }
                [DataMember]
                public decimal PostPercent { get; set; }
                [DataMember]
                public decimal BankPercent { get; set; }
                [DataMember]
                public decimal PostBankPercent { get; set; }
                [DataMember]
                public decimal PostBankNeedAmountPercent { get; set; }

            }
        }

        /*******************************************************************************************************************/
        public static class Report_2003
        {
            // Виды выплат
            private static readonly Guid retirementBenefitPaymentId = new Guid("{AFAA7F86-74AE-4260-9933-A56F7845E55A}");
            private static readonly Guid childBenefitPaymentId = new Guid("{AB3F8C41-897A-4574-BAA0-B7CD4AAA1C80}");
            private static readonly Guid invalidBenefitPaymentId = new Guid("{70C28E62-2387-4A59-917D-A366ADE119A8}");
            private static readonly Guid survivorBenefitPaymentId = new Guid("{839D5712-E75B-4E71-83F7-168CE4F089C0}");
            private static readonly Guid aidsFromBenefitPaymentId = new Guid("{3BEBE4F9-0B15-41CB-9B96-54E83819AB0F}");
            private static readonly Guid aidsBenefitPaymentId = new Guid("{47EEBFBC-A4E9-495D-A6A1-F87B5C3057C9}");
            private static readonly Guid orphanBenefitPaymentId = new Guid("{4F12C366-7E2F-4208-9CB8-4EAB6E6C0EF1}");

            private static readonly Guid alpineRetirementCategoryId = new Guid("{587D9992-DBB7-4BAD-A358-0FA571EBDB37}");
            private static readonly Guid retirementCategoryId = new Guid("{56DD1E0D-F693-470D-8756-6969DFA71A02}");
            private static readonly Guid heroMotherCategoryId = new Guid("{F21D59E6-BBAA-40D8-89FC-C7B3A707E8E6}");
            private static readonly Guid childDisableCategoryId = new Guid("{FDBDD774-EB88-46EA-9559-005D655BC196}");
            private static readonly Guid orphanChildren = new Guid("{401D9570-2A4E-453D-869E-9AA2603C9CD8}");
            private static readonly Guid childSurvivorsCategoryId = new Guid("{304A01B8-8A08-413E-B3D5-7B2C237829A2}");
            private static readonly Guid childFromAidsCategoryId = new Guid("{DE66F6D7-5462-4D45-8B20-6478728B5BD3}");
            private static readonly Guid childenAidsCategoryId = new Guid("{2222FD98-B885-4DC0-A0D4-271600AF281A}");
            private static readonly Guid childISPCategoryId = new Guid("{1E750C67-2DDF-488E-A4C4-D94547433067}");
            private static readonly Guid childhood1CategoryId = new Guid("{D18791C9-DE0A-4E15-92A8-20EF140C51ED}");
            private static readonly Guid childhood2CategoryId = new Guid("{305621EC-9ECC-4AF9-810D-5B639C339D50}");
            private static readonly Guid childhood3CategoryId = new Guid("{FD3B12FB-55D3-4229-975E-342AC126E942}");
            private static readonly Guid commonDeseas1CategoryId = new Guid("{409BCDA9-6770-4D3F-B515-7DE0E341C63D}");
            private static readonly Guid commonDeseas2CategoryId = new Guid("{0955ED04-8A32-476B-AE6E-E51DE0F2C66D}");
            private static readonly Guid commonDeseas3CategoryId = new Guid("{7B622DDA-D6C0-48CA-AFA9-7C74149D8BD5}");
            private static readonly Guid hearDisabled1CategoryId = new Guid("{C7B397DF-8325-4F0D-A94C-F8BD5E8152E4}");
            private static readonly Guid hearDisabled2CategoryId = new Guid("{18A54BA7-0330-40B3-AE9E-67D049004AB0}");
            private static readonly Guid hearDisabled3CategoryId = new Guid("{DB4E8C78-A17F-44FD-890D-A67F1EA2B457}");
            private static readonly Guid eyesDisabled1CategoryId = new Guid("{5EE97C99-B2A1-4759-9A28-876B08FE7BA8}");
            private static readonly Guid eyesDisabled2CategoryId = new Guid("{947E64F0-18EC-4A6B-80C0-FCECFE7C67C2}");
            private static readonly Guid eyesDisabled3CategoryId = new Guid("{8B787FCA-62EE-4261-9094-1FFAC1BF4C02}");

            private static List<object> categoryTypes = new List<object>
            {
                heroMotherCategoryId,
                alpineRetirementCategoryId,
                retirementCategoryId,
                orphanChildren,
                childSurvivorsCategoryId,
                commonDeseas3CategoryId,
                commonDeseas2CategoryId,
                commonDeseas1CategoryId,
                childhood3CategoryId,
                childhood2CategoryId,
                childhood1CategoryId,
                childenAidsCategoryId,
                childFromAidsCategoryId,
                childISPCategoryId,
                childDisableCategoryId
            };
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}");
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}");
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid assignmentDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");
            private static readonly Guid reportDefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");
            private static readonly Guid reportItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}");
            private static readonly Guid tariffDefId = new Guid("{0F29B75F-DE90-4910-9524-B74CB0418A57}");
            private static readonly Guid section1TypeId = new Guid("{2A273790-9091-4DBD-A712-12D46578196C}");
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");
            private static readonly Guid bankDefId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid postDefId = new Guid("{AC649550-67AF-4F7F-8D96-DC22484F7F04}");
            // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении
            private static readonly Guid onRegisteringStateId = new Guid("{A9CD37C4-A718-4DE1-9E95-EC8EC280C8D4}"); // На регистрации
            private static readonly Guid refusedStateId = new Guid("{CA1157A0-FDDF-4C90-9692-7CDB47CCC7C2}"); // Отказан

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                try
                {
                    var ui = context.GetUserInfo();
                    return Build(year, month, context.UserId, (Guid)ui.OrganizationId, context);

                }
                catch (Exception ex)
                {
                    throw new ApplicationException("TargetSite: " + ex.TargetSite.Name + "; Message: " + ex.Message);
                }
            }
            private static Doc GetReportDoc(WorkflowContext context, List<object[]> reports)
            {
                Doc report;
                var docRepo = context.Documents;
                var approvedReportId = reports.FirstOrDefault(r => (Guid)r[1] == approvedStateId);
                if (approvedReportId != null)
                {
                    context["ApprovedReport"] = docRepo.LoadById((Guid)approvedReportId[0]);
                    return null;
                }
                reports = reports.Where(r => (Guid)r[1] == onRegisteringStateId).ToList();
                if (reports.Count > 0)
                {
                    var onRegisteringReportId = reports.FirstOrDefault(x => (DateTime)x[2] == reports.Max(r => (DateTime)r[2]));
                    report = docRepo.LoadById((Guid)onRegisteringReportId[0]);
                    reports.RemoveAll(x => (Guid)x[0] == (Guid)onRegisteringReportId[0]);
                    report["DocCount"] = null;
                    report["AppCount"] = null;
                    report["NeedAmount"] = null;
                    report["Percent"] = null;
                    report["NeedAmountPercent"] = null;
                    docRepo.ClearAttrDocList(report.Id, report.Get<DocListAttribute>("Rows").AttrDef.Id);
                    foreach (var reportId in reports.Select(x => (Guid)x[0]))
                    {
                        docRepo.SetDocState(reportId, refusedStateId);
                    }
                }
                else
                    report = docRepo.New(reportDefId);
                return report;
            }
            public static List<ReportItem> Build(int year, int month, Guid userId, Guid orgId, WorkflowContext context)
            {
                if (year < 2011 || year > 3000)
                    throw new ApplicationException("Ошибка в значении года!");
                if (month < 1 || month > 12)
                    throw new ApplicationException("Ошибка в значении месяца!");
                var docRepo = context.Documents;
                var qb = new QueryBuilder(reportDefId);
                qb.Where("&OrgId").Eq(orgId).And("Month").Eq(month).And("Year").Eq(year).And("&State").Neq(refusedStateId);

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                query.AddAttribute("&State");
                query.AddAttribute("&Created");
                var reports = new List<object[]>();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        reports.Add(new object[] { reader.GetGuid(0), reader.GetGuid(1), reader.GetDateTime(2) });
                    }
                }

                Doc report = GetReportDoc(context, reports);
                if (report == null)
                {
                    return new List<ReportItem>();
                }

                Dictionary<Guid, Decimal> prices = GetPriceList(userId, month, year, context);

                decimal postPercent = GetPostPercent(year, month, userId, context);
                List<Doc> items = new List<Doc>();
                var reportItemList = new List<ReportItem>();

                //Инициализация строк отчета
                foreach (Guid categoryId in categoryTypes)
                {
                    if (!prices.ContainsKey(categoryId)) continue;
                    Doc item = docRepo.New(reportItemDefId);
                    item["Category"] = categoryId;
                    item["PaymentPrice"] = prices[categoryId];
                    reportItemList.Add(new ReportItem { Category = context.Enums.GetValue(categoryId).Value, PaymentPrice = prices[categoryId] });
                    items.Add(item);
                }

                CalcSection1(items, context, year, month, orgId, userId, postPercent);

                CalcSection2(items, context, year, month, orgId, userId, postPercent);

                CalcFields(items, report, reportItemList);

                items.Reverse();
                foreach (Doc item in items)
                {
                    docRepo.Save(item);
                    docRepo.AddDocToList(item.Id, report, "Rows");
                }
                report["Year"] = year;
                report["Month"] = month;
                report["Organization"] = orgId;

                docRepo.Save(report);
                docRepo.SetDocState(report, onRegisteringStateId);
                return reportItemList;
            }
            private static void CalcSection1(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section1TypeId);
            }
            private static void CalcSection2(List<Doc> items, WorkflowContext context, int year, int month, Guid orgId, Guid userId, decimal postPercent)
            {
                CalcAppCount(userId, postOrderDefId, year, month, orgId, items, "Post", postPercent, context, section2TypeId);
                CalcOrdersCount(userId, postOrderDefId, year, month, orgId, items, "Post", context);
                CalcAmountSum(userId, year, month, orgId, items, postPercent, "Post", context, section2TypeId);
            }
            private static void CalcFields(List<Doc> items, Doc report, List<ReportItem> _items)
            {
                int i = 0;
                foreach (var item in items)
                {
                    var _item = _items[i];
                    FieldsInit(item);
                    item["PostNeedAmount"] = (decimal)item["PostSection1NeedAmount"] + (decimal)item["PostSection2NeedAmount"];
                    item["PostPercent"] = (decimal)item["PostSection1Percent"] + (decimal)item["PostSection2Percent"];
                    item["PostNeedAmountPercent"] = (decimal)item["PostNeedAmount"] + (decimal)item["PostPercent"];

                    item["BankNeedAmount"] = (decimal)item["BankSection1NeedAmount"] + (decimal)item["BankSection2NeedAmount"];
                    item["BankPercent"] = (decimal)item["BankSection1Percent"] + (decimal)item["BankSection2Percent"];
                    item["BankNeedAmountPercent"] = (decimal)item["BankNeedAmount"] + (decimal)item["BankPercent"];

                    item["DocCount"] = (int)item["PostSection2DocCount"] + (int)item["BankSection2DocCount"];
                    item["AppCount"] = (int)item["PostSection2AppCount"] + (int)item["BankSection2AppCount"];
                    item["NeedAmount"] = (decimal)item["PostNeedAmount"] + (decimal)item["BankNeedAmount"];
                    item["Percent"] = (decimal)item["PostPercent"] + (decimal)item["BankPercent"];
                    item["NeedAmountPercent"] = (decimal)item["PostNeedAmountPercent"] + (decimal)item["BankNeedAmountPercent"];

                    report["DocCount"] = ((int?)report["DocCount"] ?? 0) + (int)item["DocCount"];
                    report["AppCount"] = ((int?)report["AppCount"] ?? 0) + (int)item["AppCount"];
                    report["NeedAmount"] = ((decimal?)report["NeedAmount"] ?? 0) + (decimal)item["NeedAmount"];
                    report["Percent"] = ((decimal?)report["Percent"] ?? 0) + (decimal)item["Percent"];
                    report["NeedAmountPercent"] = ((decimal?)report["NeedAmountPercent"] ?? 0) + (decimal)item["NeedAmountPercent"];
                    FieldsInit(item, _item);
                    i++;
                }
            }
            private static void FieldsInit(Doc item, ReportItem _item = null)
            {
                item["DocCount"] = (int?)item["DocCount"] ?? 0;
                item["AppCount"] = (int?)item["AppCount"] ?? 0;
                item["NeedAmount"] = (decimal?)item["NeedAmount"] ?? 0;
                item["Percent"] = (decimal?)item["Percent"] ?? 0;
                item["NeedAmountPercent"] = (decimal?)item["NeedAmountPercent"] ?? 0;
                item["PostSection1MonthCount"] = (int?)item["PostSection1MonthCount"] ?? 0;
                item["PostSection1AppCount"] = (int?)item["PostSection1AppCount"] ?? 0;
                item["PostSection1NeedAmount"] = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                item["PostSection1Percent"] = (decimal?)item["PostSection1Percent"] ?? 0;
                item["PostSection2DocCount"] = (int?)item["PostSection2DocCount"] ?? 0;
                item["PostSection2AppCount"] = (int?)item["PostSection2AppCount"] ?? 0;
                item["PostSection2NeedAmount"] = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                item["PostSection2Percent"] = (decimal?)item["PostSection2Percent"] ?? 0;
                item["PostAppCount"] = (int?)item["PostAppCount"] ?? 0;
                item["PostNeedAmount"] = (decimal?)item["PostNeedAmount"] ?? 0;
                item["PostPercent"] = (decimal?)item["PostPercent"] ?? 0;
                item["PostNeedAmountPercent"] = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                item["BankSection1MonthCount"] = (int?)item["BankSection1MonthCount"] ?? 0;
                item["BankSection1AppCount"] = (int?)item["BankSection1AppCount"] ?? 0;
                item["BankSection1NeedAmount"] = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                item["BankSection1Percent"] = (decimal?)item["BankSection1Percent"] ?? 0;
                item["BankSection2DocCount"] = (int?)item["BankSection2DocCount"] ?? 0;
                item["BankSection2AppCount"] = (int?)item["BankSection2AppCount"] ?? 0;
                item["BankSection2NeedAmount"] = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                item["BankSection2Percent"] = (decimal?)item["BankSection2Percent"] ?? 0;
                item["BankAppCount"] = (int?)item["BankAppCount"] ?? 0;
                item["BankNeedAmount"] = (decimal?)item["BankNeedAmount"] ?? 0;
                item["BankPercent"] = (decimal?)item["BankPercent"] ?? 0;
                item["BankNeedAmountPercent"] = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                if (_item != null)
                {
                    _item.DocCount = (int?)item["DocCount"] ?? 0;
                    _item.AppCount = (int?)item["AppCount"] ?? 0;
                    _item.NeedAmount = (decimal?)item["NeedAmount"] ?? 0;
                    _item.Percent = (decimal?)item["Percent"] ?? 0;
                    _item.NeedAmountPercent = (decimal?)item["NeedAmountPercent"] ?? 0;
                    _item.PostSection1MonthCount = (int?)item["PostSection1MonthCount"] ?? 0;
                    _item.PostSection1AppCount = (int?)item["PostSection1AppCount"] ?? 0;
                    _item.PostSection1NeedAmount = (decimal?)item["PostSection1NeedAmount"] ?? 0;
                    _item.PostSection1Percent = (decimal?)item["PostSection1Percent"] ?? 0;
                    _item.PostSection2DocCount = (int?)item["PostSection2DocCount"] ?? 0;
                    _item.PostSection2AppCount = (int?)item["PostSection2AppCount"] ?? 0;
                    _item.PostSection2NeedAmount = (decimal?)item["PostSection2NeedAmount"] ?? 0;
                    _item.PostSection2Percent = (decimal?)item["PostSection2Percent"] ?? 0;
                    _item.PostAppCount = (int?)item["PostAppCount"] ?? 0;
                    _item.PostNeedAmount = (decimal?)item["PostNeedAmount"] ?? 0;
                    _item.PostPercent = (decimal?)item["PostPercent"] ?? 0;
                    _item.PostNeedAmountPercent = (decimal?)item["PostNeedAmountPercent"] ?? 0;

                    _item.BankSection1MonthCount = (int?)item["BankSection1MonthCount"] ?? 0;
                    _item.BankSection1AppCount = (int?)item["BankSection1AppCount"] ?? 0;
                    _item.BankSection1NeedAmount = (decimal?)item["BankSection1NeedAmount"] ?? 0;
                    _item.BankSection1Percent = (decimal?)item["BankSection1Percent"] ?? 0;
                    _item.BankSection2DocCount = (int?)item["BankSection2DocCount"] ?? 0;
                    _item.BankSection2AppCount = (int?)item["BankSection2AppCount"] ?? 0;
                    _item.BankSection2NeedAmount = (decimal?)item["BankSection2NeedAmount"] ?? 0;
                    _item.BankSection2Percent = (decimal?)item["BankSection2Percent"] ?? 0;
                    _item.BankAppCount = (int?)item["BankAppCount"] ?? 0;
                    _item.BankNeedAmount = (decimal?)item["BankNeedAmount"] ?? 0;
                    _item.BankPercent = (decimal?)item["BankPercent"] ?? 0;
                    _item.BankNeedAmountPercent = (decimal?)item["BankNeedAmountPercent"] ?? 0;
                }
            }
            public class ReportItem
            {
                public int RowNo { get; set; }
                public string RowName { get; set; }
                public decimal Percent { get; set; }
                public string Category { get; set; }
                public int AppCount { get; set; }
                public decimal NeedAmountPercent { get; set; }
                public decimal PaymentPrice { get; set; }
                public decimal NeedAmount { get; set; }
                public int DocCount { get; set; }
                public int PostAppCount { get; set; }
                public decimal PostPercent { get; set; }
                public decimal PostNeedAmountPercent { get; set; }
                public decimal PostNeedAmount { get; set; }
                public int PostDocCount { get; set; }
                public int PostSection1DocCount { get; set; }
                public int PostSection1AppCount { get; set; }
                public decimal PostSection1Percent { get; set; }
                public decimal PostSection1NeedAmountPercent { get; set; }
                public int PostSection1MonthCount { get; set; }
                public decimal PostSection1NeedAmount { get; set; }
                public int PostSection2AppCount { get; set; }
                public int PostSection2MonthCount { get; set; }
                public decimal PostSection2NeedAmountPercent { get; set; }
                public decimal PostSection2Percent { get; set; }
                public int BankAppCount { get; set; }
                public int PostSection2DocCount { get; set; }
                public decimal PostSection2NeedAmount { get; set; }
                public int BankDocCount { get; set; }
                public decimal BankNeedAmountPercent { get; set; }
                public decimal BankPercent { get; set; }
                public decimal BankNeedAmount { get; set; }
                public int BankSection2DocCount { get; set; }
                public decimal BankSection2NeedAmount { get; set; }
                public decimal BankSection2NeedAmountPercent { get; set; }
                public int BankSection2MonthCount { get; set; }
                public decimal BankSection2Percent { get; set; }
                public int BankSection2AppCount { get; set; }
                public decimal BankSection1NeedAmount { get; set; }
                public int BankSection1DocCount { get; set; }
                public decimal BankSection1Percent { get; set; }
                public decimal BankSection1NeedAmountPercent { get; set; }
                public int BankSection1AppCount { get; set; }
                public int BankSection1MonthCount { get; set; }
            }
            private static void CalcAppCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, decimal postPercent, WorkflowContext context, Guid sectionTypeId)
            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                    canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                {
                retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                });
                query.AddAttribute(appSrc, "Assignments", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                /*****************************/
                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty)
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория не найдена.");

                    if (!categoryTypes.Contains(categoryId))
                    {
                        var catName = context.Enums.GetValue(categoryId).Value;
                        throw new ApplicationException("Ошибка при чтении кол-ва чел. - " + orderTypeName + ". Категория \"" + catName + "\" не входит в число получателей денежной компенсации.");
                    }
                    var item = items[categoryTypes.IndexOf(categoryId)];
                    var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                    var field = orderTypeName + "Section" + sNum + "AppCount";
                    item[field] = ((int?)item[field] ?? 0) + count;
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);

                /*************************************/
                /*foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    try
                    {
                        var item = GetItemByCategory(items, categoryId);
                        var sNum = sectionTypeId == section1TypeId ? 1 : 2;
                        var field = orderTypeName + "Section" + sNum + "AppCount";
                        item[field] = ((int?)item[field] ?? 0) + count;
                    }
                    catch
                    {
                        throw new Exception(context.Enums.GetValue(categoryId).Value);
                        continue;
                    }
                }
                if (orderDefId != bankOrderDefId) CalcAppCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", postPercent, context, sectionTypeId);*/
            }
            private static void CalcOrdersCount(Guid userId, Guid orderDefId, int year, int month, Guid orgId, List<Doc> items, string orderTypeName, WorkflowContext context)

            {
                SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                var orderSrc = query.JoinSource(query.Source, orderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                query.AddCondition(ExpressionOperation.And, orderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                    canceledStateId, onApprovingStateId
                    });
                query.AddCondition(ExpressionOperation.And, orderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                {
                retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                });
                query.AddAttribute(orderSrc, "&Id", SqlQuerySummaryFunction.Count);
                var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                query.AddGroupAttribute(appPaymentAttr);
                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    int docCount = (int?)row[0] ?? 0;
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    Doc item = items[categoryTypes.IndexOf(categoryId)];
                    item[orderTypeName + "Section2DocCount"] = docCount;
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);
                /*
                foreach (DataRow row in table.Rows)
                {
                    int docCount = row[0] is DBNull ? 0 : (int)row[0];
                    Guid categoryId;
                    Guid.TryParse(row[1].ToString(), out categoryId);
                    if (categoryId == Guid.Empty) continue;
                    try
                    {
                        var item = GetItemByCategory(items, categoryId);
                        item[orderTypeName + "Section2DocCount"] = docCount;
                    }
                    catch
                    {
                        throw new Exception(context.Enums.GetValue(categoryId).Value);
                        continue;
                    }
                }
                if (orderDefId != bankOrderDefId)
                    CalcOrdersCount(userId, bankOrderDefId, year, month, orgId, items, "Bank", context);*/
            }
            private static void CalcAmountSum(Guid userId, int year, int month, Guid orgId, List<Doc> items, decimal postPercent, string orderTypeName, WorkflowContext context, Guid sectionTypeId)
            {
                var field = orderTypeName + "Section" + (sectionTypeId == section1TypeId ? 1 : 2);
                if (orderTypeName == "Post")
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                    canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                    {
                    retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                    });
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        try
                        {
                            decimal service = (amount / 100) * postPercent;
                            var item = items[categoryTypes.IndexOf(categoryId)];
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);
                    /*
                    string text = "";
                    decimal sum = 0m;
                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        Guid categoryId;
                        Guid.TryParse(row[1].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * postPercent;
                        try
                        {
                            var item = GetItemByCategory(items, categoryId);
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                    CalcAmountSum(userId, year, month, orgId, items, postPercent, "Bank", context, sectionTypeId);*/
                }
                else
                {
                    SqlQuery query = new SqlQuery(context.DataContext, orderPaymentDefId, userId);
                    var orderSrc = query.JoinSource(query.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                    var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                    var bankSrc = query.JoinSource(orderSrc, bankDefId, SqlSourceJoinType.Inner, "Bank");
                    //query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                    query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, sectionTypeId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                    {
                    canceledStateId, onApprovingStateId
                    });
                    query.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                    query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.In, new object[]
                    {
                    retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
                    aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
                    });
                    query.AddAttribute("Amount", SqlQuerySummaryFunction.Sum);
                    var bankAttr = query.AddAttribute(bankSrc, "Percent");
                    var appPaymentAttr = query.AddAttribute(appSrc, "PaymentCategory");
                    query.AddGroupAttribute(appPaymentAttr);
                    query.AddGroupAttribute(bankAttr);
                    var table = new DataTable();
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent = row[1] is DBNull ? 0 : (double)row[1];
                        Guid categoryId = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        if (categoryId == Guid.Empty) continue;
                        try
                        {
                            decimal service = amount / 100 * (decimal)percent;

                            var item = items[categoryTypes.IndexOf(categoryId)];
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }
                    /*foreach (DataRow row in table.Rows)
                    {
                        decimal amount = row[0] is DBNull ? 0 : (decimal)row[0];
                        double percent;
                        double.TryParse(row[1].ToString(), out percent);
                        Guid categoryId;
                        Guid.TryParse(row[2].ToString(), out categoryId);
                        if (categoryId == Guid.Empty) continue;
                        decimal service = (amount / 100) * (decimal)percent;
                        try
                        {
                            var item = GetItemByCategory(items, categoryId);
                            item[field + "NeedAmount"] = ((decimal?)item[field + "NeedAmount"] ?? 0m) + amount;
                            item[field + "Percent"] = ((decimal?)item[field + "Percent"] ?? 0m) + service;
                        }
                        catch
                        {
                            continue;
                        }
                    }*/
                }
            }
            private static Doc GetItemByCategory(List<Doc> items, Guid categoryId)
            {
                if ((new[] { commonDeseas1CategoryId, hearDisabled1CategoryId, eyesDisabled1CategoryId }).Contains(categoryId))
                    return items[categoryTypes.IndexOf(commonDeseas1CategoryId)];
                else if ((new[] { commonDeseas2CategoryId, hearDisabled2CategoryId, eyesDisabled2CategoryId }).Contains(categoryId))
                    return items[categoryTypes.IndexOf(commonDeseas2CategoryId)];
                else if ((new[] { commonDeseas3CategoryId, hearDisabled3CategoryId, eyesDisabled3CategoryId }).Contains(categoryId))
                    return items[categoryTypes.IndexOf(commonDeseas3CategoryId)];
                else
                    return items[categoryTypes.IndexOf(categoryId)];
            }

            private static Dictionary<Guid, Decimal> GetPriceList(Guid userId, int month, int year, WorkflowContext context)
            {
                Dictionary<Guid, Decimal> catList = new Dictionary<Guid, Decimal>();
                QueryBuilder qb = new QueryBuilder(tariffDefId, userId);
                qb.Where("EffectiveDate").Le(new DateTime(year, month, 1)).And("ExpiryDate").Ge(new DateTime(year, month,
                DateTime.DaysInMonth(year, month)))
                .And("PaymentType").In(new object[]
            {
            retirementBenefitPaymentId, childBenefitPaymentId, invalidBenefitPaymentId, survivorBenefitPaymentId,
            aidsFromBenefitPaymentId, aidsBenefitPaymentId, orphanBenefitPaymentId
            });
                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Category");
                query.AddAttribute("Amount");
                using (DataTable table = new DataTable())
                {
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        Guid categoryId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        if (categoryId != Guid.Empty)
                            if (!catList.ContainsKey(categoryId))
                                catList.Add(categoryId, row[1] is DBNull ? 0 : (decimal)row[1]);
                    }
                }
                return catList;
            }
            public static decimal GetPostPercent(int year, int month, Guid userId, WorkflowContext context)
            {
                SqlQuery query = new SqlQuery(context.DataContext, postDefId, userId);
                query.AddCondition(ExpressionOperation.And, postDefId, "DateFrom", ConditionOperation.LessEqual, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, postDefId, "DateTo", ConditionOperation.GreatEqual, new DateTime(year, month, DateTime.DaysInMonth(year, month)));
                query.AddAttribute("Size");
                using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                return 0m;
            }
        }

        /*******************************************************************************************************************/
        public static class Report_2006 //active code
        {
            static Guid reportNo1DefId = new Guid("{1A09ECD6-55E1-4307-862E-6F98F47E252C}");//Уй-булого комок (от 0 до 16 лет)
            static Guid reportNo1ItemDefId = new Guid("{2A8709AB-3522-4019-A29F-5C333893645B}");//Rows Уй-булого комок (от 0 до 16 лет)

            static Guid reportNo2DefId = new Guid("{0C6A34A9-CF41-4750-B21D-9913672A0C76}");//ЕПМС
            static Guid reportNo2ItemDefId = new Guid("{760233C7-3FC3-4417-95AE-F399B8B0208F}");//Rows ЕПМС

            static Guid reportNo3DefId = new Guid("{9118D82A-2AB4-40F2-A3BC-0BB54D34F3CE}");//Социальное пособие  (ЕСП)
            static Guid reportNo3ItemDefId = new Guid("{54167C45-6382-460E-8D72-CDE7D7B43F5C}");//Rows Социальное пособие  (ЕСП)

            static Guid reportNo4DefId = new Guid("{9580E9AE-5949-4B83-90F0-EED511B63477}");//ДЕСП
            static Guid reportNo4ItemDefId = new Guid("{D2FCA75E-34E4-4E85-93B5-6917C4F18BC2}");//Rows ДЕСП

            private static readonly Guid BenefitPaymentId0 = new Guid("{330FA388-7596-4D4B-903B-33D4D069707D}");   // Уй-булого комок от 0 до 16 лет
            private static readonly Guid BenefitPaymentId1 = new Guid("{7F1B9709-8F99-473F-9AE0-2DDCD74BDE6E}");   // * Пособие матерям родившим двойню до достижения 3-лет
            private static readonly Guid BenefitPaymentId2 = new Guid("{9BC8A898-31F8-4F55-8C14-28F641142370}");   // * ЕПМС на ребенка до 3-х лет
            private static readonly Guid BenefitPaymentId3 = new Guid("{64ACC17D-78B8-492E-AC81-7B1E4750F53A}");   // * ЕПМС матерям родившим тройню и более до достижения 16-лет
            private static readonly Guid BenefitPaymentId4 = new Guid("{D24151CF-C8B0-4851-B0EC-6D6EB382DC61}"); //* ЕПМС семьям по малообеспеченности
            private static readonly Guid BenefitPaymentId5 = new Guid("{BCE5B287-7495-4AD1-96A8-F52040A4CABF}"); //*ЕПМС малоимущим (опекаемым, сиротам) 
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден
            private static readonly Guid oktybrOrgId = new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"); //Октябрьский район для ЕПМС

            public static List<GeneralReportItem> Execute(WorkflowContext context, int year, int month)
            {
                List<GeneralReportItem> reportItems = new List<GeneralReportItem>();
                for (int i = 1; i < 4; i++)
                {
                    QueryBuilder qb = new QueryBuilder(reportNo1DefId, context.UserId);
                    SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                    SqlQuerySource itemSrc = query.Source;

                    switch (i)
                    {
                        case 1:
                            {
                                qb = new QueryBuilder(reportNo1DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo1ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                query.AddCondition(ExpressionOperation.And, reportNo1ItemDefId, "PaymentType", ConditionOperation.Equal, BenefitPaymentId0);
                                break;
                            }
                        case 2:
                            {
                                qb = new QueryBuilder(reportNo2DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month).And("&OrgId").Eq(oktybrOrgId);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo2ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                query.AddCondition(ExpressionOperation.And, reportNo2ItemDefId, "PaymentType", ConditionOperation.In, new object[] { BenefitPaymentId4, BenefitPaymentId3 });
                                break;
                            }
                        case 3:
                            {
                                qb = new QueryBuilder(reportNo3DefId, context.UserId);
                                qb.Where("&State").Eq(approvedStateId).And("Year").Eq(year).And("Month").Eq(month);
                                query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                                itemSrc = query.JoinSource(query.Source, reportNo3ItemDefId, SqlSourceJoinType.Inner, "Rows");
                                break;
                            }
                    }

                    query.AddAttribute("&OrgId");
                    query.AddAttribute(itemSrc, "PostSection2AppCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "PostSection2DocCount", SqlQuerySummaryFunction.Sum);

                    query.AddAttribute(itemSrc, "BankSection2AppCount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2NeedAmount", SqlQuerySummaryFunction.Sum);
                    query.AddAttribute(itemSrc, "BankSection2DocCount", SqlQuerySummaryFunction.Sum);
                    query.AddGroupAttribute("&OrgId");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var postSection2AppCount = row[1] is DBNull ? 0 : (int)row[1];
                        var postSection2NeedAmount = row[2] is DBNull ? 0m : (decimal)row[2];
                        var postSection2DocCount = row[3] is DBNull ? 0 : (int)row[3];

                        var bankSection2AppCount = row[4] is DBNull ? 0 : (int)row[4];
                        var bankSection2NeedAmount = row[5] is DBNull ? 0m : (decimal)row[5];
                        var bankSection2DocCount = row[6] is DBNull ? 0 : (int)row[6];

                        var orgName = context.Orgs.GetOrgName(orgId);
                        var item = GetReportItem(reportItems, orgName, orgId);
                        switch (i)
                        {
                            case 1:
                                {
                                    item.ubkPayment.Section2AppCount = postSection2AppCount + bankSection2AppCount;
                                    item.ubkPayment.AverageNeedAmount = postSection2NeedAmount + bankSection2NeedAmount;
                                    item.ubkPayment.Section2DocCount = postSection2DocCount + bankSection2DocCount;
                                    item.NeedAmountFromBeginOfYear += item.ubkPayment.AverageNeedAmount;
                                    break;
                                }
                            case 2:
                                {
                                    item.lifMonthlyGrant.Section2AppCount = postSection2AppCount + bankSection2AppCount;
                                    item.lifMonthlyGrant.AverageNeedAmount = postSection2NeedAmount + bankSection2NeedAmount;
                                    item.lifMonthlyGrant.Section2DocCount = postSection2DocCount + bankSection2DocCount;
                                    item.NeedAmountFromBeginOfYear += item.lifMonthlyGrant.AverageNeedAmount;
                                    break;
                                }
                            case 3:
                                {
                                    item.monthlyGrant.Section2AppCount = postSection2AppCount + bankSection2AppCount;
                                    item.monthlyGrant.AverageNeedAmount = postSection2NeedAmount + bankSection2NeedAmount;
                                    item.monthlyGrant.Section2DocCount = postSection2DocCount + bankSection2DocCount;
                                    item.NeedAmountFromBeginOfYear += item.monthlyGrant.AverageNeedAmount;
                                    break;
                                }
                        }
                    }
                }

                foreach (var item in reportItems)
                {
                    if (item.ubkPayment.Section2AppCount > 0) item.ubkPayment.AverageNeedAmount = Math.Round(item.ubkPayment.AverageNeedAmount / item.ubkPayment.Section2AppCount, 1);
                    if (item.lifMonthlyGrant.Section2AppCount > 0) item.lifMonthlyGrant.AverageNeedAmount = Math.Round(item.lifMonthlyGrant.AverageNeedAmount / item.lifMonthlyGrant.Section2AppCount, 1);
                    if (item.monthlyGrant.Section2AppCount > 0) item.monthlyGrant.AverageNeedAmount = Math.Round(item.monthlyGrant.AverageNeedAmount / item.monthlyGrant.Section2AppCount, 1);

                    if (bishkekList.Contains(item.getOrgId())) item.ParentRegion = "г.Бишкек";
                    if (chuiList.Contains(item.getOrgId())) item.ParentRegion = "Чуйская область";
                    if (talasList.Contains(item.getOrgId())) item.ParentRegion = "Таласская область";
                    if (issyk_kulList.Contains(item.getOrgId())) item.ParentRegion = "Иссык-Кульская область";
                    if (narynList.Contains(item.getOrgId())) item.ParentRegion = "Нарынская область";
                    if (batkenList.Contains(item.getOrgId())) item.ParentRegion = "Баткенская область";
                    if (oshList.Contains(item.getOrgId())) item.ParentRegion = "Ошская область";
                    if (osh.Contains(item.getOrgId())) item.ParentRegion = "г.Ош";
                    if (jalal_abad.Contains(item.getOrgId())) item.ParentRegion = "Джалал-Абадская область";
                }

                return reportItems;
            }

            static GeneralReportItem GetReportItem(List<GeneralReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new GeneralReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class GeneralReportItem
            {
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public string ParentRegion { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                public ReportItem ubkPayment { get; set; }
                [DataMember]
                public ReportItem lifMonthlyGrant { get; set; } //ЕПМС
                [DataMember]
                public ReportItem monthlyGrant { get; set; }//ЕПС
                [DataMember]
                public decimal NeedAmountFromBeginOfYear { get; set; }// пока сделаем сумму 3х выплат до выяснения
                public GeneralReportItem(Guid orgId)
                {
                    OrgId = orgId;
                    ubkPayment = new ReportItem("Уй булого комок");
                    lifMonthlyGrant = new ReportItem("ЕПМС");
                    monthlyGrant = new ReportItem("ЕСП");
                }
                public Guid getOrgId()
                {
                    return OrgId;
                }
            }

            [DataContract]
            public class ReportItem
            {
                public ReportItem(string paymentName)
                {
                    PaymentName = paymentName;
                }
                [DataMember]
                public string PaymentName { get; set; }
                [DataMember]
                public int Section2DocCount { get; set; }
                [DataMember]
                public int Section2AppCount { get; set; }
                [DataMember]
                public decimal AverageNeedAmount { get; set; }

            }

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
        }

        /*******************************************************************************************************************/
        public static class Report_2007 //active code
        {
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}"); //Банковский счет
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}"); //Почтовое поручения
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid payDESPTypeId = new Guid("{272F8D91-5B4B-42AC-9D79-A17E77F5496E}"); //ДЕСП участникам событий 2010 года
            private static readonly Guid assignDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначения
            private static readonly Guid canceledStateId = new Guid("{C65E63CC-54E9-424E-AFDC-5A8DB1CB04A3}"); // Аннулирован
            private static readonly Guid onApprovingStateId = new Guid("{5CD9E88D-671E-4A44-AD92-9F74DA3B47F7}"); //На утверждении     
            private static readonly Guid section2TypeId = new Guid("{0B6C58B1-A6F1-4455-8092-9B8583ADA295}");

            private static readonly Guid paymentCategoryId1 = new Guid("{608F740E-C44B-4305-88E8-F53D497214C0}"); //Дети погибшего в событиях 2010 г. до 18 лет
            private static readonly Guid paymentCategoryId2 = new Guid("{238BD896-A3B7-494D-B549-4AAC292EE8F5}"); //Родители погибшего ед. ребенка в событиях 2010 г. по достижении пенсионного возраста
            private static readonly Guid paymentCategoryId3 = new Guid("{ECDF4DE6-299E-4C6A-843F-49362C32EB96}"); //Получившие вред здоровью в событиях 2010 г., имеющие заключение СМЭ
            private static readonly Guid paymentCategoryId4 = new Guid("{7D08F570-239D-46BF-BF4F-6E3A510ACCD2}"); //Признанные ЛОВЗ в следствие событий 2010 г.

            private static readonly Guid reportDefId = new Guid("{9580E9AE-5949-4B83-90F0-EED511B63477}"); //Заявка на финансирование ДЕСП
            private static readonly Guid reportItemDefId = new Guid("{D2FCA75E-34E4-4E85-93B5-6917C4F18BC2}");  //Строки заявки ДЕСП

            private static readonly Guid categoryType1Id = new Guid("{608F740E-C44B-4305-88E8-F53D497214C0}");//Дети погибшего в событиях 2010 г. до 18 лет
            private static readonly Guid categoryType2Id = new Guid("{238BD896-A3B7-494D-B549-4AAC292EE8F5}");//Родители погибшего ед. ребенка в событиях 2010 г. по достижении пенсионного возраста
            private static readonly Guid categoryType3Id = new Guid("{ECDF4DE6-299E-4C6A-843F-49362C32EB96}");//Получившие вред здоровью в событиях 2010 г., имеющие заключение СМЭ
            private static readonly Guid categoryType4Id = new Guid("{7D08F570-239D-46BF-BF4F-6E3A510ACCD2}");//Признанные ЛОВЗ в следствие событий 2010 г.
            private static readonly List<object> categoryTypes = new List<object>
            {
                categoryType1Id, categoryType2Id, categoryType3Id, categoryType4Id
            };

            private static readonly Guid appStateId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Дела (на выплате)
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                SqlQuery query = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderSrc = query.JoinSource(query.Source, postOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appSrc = query.JoinSource(orderSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignSrc = query.JoinSource(appSrc, assignDefId, SqlSourceJoinType.Inner, "Assignments");
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                query.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                {
                    canceledStateId, onApprovingStateId
                });
                query.AddCondition(ExpressionOperation.And, postOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, payDESPTypeId);
                query.AddCondition(ExpressionOperation.And, appDefId, "PaymentCategory", ConditionOperation.In, new object[]
                {
                    paymentCategoryId1, paymentCategoryId2, paymentCategoryId3, paymentCategoryId4
                });

                query.AddAttribute(query.Source, "&OrgId");
                query.AddAttribute(appSrc, "Category");
                query.AddAttribute(appSrc, "DESPCategory");
                query.AddAttribute(appSrc, "RegNo");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var category = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var despCat = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var regNo = row[3] is DBNull ? "---" : (string)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (category != Guid.Empty && despCat != Guid.Empty)
                    {
                        if (category == categoryType1Id || category == categoryType3Id || category == categoryType4Id || category == categoryType2Id)
                        {
                            rayon.gr2++;
                        }
                        if (category == categoryType1Id)
                        {
                            rayon.gr3++;
                        }
                        if (category == categoryType3Id || category == categoryType4Id)
                        {
                            rayon.gr4++;
                            //rayon.gr16 += regNo + "; ";
                        }
                        if (category == categoryType2Id) rayon.gr5++;

                        if (despCat.Equals(new Guid("{F3083EEC-AB52-41DF-998B-23C6EDD77BCE}"))) //апрель
                        {
                            if (category == categoryType1Id) rayon.gr6++;
                            if (category == categoryType3Id || category == categoryType4Id) rayon.gr7++;
                            if (category == categoryType2Id) rayon.gr8++;
                        }
                        if (despCat.Equals(new Guid("{73A04E8F-215F-442E-8398-FCCC84A2073F}"))) //май
                        {
                            if (category == categoryType1Id) rayon.gr9++;
                            if (category == categoryType3Id || category == categoryType4Id) rayon.gr10++;
                            if (category == categoryType2Id) rayon.gr11++;
                        }
                        if (despCat.Equals(new Guid("{21E6E0FF-EAA7-4EC4-97C1-D30BC758E7EF}"))) //июнь
                        {
                            if (category == categoryType1Id) rayon.gr12++;
                            if (category == categoryType3Id || category == categoryType4Id) rayon.gr13++;
                            if (category == categoryType2Id) rayon.gr14++;
                        }
                    }
                    rayon.gr15 = GetAmount(context, orgId);
                }
                SqlQuery queryBank = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderBankSrc = queryBank.JoinSource(queryBank.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appBankSrc = queryBank.JoinSource(orderBankSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignBankSrc = queryBank.JoinSource(appBankSrc, assignDefId, SqlSourceJoinType.Inner, "Assignments");
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Section", ConditionOperation.Equal, section2TypeId);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.NotIn, new object[]
                {
                    canceledStateId, onApprovingStateId
                });
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "PaymentType", ConditionOperation.Equal, payDESPTypeId);
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "PaymentCategory", ConditionOperation.In, new object[]
                {
                    paymentCategoryId1, paymentCategoryId2, paymentCategoryId3, paymentCategoryId4
                });

                queryBank.AddAttribute(queryBank.Source, "&OrgId");
                queryBank.AddAttribute(appBankSrc, "Category");
                queryBank.AddAttribute(appBankSrc, "DESPCategory");
                queryBank.AddAttribute(appBankSrc, "RegNo");

                table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, queryBank))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var category = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var despCat = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var regNo = row[3] is DBNull ? "---" : (string)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (category != Guid.Empty && despCat != Guid.Empty)
                    {
                        if (category == categoryType1Id || category == categoryType3Id || category == categoryType4Id || category == categoryType2Id)
                        {
                            rayon.gr2++;
                        }
                        if (category == categoryType1Id)
                        {
                            rayon.gr3++;
                        }
                        if (category == categoryType3Id || category == categoryType4Id)
                        {
                            rayon.gr4++;
                            //rayon.gr16 += regNo + "; ";
                        }
                        if (category == categoryType2Id) rayon.gr5++;

                        if (despCat.Equals(new Guid("{F3083EEC-AB52-41DF-998B-23C6EDD77BCE}"))) //апрель
                        {
                            if (category == categoryType1Id) rayon.gr6++;
                            if (category == categoryType3Id || category == categoryType4Id) rayon.gr7++;
                            if (category == categoryType2Id) rayon.gr8++;
                        }
                        if (despCat.Equals(new Guid("{73A04E8F-215F-442E-8398-FCCC84A2073F}"))) //май
                        {
                            if (category == categoryType1Id) rayon.gr9++;
                            if (category == categoryType3Id || category == categoryType4Id) rayon.gr10++;
                            if (category == categoryType2Id) rayon.gr11++;
                        }
                        if (despCat.Equals(new Guid("{21E6E0FF-EAA7-4EC4-97C1-D30BC758E7EF}"))) //июнь
                        {
                            if (category == categoryType1Id) rayon.gr12++;
                            if (category == categoryType3Id || category == categoryType4Id) rayon.gr13++;
                            if (category == categoryType2Id) rayon.gr14++;
                        }
                    }
                    rayon.gr15 = GetAmount(context, orgId);
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }
            private static decimal GetAmount(WorkflowContext context, Guid orgId)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("&State").Eq(approvedStateId).And("Year").Eq(year);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "NeedAmount", SqlQuerySummaryFunction.Sum);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                    return 0m;
                }
            }
            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public int gr2 { get; set; }
                [DataMember]
                public int gr3 { get; set; }
                [DataMember]
                public int gr4 { get; set; }
                [DataMember]
                public int gr5 { get; set; }
                [DataMember]
                public int gr6 { get; set; }
                [DataMember]
                public int gr7 { get; set; }
                [DataMember]
                public int gr8 { get; set; }
                [DataMember]
                public int gr9 { get; set; }
                [DataMember]
                public int gr10 { get; set; }
                [DataMember]
                public int gr11 { get; set; }
                [DataMember]
                public int gr12 { get; set; }
                [DataMember]
                public int gr13 { get; set; }
                [DataMember]
                public int gr14 { get; set; }
                [DataMember]
                public decimal gr15 { get; set; }
                [DataMember]
                public string gr16 { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_3021
        {
            private static readonly Guid wardDefId = new Guid("{B9B0D237-CA2F-41A2-BC26-D1C83CE3907E}");//личное дело подопечного лица
            private static readonly Guid petitionDefId = new Guid("{DA483480-F25E-45F0-AA14-9BE84EA4F191}");//ходатайство
            private static readonly Guid inquestReportDefId = new Guid("{6336F60D-7AC6-458A-A036-30D343B2710C}");//акт обследования
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");//физ-лицо
            private static readonly Guid[] disabilityGroups = new Guid[]
            {
            new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"),
            new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"),
            new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"),
            new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}")
            };//группы инв-сти
            private static readonly Guid pensionerCategoryEnumId = new Guid("{A65EF9CE-546A-4A90-8657-3B0F51EB58A1}");//категория пенсионер
            private static readonly Guid maleEnumId = new Guid("{C3DCB977-2781-418A-BB96-12FE7F3F041B}");
            private static readonly Guid femaleEnumId = new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}");
            private static readonly Guid capacityDefId = new Guid("{C4D28CDA-596A-4456-ACCD-7109C04B65EB}");
            private static readonly Guid activeStateTypeId = new Guid("{3996D610-EDF4-44CD-BC34-AAA01882FC76}");//статус на попечениив ССУ
                                                                                                                // States
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}"); // Утвержден

            public static List<ReportItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportItem>();
                CalcItems(context, fd, ld, items);
                return items;
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, DateTime fd, DateTime ld, List<ReportItem> items)
            {
                var qb = new QueryBuilder(wardDefId, context.UserId);
                qb.Where("&State").Eq(activeStateTypeId);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var petitionSrc = query.JoinSource(query.Source, petitionDefId, SqlSourceJoinType.Inner, "Petition");
                var irSrc = query.JoinSource(petitionSrc, inquestReportDefId, SqlSourceJoinType.Inner, "InquestReport");
                var personSrc = query.JoinSource(irSrc, personDefId, SqlSourceJoinType.Inner, "Applicant");
                query.AddAttribute(query.Source, "&Id", SqlQuerySummaryFunction.Count);
                var orgAttr = query.AddAttribute(query.Source, "&OrgId");
                var genderAttr = query.AddAttribute(personSrc, "Sex");
                var disAttr = query.AddAttribute(irSrc, "Disability");
                var catAttr = query.AddAttribute(irSrc, "Category");
                query.AddGroupAttribute(orgAttr);
                query.AddGroupAttribute(genderAttr);
                query.AddGroupAttribute(disAttr);
                query.AddGroupAttribute(catAttr);

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }

                foreach (DataRow row in table.Rows)
                {
                    int count = row[0] is DBNull ? 0 : (int)row[0];
                    var orgId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    if (orgId == Guid.Empty) continue;
                    var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var disabilityGroupId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var catId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    if (orgId == Guid.Empty) continue;
                    var item = GetReportItem(items, orgId);

                    item.OrgName = context.Orgs.GetOrgName(orgId);
                    item.gr1 = GetCapacity(context, item.OrgId, DateTime.Today, DateTime.Today);
                    item.gr2 += count;

                    if (gender == maleEnumId) item.gr3 += count;
                    else if (gender == femaleEnumId) item.gr4 += count;

                    if (disabilityGroups.Contains(disabilityGroupId)) item.gr5 += count;

                    if (catId == pensionerCategoryEnumId) item.gr6 += count;
                }
                return items;
            }
            private static int GetCapacity(WorkflowContext context, Guid orgId, DateTime fd, DateTime ld)
            {
                var qb = new QueryBuilder(capacityDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("DateFrom").Le(ld).And("DateTo").Ge(fd);
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("Capacity");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                    if (reader.Read()) return !reader.IsDbNull(0) ? reader.GetInt32(0) : 0;
                return 0;
            }
            static ReportItem GetReportItem(List<ReportItem> items, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgId == orgId);
                if (item != null) return item;
                item = new ReportItem
                {
                    OrgId = orgId,
                    RowNo = items.Count > 0 ? (items.Max(x => x.RowNo) + 1) : 1
                };
                items.Add(item);
                return item;
            }
            public class ReportItem
            {
                public Guid OrgId { get; set; }
                public string OrgName { get; set; }
                public int RowNo { get; set; }
                public int gr1 { get; set; }
                public int gr2 { get; set; }
                public int gr3 { get; set; }
                public int gr4 { get; set; }
                public int gr5 { get; set; }
                public int gr6 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class PatientCountOfMonth_6001
        {
            public static List<ReportItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Переходящие с предыдущей недели/месяца",
                    "Сопровождающие (переходящие с предыдущей недели/месяца)",
                    "Находились в стационаре",
                    "Всего проведено койко дней",
                    "Из них ЛОВЗ всего",
                    "Проведено ЛОВЗ койко дней",
                    "Сопровождающие",
                    "Койко дней сопровождающих",
                    "Госпитализ на протез и реабил. всего",
                    "Койко-дней на реабилитацию с протезированием",
                    "Госпитализ на реабилитацию всего",
                    "Койка-дни на реабилитацию",
                    "Первичное протезирование и реабилитация",
                    "Первичная реабилитация",
                    "ИПР",
                    "За отчетный период поступили всего",
                    "Сопровождающие",
                    "Дети с ОВЗ",
                    "ЛОВЗ I группы",
                    "ЛОВЗ III группы",
                    "ЛОВЗ II группы",
                    "Медикаментозная реабилитация",
                    "Проведено физиопроцедур",
                    "Парафинотерапия",
                    "Перевязок",
                    "Массаж",
                    "Проведено ЛФК",
                    "Оказано стом. помощь",
                    "Проведено зубопротезирований",
                    "Медико-техническая реабилитация",
                    "Психологическая реабилитация",
                    "ЭКГ",
                    "УЗДГ",
                    "УЗИ",
                    "Обучение базовым знаниям ПК",
                    "Обучение мелкому ремонту обуви",
                    "Обучение шитью на шв. машинке и бисероплет. и.т.п.",
                    "Поступили по направлению мед.отдела/РУПОИ",
                    "Поступили по направлению МСЭ",
                    "Поступили по направлению ЦСМ/ГСВ",
                    "Поступили по направлению ССУ",
                    "Выписано ЛОВЗ за отчетный период",
                    "Выписано сопровождающих",
                    "Хороший результат",
                    "Удовлетворительный результат",
                    "Без изменений",
                    "Чуйская область",
                    "Иссык-Кульская область",
                    "Таласская область",
                    "Нарынская область",
                    "Жалал-Абадская область",
                    "Ошская область",
                    "Баткенская область",
                    "г. Каракол",
                    "г. Балыкчы",
                    "г. Чолпон-Ата",
                    "г. Кербен",
                    "г. Кочкор-Ата",
                    "г. Кок-Жангак",
                    "г. Токтогул",
                    "г. Джалал-Абад",
                    "г. Таш-Кумыр",
                    "Кызыл-Джар",
                    "г. Шамалды-Сай",
                    "г.  Майлуу-Суу",
                    "Кек-Таш",
                    "Кара-Куль",
                    "Кетмен-Тебе",
                    "г. Нарын",
                    "г. Талас",
                    "г. Баткен",
                    "г. Исфана",
                    "Айдаркен",
                    "Ортотокой",
                    "Кадамжай",
                    "Сулюкта",
                    "Восточный",
                    "Кызыл-Кия",
                    "Кара-Суу",
                    "Ноокат",
                    "Узген",
                    "Кант",
                    "Кара-Балта",
                    "Орловка",
                    "Кемин",
                    "Бордунский",
                    "Каинды",
                    "Шопоков",
                    "Токмок",
                    "г. Ош",
                    "Акталинский район",
                    "Атбашинский район",
                    "Нарынский район",
                    "Жумгальский район",
                    "Кочкорский район",
                    "Аксуйский район",
                    "Джети-Огузский район",
                    "Иссык-Кульский район",
                    "Тонский район",
                    "Тюпский район",
                    "Алабукинский район",
                    "Базар-Коргонский район",
                    "Аксыйский район",
                    "Ноокенский район",
                    "Сузакский район",
                    "Тогуз-Тороуский район",
                    "Токтогульский район",
                    "Чаткальский район",
                    "Баткенский район",
                    "Лейлекский район",
                    "Кадамжайский район",
                    "Алайский район",
                    "Араванский район",
                    "Карасуйский район",
                    "Ноокатский район",
                    "Кара-Кульджинский район",
                    "Узгенский район",
                    "Чоналайский район",
                    "Карабууринский район",
                    "Бакай-Атинский район",
                    "Манасский район",
                    "Таласский район",
                    "Аламудунский район",
                    "Ысык-Атинский район",
                    "Жайылский район",
                    "Кеминский район",
                    "Московский район",
                    "Панфиловский район",
                    "Сокулукский район",
                    "Чуйский район",
                    "Ленинский район",
                    "Первомайский район",
                    "Свердловский район",
                    "Октябрьский район"
                };
                var items = new List<ReportItem>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportItem();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, orgId, fd, ld,
                    items[133], items[132], items[131], items[130], items[129], items[128], items[127], items[126], items[125],
                    items[124], items[123], items[122], items[121], items[120], items[119], items[118], items[117], items[116], items[115],
                    items[114], items[113], items[112], items[111], items[110], items[109], items[108], items[107], items[106], items[105], items[104],
                    items[103], items[102], items[101], items[100], items[99], items[98], items[97], items[96], items[95], items[94], items[93], items[92],
                    items[91], items[90], items[89], items[88], items[87], items[86], items[85], items[84], items[83], items[82], items[81], items[80],
                    items[79], items[78], items[77], items[76], items[75], items[74], items[73], items[72], items[71], items[70], items[69], items[68],
                    items[67], items[66], items[65], items[64], items[63], items[62], items[61], items[60], items[59], items[58], items[57], items[56],
                    items[55], items[54], items[53], items[52], items[51], items[50], items[49], items[48], items[47], items[46], items[45], items[44],
                    items[43], items[42], items[41], items[40], items[39], items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25], items[24], items[23], items[22], items[21], items[20],
                    items[19], items[18], items[17], items[16], items[15], items[14], items[13], items[12], items[11], items[10], items[9], items[8],
                    items[7], items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, Guid orgId, DateTime fd, DateTime ld,
               ReportItem item133, ReportItem item132, ReportItem item131, ReportItem item130, ReportItem item129, ReportItem item128, ReportItem item127,
               ReportItem item126, ReportItem item125, ReportItem item124, ReportItem item123, ReportItem item122, ReportItem item121, ReportItem item120,
               ReportItem item119, ReportItem item118, ReportItem item117, ReportItem item116, ReportItem item115, ReportItem item114, ReportItem item113,
               ReportItem item112, ReportItem item111, ReportItem item110, ReportItem item109, ReportItem item108, ReportItem item107, ReportItem item106,
               ReportItem item105, ReportItem item104, ReportItem item103, ReportItem item102, ReportItem item101, ReportItem item100, ReportItem item99,
               ReportItem item98, ReportItem item97, ReportItem item96, ReportItem item95, ReportItem item94, ReportItem item93, ReportItem item92,
               ReportItem item91, ReportItem item90, ReportItem item89, ReportItem item88, ReportItem item87, ReportItem item86, ReportItem item85,
               ReportItem item84, ReportItem item83, ReportItem item82, ReportItem item81, ReportItem item80, ReportItem item79, ReportItem item78,
               ReportItem item77, ReportItem item76, ReportItem item75, ReportItem item74, ReportItem item73, ReportItem item72, ReportItem item71,
               ReportItem item70, ReportItem item69, ReportItem item68, ReportItem item67, ReportItem item66, ReportItem item65, ReportItem item64,
               ReportItem item63, ReportItem item62, ReportItem item61, ReportItem item60, ReportItem item59, ReportItem item58, ReportItem item57,
               ReportItem item56, ReportItem item55, ReportItem item54, ReportItem item53, ReportItem item52, ReportItem item51, ReportItem item50,
               ReportItem item49, ReportItem item48, ReportItem item47, ReportItem item46, ReportItem item45, ReportItem item44, ReportItem item43,
               ReportItem item42, ReportItem item41, ReportItem item40, ReportItem item39, ReportItem item38, ReportItem item37, ReportItem item36,
               ReportItem item35, ReportItem item34, ReportItem item33, ReportItem item32, ReportItem item31, ReportItem item30, ReportItem item29,
               ReportItem item28, ReportItem item27, ReportItem item26, ReportItem item25, ReportItem item24, ReportItem item23, ReportItem item22,
               ReportItem item21, ReportItem item20, ReportItem item19, ReportItem item18, ReportItem item17, ReportItem item16, ReportItem item15,
               ReportItem item14, ReportItem item13, ReportItem item12, ReportItem item11, ReportItem item10, ReportItem item9, ReportItem item8,
               ReportItem item7, ReportItem item6, ReportItem item5, ReportItem item4, ReportItem item3, ReportItem item2, ReportItem item1, ReportItem item0)
            {
                var qb = new QueryBuilder(statCartDefId, context.UserId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddCondition(ExpressionOperation.And, statCartDefId, "&OrgId", ConditionOperation.Equal, orgId);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "Obl");
                    query.AddAttribute(query.Source, "Rag");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var cardId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var area = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var district = row[2] is DBNull ? Guid.Empty : (Guid)row[2];

                        if (cardId != Guid.Empty)
                        {
                            if (area != Guid.Empty)
                            {
                                if ((area.Equals(new Guid("{0504E82A-7468-4DAF-BCA1-F31163241C02}"))) || (area.Equals(new Guid("{FCB6DB01-469E-4254-9BB6-E3409057A779}"))))
                                    item46.gr1 = item46.gr1 != string.Empty ? (Convert.ToInt32(item46.gr1) + 1).ToString() : "1";
                                if (area.Equals(new Guid("{4386D93C-2DF6-4F99-A438-55C20447FD24}")))
                                    item47.gr1 = item47.gr1 != string.Empty ? (Convert.ToInt32(item47.gr1) + 1).ToString() : "1";
                                if (area.Equals(new Guid("{F2662FF6-FFA7-4707-8284-3FB52436C1F1}")))
                                    item48.gr1 = item48.gr1 != string.Empty ? (Convert.ToInt32(item48.gr1) + 1).ToString() : "1";
                                if (area.Equals(new Guid("{591191B0-7827-4C47-AC47-FB03C685E911}")))
                                    item49.gr1 = item49.gr1 != string.Empty ? (Convert.ToInt32(item49.gr1) + 1).ToString() : "1";
                                if (area.Equals(new Guid("{65C856CD-69E5-4CA4-BB8C-8F382AE659E8}")))
                                    item50.gr1 = item50.gr1 != string.Empty ? (Convert.ToInt32(item50.gr1) + 1).ToString() : "1";
                                if ((area.Equals(new Guid("{92267258-B11F-4B11-B781-2953F9E064A7}"))) || (area.Equals(new Guid("{D1067965-ACC3-4C43-9CA3-DC50C0E4D128}"))))
                                    item51.gr1 = item51.gr1 != string.Empty ? (Convert.ToInt32(item51.gr1) + 1).ToString() : "1";
                                if (area.Equals(new Guid("{4171C264-3F39-4B23-AAAC-B4282C68C6A6}")))
                                    item52.gr1 = item52.gr1 != string.Empty ? (Convert.ToInt32(item52.gr1) + 1).ToString() : "1";
                            }
                            if (district != Guid.Empty)
                            {
                                if (district.Equals(new Guid("{79AAD00B-DC3A-4247-BCF7-CDE467B96E4F}"))) item53.gr1 = item53.gr1 != string.Empty ? (Convert.ToInt32(item53.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{F3D9FBB2-D7CF-4CF9-B085-7D0793B37370}"))) item54.gr1 = item54.gr1 != string.Empty ? (Convert.ToInt32(item54.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{6674AFF4-B55C-45E3-A487-249317B33DF4}"))) item55.gr1 = item55.gr1 != string.Empty ? (Convert.ToInt32(item55.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{CA401F89-C9F5-4CEF-A7CF-2A0FDFEDD5FF}"))) item56.gr1 = item56.gr1 != string.Empty ? (Convert.ToInt32(item56.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{729FD82B-B855-4925-BBA6-6D450889D3F9}"))) item57.gr1 = item57.gr1 != string.Empty ? (Convert.ToInt32(item57.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{42D826F0-4AAB-4F4F-B08D-191ADDF55743}"))) item58.gr1 = item58.gr1 != string.Empty ? (Convert.ToInt32(item58.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{5579EDE7-40E8-4092-A6CF-30D96803637C}"))) item59.gr1 = item59.gr1 != string.Empty ? (Convert.ToInt32(item59.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{C9F27576-91E7-4A99-856E-38BBA988AF22}"))) item60.gr1 = item60.gr1 != string.Empty ? (Convert.ToInt32(item60.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{767CB4C4-C05F-4229-8960-6604744FFF0F}"))) item61.gr1 = item61.gr1 != string.Empty ? (Convert.ToInt32(item61.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{D9E97D93-0CE2-421F-87A9-3FF1554D3BBC}"))) item62.gr1 = item62.gr1 != string.Empty ? (Convert.ToInt32(item62.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{7497BA2E-F5F0-4663-B337-2E8966D1A919}"))) item63.gr1 = item63.gr1 != string.Empty ? (Convert.ToInt32(item63.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{5208308E-2561-4CC2-8BB5-88584F615E71}"))) item64.gr1 = item64.gr1 != string.Empty ? (Convert.ToInt32(item64.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{03B2DB0C-12B7-44F8-AF9F-E51DA49F7D57}"))) item65.gr1 = item65.gr1 != string.Empty ? (Convert.ToInt32(item65.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{15895A37-560D-4AF0-A971-05EB7C19AD58}"))) item66.gr1 = item66.gr1 != string.Empty ? (Convert.ToInt32(item66.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{F8041D96-55D9-4840-B175-12CF10529AFF}"))) item67.gr1 = item67.gr1 != string.Empty ? (Convert.ToInt32(item67.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{8369FB92-2EB4-43E7-B9D1-AAD62A06D307}"))) item68.gr1 = item68.gr1 != string.Empty ? (Convert.ToInt32(item68.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{85706905-A4E4-4DED-973D-EC1C09776746}"))) item69.gr1 = item69.gr1 != string.Empty ? (Convert.ToInt32(item69.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{4DB17EAE-4381-4E0E-94CD-108E0F421E36}"))) item70.gr1 = item70.gr1 != string.Empty ? (Convert.ToInt32(item70.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{E28660FF-2877-472B-BA70-1A89F5E8A8E6}"))) item71.gr1 = item71.gr1 != string.Empty ? (Convert.ToInt32(item71.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{601E1AB1-FD5A-42DE-BE36-6FA265CE0C59}"))) item72.gr1 = item72.gr1 != string.Empty ? (Convert.ToInt32(item72.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{1E549247-6C19-4ED6-A013-E028B4EE0887}"))) item73.gr1 = item73.gr1 != string.Empty ? (Convert.ToInt32(item73.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{5C8C633B-125F-4CDF-902C-574CF78A6728}"))) item74.gr1 = item74.gr1 != string.Empty ? (Convert.ToInt32(item74.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{CB9A187F-4E16-41BC-A745-3DB9ADEB1B02}"))) item75.gr1 = item75.gr1 != string.Empty ? (Convert.ToInt32(item75.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{8B5C6DA6-4283-4D8B-AD37-153874EDF0AD}"))) item76.gr1 = item76.gr1 != string.Empty ? (Convert.ToInt32(item76.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{7D735007-FDB7-48EA-A9E8-988BE0D40C96}"))) item77.gr1 = item77.gr1 != string.Empty ? (Convert.ToInt32(item77.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{57FD5C59-1C04-478B-99AB-BB330DF8B2EE}"))) item78.gr1 = item78.gr1 != string.Empty ? (Convert.ToInt32(item78.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{8497A553-07EE-4146-86BA-ED714C8E2D2B}"))) item79.gr1 = item79.gr1 != string.Empty ? (Convert.ToInt32(item79.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{156E9D8B-008E-4A09-8142-96CEC1AEA1F7}"))) item80.gr1 = item80.gr1 != string.Empty ? (Convert.ToInt32(item80.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{5AC16B2B-9A3E-4797-9CDE-30C5B6875B2F}"))) item81.gr1 = item81.gr1 != string.Empty ? (Convert.ToInt32(item81.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{446AB760-4952-480A-A2C8-C6E55E530306}"))) item82.gr1 = item82.gr1 != string.Empty ? (Convert.ToInt32(item82.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{F523CE1A-E8AA-4C28-B54A-CDBB9FDA06EE}"))) item83.gr1 = item83.gr1 != string.Empty ? (Convert.ToInt32(item83.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{B83B35FC-8DE8-4531-A55B-2122B6927BB7}"))) item84.gr1 = item84.gr1 != string.Empty ? (Convert.ToInt32(item84.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{7241D184-10D5-44EA-9696-FB17CC54908D}"))) item85.gr1 = item85.gr1 != string.Empty ? (Convert.ToInt32(item85.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{0BB1ED87-390A-4E78-9C39-43548000050B}"))) item86.gr1 = item86.gr1 != string.Empty ? (Convert.ToInt32(item86.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{000A1444-070E-4E88-B721-A124286CDF52}"))) item87.gr1 = item87.gr1 != string.Empty ? (Convert.ToInt32(item87.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{C028DF94-6F08-427B-B7E3-144E288AC8DF}"))) item88.gr1 = item88.gr1 != string.Empty ? (Convert.ToInt32(item88.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{CDD62071-0103-4AEA-9716-F878A8EC794A}"))) item89.gr1 = item89.gr1 != string.Empty ? (Convert.ToInt32(item89.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{44AC559E-9176-471D-9625-B4F5A8D4C017}"))) item90.gr1 = item90.gr1 != string.Empty ? (Convert.ToInt32(item90.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{29DD2C55-E331-4BDF-BFFB-8BAF01CE38A4}"))) item91.gr1 = item91.gr1 != string.Empty ? (Convert.ToInt32(item91.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{7BB62C60-E8D6-4CA2-88A3-9449E5F15EE9}"))) item92.gr1 = item92.gr1 != string.Empty ? (Convert.ToInt32(item92.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{7EC8E15D-FADD-4973-8253-D7CE8A3F8B7A}"))) item93.gr1 = item93.gr1 != string.Empty ? (Convert.ToInt32(item93.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{3A94B34F-5924-471E-BAE8-D30AB49B1DE9}"))) item94.gr1 = item94.gr1 != string.Empty ? (Convert.ToInt32(item94.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{7C08DEDF-4C83-4ACE-BACB-87683D7FE9AA}"))) item95.gr1 = item95.gr1 != string.Empty ? (Convert.ToInt32(item95.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{DD00A50F-CB35-4080-AE7B-A5C26BE9C0A9}"))) item96.gr1 = item96.gr1 != string.Empty ? (Convert.ToInt32(item96.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{0DE01029-2BF3-4042-83DA-5633C397C2A2}"))) item97.gr1 = item97.gr1 != string.Empty ? (Convert.ToInt32(item97.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{940A7FA2-A4D6-401F-AF8A-8DD67DEA2295}"))) item98.gr1 = item98.gr1 != string.Empty ? (Convert.ToInt32(item98.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{2FF3A76E-F7C6-4F44-8F91-192B431A1106}"))) item99.gr1 = item99.gr1 != string.Empty ? (Convert.ToInt32(item99.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{C8F6A8BF-F51F-427A-AA53-EA7CD1B63C7C}"))) item100.gr1 = item100.gr1 != string.Empty ? (Convert.ToInt32(item100.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{04EB0012-E8E7-4DA6-9BA5-28ED0F8BBE69}"))) item101.gr1 = item101.gr1 != string.Empty ? (Convert.ToInt32(item101.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{0648E502-3EA2-4FD6-B505-78331D7F337D}"))) item102.gr1 = item102.gr1 != string.Empty ? (Convert.ToInt32(item102.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{61806A08-B216-497E-889F-C5FFB2DDF4F2}"))) item103.gr1 = item103.gr1 != string.Empty ? (Convert.ToInt32(item103.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{358379BD-F7CB-43BF-B0D5-3E4DF0EBC586}"))) item104.gr1 = item104.gr1 != string.Empty ? (Convert.ToInt32(item104.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{073217E4-BD96-4EA5-BC1B-777D2E248294}"))) item105.gr1 = item105.gr1 != string.Empty ? (Convert.ToInt32(item105.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{711DEA4C-C051-4B8E-AF89-143326DBDDCD}"))) item106.gr1 = item106.gr1 != string.Empty ? (Convert.ToInt32(item106.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{091A243B-2565-45D7-B02D-6FF2E2A02A1D}"))) item107.gr1 = item107.gr1 != string.Empty ? (Convert.ToInt32(item107.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{76BC0B28-12D5-4502-B072-3940D0949B7E}"))) item108.gr1 = item108.gr1 != string.Empty ? (Convert.ToInt32(item108.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{42C3CB7B-37CC-4D40-9BB3-2B30FBE07D0F}"))) item109.gr1 = item109.gr1 != string.Empty ? (Convert.ToInt32(item109.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{26202293-B601-4F4B-9142-FDDEFB8063E6}"))) item110.gr1 = item110.gr1 != string.Empty ? (Convert.ToInt32(item110.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{CDB05FCA-44EA-4713-99EC-9E1D80271FEE}"))) item111.gr1 = item111.gr1 != string.Empty ? (Convert.ToInt32(item111.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{E491CD42-EA35-417D-8C1B-59287BD2D8E8}"))) item112.gr1 = item112.gr1 != string.Empty ? (Convert.ToInt32(item112.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{F50FD5B9-16F3-45AC-BAEA-02640F02912B}"))) item113.gr1 = item113.gr1 != string.Empty ? (Convert.ToInt32(item113.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{FCB537D1-6726-40E2-B484-91CE9C698895}"))) item114.gr1 = item114.gr1 != string.Empty ? (Convert.ToInt32(item114.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{4E958C6E-E319-4211-B047-F56EB69EF4CC}"))) item115.gr1 = item115.gr1 != string.Empty ? (Convert.ToInt32(item115.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{CA7BCCC5-EEC2-4C1A-A1AB-39AC3913E296}"))) item116.gr1 = item116.gr1 != string.Empty ? (Convert.ToInt32(item116.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{FA27FF69-6B10-4A6C-8A5C-9E6447C5604B}"))) item117.gr1 = item117.gr1 != string.Empty ? (Convert.ToInt32(item117.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{2AB3580D-1B0E-4824-986D-A14D2AE6D281}"))) item118.gr1 = item118.gr1 != string.Empty ? (Convert.ToInt32(item118.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{8D9BC28D-3177-4663-8F26-1F6F5C7FCF42}"))) item119.gr1 = item119.gr1 != string.Empty ? (Convert.ToInt32(item119.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{D0865B0B-793D-438C-9D53-A71FF4D599F1}"))) item120.gr1 = item120.gr1 != string.Empty ? (Convert.ToInt32(item120.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{B1A29E3B-3F80-49DF-A94F-6F3F91165112}"))) item121.gr1 = item121.gr1 != string.Empty ? (Convert.ToInt32(item121.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{8DDDADBF-710E-4182-A912-C98604080BAF}"))) item122.gr1 = item122.gr1 != string.Empty ? (Convert.ToInt32(item122.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{4ED420A7-1561-417B-AC49-B0123A6A0E03}"))) item123.gr1 = item123.gr1 != string.Empty ? (Convert.ToInt32(item123.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{0E5917DA-8BFE-4E50-819D-065AF47B5CAD}"))) item124.gr1 = item124.gr1 != string.Empty ? (Convert.ToInt32(item124.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{609F1D57-023D-400F-B3FE-F8EE9D20BEB9}"))) item125.gr1 = item125.gr1 != string.Empty ? (Convert.ToInt32(item125.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{18988DC4-FFD1-4DA5-BB90-5738F3BA08BF}"))) item126.gr1 = item126.gr1 != string.Empty ? (Convert.ToInt32(item126.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{6C7FF2AC-5394-4F7F-A085-709A7D0DCB70}"))) item127.gr1 = item127.gr1 != string.Empty ? (Convert.ToInt32(item127.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{3642C666-F83E-43C2-9D6E-29C9E527E22A}"))) item128.gr1 = item128.gr1 != string.Empty ? (Convert.ToInt32(item128.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{80AD3EBC-43A3-43D3-85FB-3DE5C2DA5364}"))) item129.gr1 = item129.gr1 != string.Empty ? (Convert.ToInt32(item129.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{03C74B83-32EC-48AC-B4C8-E4EAF24D089B}"))) item130.gr1 = item130.gr1 != string.Empty ? (Convert.ToInt32(item130.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{3D17C5D9-315E-4D23-8352-3367C0FDAF88}"))) item131.gr1 = item131.gr1 != string.Empty ? (Convert.ToInt32(item131.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{09824519-A477-4901-AA1C-7C97BE816B9A}"))) item132.gr1 = item132.gr1 != string.Empty ? (Convert.ToInt32(item132.gr1) + 1).ToString() : "1";
                                if (district.Equals(new Guid("{DF466856-AB99-4C6B-99B8-A0172FED7964}"))) item133.gr1 = item133.gr1 != string.Empty ? (Convert.ToInt32(item133.gr1) + 1).ToString() : "1";
                            }
                        }
                    }
                }
            }
            private static readonly Guid statCartDefId = new Guid("{683B63E2-B0C6-470F-8A01-5D73AB145F8A}"); //стат карта.
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные
            public class ReportItem
            {
                public int rowNo { get; set; }
                public string rowName { get; set; }
                public string gr1 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_6002
        {
            public static List<ReportItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Ампутации конечностей всего",
                    "- вследствие облитерирующего атеросклероза",
                    "- сахарного диабета",
                    "- травмы конечностей",
                    "- врожденной аномалии развития конечностей",
                    "- онкологического заболевания",
                    "ДОА суставов",
                    "Ревматоидный артрит",
                    "Посттравматический ДОА",
                    "Врожденные аномалии развития конечностей",
                    "Хондродистрофия",
                    "Состояния после эндо протезирования",
                    "Последствия перенесенного полиомиелита ",
                    "ДЦП",
                    "Последствия перенесенных позвоночно-спинно-мозговых травм",
                    "Последствия перенесенных инсультов",
                    "Миопатии",
                    "Невриты, поли нейропатии",
                    "Итого"
                };
                var items = new List<ReportItem>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportItem();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, fd, ld, orgId, items[18], items[17], items[16], items[15],
                        items[14], items[13], items[12], items[11], items[10], items[9], items[8], items[7],
                        items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, DateTime fd, DateTime ld, Guid orgId,
                ReportItem item18, ReportItem item17, ReportItem item16, ReportItem item15,
                ReportItem item14, ReportItem item13, ReportItem item12, ReportItem item11, ReportItem item10,
                ReportItem item9, ReportItem item8, ReportItem item7, ReportItem item6, ReportItem item5,
                ReportItem item4, ReportItem item3, ReportItem item2, ReportItem item1, ReportItem item0)
            {
                var qb = new QueryBuilder(statCartDefId, context.UserId);
                qb.Where("DateOfReceipt").Ge(fd).And("DateOfReceipt").Le(ld).And("&State").Neq(new Guid("ca1157a0-fddf-4c90-9692-7cdb47ccc7c2"));
                //qb.Where("&State").Eq(approvedStateId);//.And("DateOfReceipt").Ge(fd).And("DateOfReceipt").Le(ld);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddCondition(ExpressionOperation.And, statCartDefId, "&OrgId", ConditionOperation.Equal, orgId);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "Nasalogy");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(context.DataContext, query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var nazalogi = row[1] is DBNull ? Guid.Empty : (Guid)row[1];

                        if (appId != Guid.Empty)
                        {
                            if ((nazalogi.Equals(new Guid("{7B777BFC-3B18-4A36-84FB-A6887DB3731C}"))) || (nazalogi.Equals(new Guid("{026D5094-86A9-4C10-AC9E-11998713415E}"))) ||
                               (nazalogi.Equals(new Guid("{D933D54F-2993-41E1-962C-600F87982224}"))) || (nazalogi.Equals(new Guid("{D6934D2E-420F-4ECF-990F-226DA2511470}"))) ||
                               (nazalogi.Equals(new Guid("{41E6A9E1-C860-43CC-8EEB-7DD30DE84797}"))))
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;

                                if (nazalogi.Equals(new Guid("{7B777BFC-3B18-4A36-84FB-A6887DB3731C}")))
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                if (nazalogi.Equals(new Guid("{026D5094-86A9-4C10-AC9E-11998713415E}")))
                                    item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                if (nazalogi.Equals(new Guid("{D933D54F-2993-41E1-962C-600F87982224}")))
                                    item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                if (nazalogi.Equals(new Guid("{D6934D2E-420F-4ECF-990F-226DA2511470}")))
                                    item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                if (nazalogi.Equals(new Guid("{41E6A9E1-C860-43CC-8EEB-7DD30DE84797}")))
                                    item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;
                            }

                            if (nazalogi.Equals(new Guid("{68D0F759-A993-4502-B326-BC6E1E93E9A5}")))
                                item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{234D0364-AECF-4666-9948-92F2A757591D}")))
                                item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{9BA8296F-7045-4631-97C6-ADAD9231730D}")))
                                item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{7778D0DC-FBCC-454A-9A7B-09980F43EF44}")))
                                item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{8EE12AC4-9B27-4E6C-8357-391EB999FC6F}")))
                                item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{B27D88F8-CF73-4134-941E-DBE8039055FB}")))
                                item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{B04D9D3D-463C-4DB0-B0AF-FA04377BDA80}")))
                                item12.gr1 = item12.gr1 != 0 ? (1 + (int)item12.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{4397C25E-8508-418B-B12A-CDDEC361CD72}")))
                                item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{C7AA33F6-9FEB-4784-857E-4F2F64DFC632}")))
                                item14.gr1 = item14.gr1 != 0 ? (1 + (int)item14.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{F27025B7-BBA7-4182-B0C9-ABB145AC6232}")))
                                item15.gr1 = item15.gr1 != 0 ? (1 + (int)item15.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{20DEADD2-95EB-44E7-BB56-325070E45EB3}")))
                                item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;
                            if (nazalogi.Equals(new Guid("{716F00DB-EAE3-493E-AB5D-2051BA779239}")))
                                item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;
                            if (nazalogi != Guid.Empty)
                                item18.gr1 += 1;
                        }
                    }
                }
            }
            private static readonly Guid statCartDefId = new Guid("{683B63E2-B0C6-470F-8A01-5D73AB145F8A}"); //стат карта.
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные
            public class ReportItem
            {
                public int rowNo { get; set; }
                public string rowName { get; set; }
                public int gr1 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_6003
        {
            public static List<ReportItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;
                var items = new List<ReportItem>();
                CalcItems(context, fd, ld, orgId, items);
                return items;
            }
            public static void CalcItems(WorkflowContext context, DateTime fd, DateTime ld, Guid orgId, List<ReportItem> items)
            {
                var qb = new QueryBuilder(statCartDefId, context.UserId);
                qb.Where("DateOfReceipt").Ge(fd).And("DateOfReceipt").Le(ld).And("&State").Neq(new Guid("ca1157a0-fddf-4c90-9692-7cdb47ccc7c2"));
                //qb.Where("&State").Eq(approvedStateId).And("DateOfReceipt").Ge(fd).And("DateOfReceipt").Le(ld);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Applicant");
                    query.AddCondition(ExpressionOperation.And, statCartDefId, "&OrgId", ConditionOperation.Equal, orgId);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(personSrc, "LastName");
                    query.AddAttribute(personSrc, "FirstName");
                    query.AddAttribute(personSrc, "MiddleName");
                    query.AddAttribute(personSrc, "BirthDate");
                    query.AddAttribute(query.Source, "GroupDisability");
                    query.AddAttribute(query.Source, "LocationLocation");
                    query.AddAttribute(query.Source, "Primary");
                    query.AddAttribute(query.Source, "Job");
                    query.AddAttribute(query.Source, "Post");

                    var table = new DataTable();
                    using (var reader = new SqlQueryReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    int i = 0;
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var lstName = row[1] is DBNull ? "" : row[1].ToString();
                        var fstName = row[2] is DBNull ? "" : row[2].ToString();
                        var mdlName = row[3] is DBNull ? "" : row[3].ToString();
                        var birthDate = row[4] is DBNull ? DateTime.MaxValue : (DateTime)row[4];
                        var group = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var addres = row[6] is DBNull ? "" : row[6].ToString();
                        var primary = row[7] is DBNull ? "" : row[7].ToString();
                        var job = row[8] is DBNull ? "" : row[8].ToString();
                        var post = row[9] is DBNull ? "" : row[9].ToString();

                        var item = new ReportItem();
                        i++;
                        if (appId != Guid.Empty)
                        {
                            item.gr1 += lstName + " " + fstName + " " + mdlName;
                            item.gr2 += birthDate.ToShortDateString();
                            if (group != Guid.Empty)
                            {
                                var groupName = context.Enums.GetValue(group).Value;
                                item.gr3 += groupName;
                            }
                            item.gr4 += addres;
                            item.gr5 += primary;
                            item.gr6 += job;
                            item.gr7 += post;
                            item.no = i;
                            items.Add(item);
                        }
                    }
                }
            }
            private static readonly Guid statCartDefId = new Guid("{683B63E2-B0C6-470F-8A01-5D73AB145F8A}"); //стат карта.
            private static readonly Guid personDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}"); //person
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные
            public class ReportItem
            {
                public int no { get; set; }
                public string gr1 { get; set; }
                public string gr2 { get; set; }
                public string gr3 { get; set; }
                public string gr4 { get; set; }
                public string gr5 { get; set; }
                public string gr6 { get; set; }
                public string gr7 { get; set; }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_F8SVOD
        {
            private static readonly Guid legalPregDefId = new Guid("{46C27FED-B9E0-4DAA-9DD4-F984A526D9B5}"); //Сведения о расходах по выплате пособий по беременности и родам            
            private static readonly Guid appPregancyDefId = new Guid("{379C813C-E5AF-4ACF-9D4D-7FF8AF40AEAE}"); //Заявление на назначение пособия по беременности и родом

            private static readonly Guid appRitualDefId = new Guid("{A7762DDE-ABB8-4A22-B942-33DB2C2C6E58}"); //Заявление на назначение ритуального пособия (на погребение)
            private static readonly Guid legalRitualDefId = new Guid("{89ADB43B-0D29-4287-AF5B-0E0DCED18B01}"); //Сведения о расходах по выплате ритуального пособия

            private static readonly Guid legalSectionDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid legalPersonDefId = new Guid("{61AF4CEA-D77A-4305-8F0A-81A001BE5CFD}"); //Юридическое лицо            
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек              
            {                                                            
                //  new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),            
                new Guid("{D4C5884F-1820-4DF5-9BF8-C48202ACB801}"),//первомайский                          
                new Guid("{20FF5245-DB58-443A-A31B-061200E939AA}"),//октябрь                 
                new Guid("{52315837-1B8F-4B80-9D8C-160214F4681A}"),//свердлово               
                new Guid("{E3BFB034-7638-4C14-8C0F-EA823CCA7A5B}")//ленин                                      
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                                                            
                // new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{30658F5A-DC22-4A7A-AAF6-63DFB7070C50}"),//чуй
                new Guid("{DC2174B4-479B-4F6F-9A9D-9BA28AB715CD}"),//аламудун
                new Guid("{7866D332-C471-4873-8F8B-6DA9EDC3683A}"),//ыссык-ата           
                new Guid("{C8641D03-B553-4F95-ADFB-EC002FD64E06}"),//москва
                new Guid("{19F7870D-4B5E-457A-B159-528F71374E1E}"),//жайыл                             
                new Guid("{093AFB08-3F18-4E5C-8EB6-86EF0DD711B9}"),//сокулук
                new Guid("{668D6957-1F76-49DE-B9AD-0F2C635DF2DD}"),//кемин                                    
                new Guid("{8B6510F7-3B6B-4C9D-B8A1-2349B78B2CF3}"),//город токмок
                new Guid("{5DF10BBC-D256-40F8-B641-5EF31CE11540}")//панфилов                                 
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                // new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{23DB562E-C0B7-4B7E-AC16-967C96500444}"),//балыкчы
                new Guid("{3277F73D-B02D-4F35-AD1A-80B349EECF6B}"),//тон
                new Guid("{C748CDB5-502A-4243-8494-48E224968019}"),//тюп                                                                         
                new Guid("{046FF80D-4D26-4E30-A41F-17873C0E2C8F}"),//жети-огуз  
                new Guid("{14EB7AEF-C331-4085-A83E-0F5EEBF2EAA3}"),//иссык-куль                                 
                new Guid("{1F892B98-97B4-4B58-B61F-7DFECBAC3B5E}"),//ак-суу
                new Guid("{AB27C82D-8348-4DBA-BA9C-CEAE3A67704E}")//каракол
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {                                                                                
                // new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{51C381F2-6AD6-4382-81F9-3D36E9ABEA08}"),//кочкор
                new Guid("{4313A514-83B6-4FED-9731-4D838A6E91CD}"),//нарын район
                new Guid("{93DF61DD-A2FE-4F52-B961-F1B27BD27A8C}"),//нарын г
                new Guid("{B3C93041-BBEA-445D-B7E1-D42D9F3692C3}"),//акталаа
                new Guid("{B3EA3DE1-5D76-461C-90AC-68D312B7B665}"),//жумгал
                new Guid("{69EAAC3D-3525-4CE3-8C5E-42123B4ED9CB}")//ат-баши
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {
                //new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{C6D92271-6FF2-4641-A83F-D02610060C43}"),//кара-буура  
                new Guid("{3BB3CB8F-A747-4026-9031-C6B67EA9735B}"),//г талас
                new Guid("{16FD5BFF-7AB4-4B40-AAFB-0282BA5BE32E}"),//талас рн
                new Guid("{B8DACAD8-0118-4147-8BD2-30DCE891E5EB}"),//манас
                new Guid("{7F311898-D254-4668-8184-D1794E695A19}")//бакай-ата
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                // new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{18DBE2BE-BBB6-4BC2-9A33-8B25856C0382}"),//г джалалабад
                new Guid("{E4964796-6658-46A9-BD49-A34B3275CB1F}"),//ноокен
                new Guid("{DC448CE3-49F4-43F1-AEAA-F782341C62C0}"),//сузак
                new Guid("{AA65C2F7-3091-40E5-939D-6A18250E125A}"),//каракуль
                new Guid("{9D8B0CA0-D618-4157-AF15-5E7CCA7D9F23}"),//ташкумыр
                new Guid("{64ECD259-A848-474B-8E8D-571612A7E43B}"),//токтогул рн
                new Guid("{17F5601A-36B7-4FAC-A980-07F349239D5B}"),//базар-коргон
                new Guid("{9AFA2870-4609-4D8A-8417-11C2DBDEC94B}"),//майлысуу
                new Guid("{B42B4F13-2AA5-43D2-B738-CB02CA647D47}"),//кок-жангак
                new Guid("{B0A96501-F5F4-48A4-8103-6C7A7BA290C4}"),//тогуз-торо
                new Guid("{60F22545-CB84-4795-81A3-2EEEEB0FB88A}"),//ала-бука
                new Guid("{2765827A-88EF-4144-8050-9A2FD66FB136}"),//аксы
                new Guid("{A598BEA0-37C9-4DC2-9BC7-FB3AA1097E14}")//чаткал
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                // new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{8B739BFD-CF8F-4380-A246-8A34BCE9A231}"),//ош
                new Guid("{B382A964-BBD7-4540-B6E4-BC9250AB7005}"),//араван
                new Guid("{A3282FFC-BAFE-4B4E-99D0-C68509BE6133}"),//ноокат
                new Guid("{E5411CDD-3CAF-4798-A7BF-FD57C856C82B}"),//алай
                new Guid("{59FF6F9C-F047-4E25-B837-669AA0596B07}"),//кара-суу
                new Guid("{C1A54A26-CA15-4C29-8DEB-957F5B0FD002}"),//чон-алай
                new Guid("{E425497A-3C82-424E-9691-71EAAD4759D8}"),//узген рн
                new Guid("{D62E0B83-E589-491D-B0A4-8BEA42178231}"),//узген г
                new Guid("{A2317371-CC1D-4EB3-8ADF-D7BA33B75F87}")//каракулджа
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                //new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{C7B6AA81-A4B7-4AD6-BE03-E4B54E8084DA}"),//лейлек
                new Guid("{5EE1AC59-52A1-45E3-84EC-54AD09FC9F1E}"),//баткен рн
                new Guid("{D328865B-EDE4-4674-92C6-C134F55C3C6F}"),//баткен г
                new Guid("{879F3420-E45A-4E11-9394-D0B1A0091805}"),//кадамжай
                new Guid("{32AF3EA3-4100-406F-8825-20CB8A1877AA}"),//кызыл-кия
                new Guid("{FF3B071C-FC51-4F64-8BD4-11A5377E93D2}")//сулюкта                                               
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<ReportF8SVODItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                return CalcItems(context, fd, ld);
            }
            public static List<ReportF8SVODItem> CalcItems(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportF8SVODItem>();
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var lastLd = fromFd.AddDays(-1);
                var qb = new QueryBuilder(legalPregDefId, context.UserId);
                qb.Where("LegalReportSection").Include("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def); //беременность роды - юр. лицо   
                var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "BirthCadThrowRepublicBudget");
                query.AddAttribute(legalSrc, "ReportDate");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddOrderAttribute(query.Source, "&OrgName");

                var table = new DataTable();
                using (var reader = new SqlQueryReader(query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var reportDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var orgId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr5 += 1;
                        if (repbudjet != 0) rayon.gr6 = ((decimal?)rayon.gr6 ?? 0m) + repbudjet;
                        if (reportDate >= fd && reportDate <= ld)
                        {
                            rayon.gr7 += 1;
                            if (repbudjet != 0) rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                            rayon.gr11 = rayon.gr7;
                            rayon.gr12 = rayon.gr8;
                        }
                        if (reportDate >= lastFd && reportDate <= fd)
                        {
                            rayon.gr9 += 1;
                            if (repbudjet != 0) rayon.gr10 = ((decimal?)rayon.gr10 ?? 0m) + repbudjet;
                        }
                    }
                }

                var qb1 = new QueryBuilder(appPregancyDefId, context.UserId);
                qb1.Where("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                var queryL = SqlQueryBuilder.Build(context.DataContext, qb1.Def);
                queryL.AddAttribute(queryL.Source, "&Id");
                queryL.AddAttribute(queryL.Source, "AssignedAmountRepublicBudgetBR");
                queryL.AddAttribute(queryL.Source, "RegDate");
                queryL.AddAttribute(queryL.Source, "Service");
                queryL.AddAttribute(queryL.Source, "&OrgId");
                queryL.AddOrderAttribute(queryL.Source, "&OrgName");

                var tableL = new DataTable();                
                using (var readerL = new SqlQueryReader(queryL))
                {
                    readerL.Open();
                    readerL.Fill(tableL);
                    readerL.Close();
                }
                foreach (DataRow row in tableL.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr5 += 1;
                        if (repbudjet != 0) rayon.gr6 = ((decimal?)rayon.gr6 ?? 0m) + repbudjet;
                        if (regDate >= lastFd && regDate <= fd)
                        {
                            ///throw new ApplicationException(no + "; ");
                            rayon.gr9 += 1;
                            if (repbudjet != 0) rayon.gr10 = ((decimal?)rayon.gr10 ?? 0m) + repbudjet;
                        }
                        if (regDate >= fd && regDate <= ld)
                        {
                            rayon.gr7 += 1;
                            rayon.gr11 = rayon.gr7;
                            if (repbudjet != 0)
                            {
                                rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                                rayon.gr12 = rayon.gr8;
                                if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                {
                                    rayon.gr13 += repbudjet * (decimal)0.013;
                                }
                                else if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                {
                                    rayon.gr14 += repbudjet * (decimal)0.005;
                                }
                            }
                            rayon.gr15 = rayon.gr12 + rayon.gr13 + rayon.gr14;
                            if (rayon.gr12 != 0 || rayon.gr11 != 0)
                            {
                                rayon.gr16 = Math.Round((rayon.gr12 / rayon.gr11) * 1000, 1);
                            }
                        }
                    }
                }
                var qb2 = new QueryBuilder(legalRitualDefId, context.UserId);
                qb2.Where("LegalReportSection").Include("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();
                
                var query2 = SqlQueryBuilder.Build(context.DataContext, qb2.Def);
                var legalSrc2 = query2.JoinSource(query2.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                query2.AddAttribute(query2.Source, "&Id");
                query2.AddAttribute(query2.Source, "DeadCadThrowRepublicBudget");
                query2.AddAttribute(legalSrc2, "ReportDate");
                query2.AddAttribute(query2.Source, "&OrgId");
                query2.AddOrderAttribute(query2.Source, "&OrgName");

                var table2 = new DataTable();
                using (var reader = new SqlQueryReader(query2))
                {
                    reader.Open();
                    reader.Fill(table2);
                    reader.Close();
                }
                foreach (DataRow row in table2.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var reportDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var orgId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr17 += 1;
                        if (repbudjet != 0) rayon.gr18 = ((decimal?)rayon.gr18 ?? 0m) + repbudjet;
                        if (reportDate >= fd && reportDate <= ld)
                        {
                            rayon.gr19 += 1;
                            if (repbudjet != 0) rayon.gr20 = ((decimal?)rayon.gr20 ?? 0m) + repbudjet;
                            rayon.gr23 = rayon.gr19;
                            rayon.gr24 = rayon.gr20;
                        }
                        if (reportDate >= lastFd && reportDate <= fd)
                        {
                            rayon.gr21 += 1;
                            if (repbudjet != 0) rayon.gr22 = ((decimal?)rayon.gr22 ?? 0m) + repbudjet;
                        }
                    }
                }

                var qb3 = new QueryBuilder(appRitualDefId, context.UserId);
                qb3.Where("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                var query3 = SqlQueryBuilder.Build(context.DataContext, qb3.Def);
                query3.AddAttribute(query3.Source, "&Id");
                query3.AddAttribute(query3.Source, "AssignedAmountRepublicBudget");
                query3.AddAttribute(query3.Source, "RegDate");
                query3.AddAttribute(query3.Source, "Service");
                query3.AddAttribute(query3.Source, "&OrgId");
                query3.AddOrderAttribute(query3.Source, "&OrgName");

                var table3 = new DataTable();
                using (var reader = new SqlQueryReader(query3))
                {
                    reader.Open();
                    reader.Fill(table3);
                    reader.Close();
                }
                foreach (DataRow row in table3.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr17 += 1;
                        if (repbudjet != 0) rayon.gr18 = ((decimal?)rayon.gr18 ?? 0m) + repbudjet;

                        if (regDate >= fd && regDate <= ld)
                        {
                            rayon.gr19 += 1;
                            rayon.gr20 = ((decimal?)rayon.gr20 ?? 0m) + repbudjet;
                            rayon.gr23 = rayon.gr19;
                            rayon.gr24 = rayon.gr20;
                            if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                            {
                                rayon.gr25 += repbudjet * (decimal)0.013;
                            }
                            else if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                            {
                                rayon.gr26 += repbudjet * (decimal)0.005;
                            }
                        }
                        if (regDate >= lastFd && regDate <= fd)
                        {
                            rayon.gr21 += 1;
                            if (repbudjet != 0) rayon.gr22 = ((decimal?)rayon.gr22 ?? 0m) + repbudjet;
                        }
                        rayon.gr27 = rayon.gr24 + rayon.gr25 + rayon.gr26;
                        if (rayon.gr24 != 0 || rayon.gr23 != 0)
                        {
                            rayon.gr28 = Math.Round((rayon.gr24 / rayon.gr23) * 1000, 1);
                        }
                    }
                }
                // RegionReportItem regionReportItem = new RegionReportItem();
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    //regionReportItem.BishkekCityRegion.Add(subItem);
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    //regionReportItem.ChuyRegion.Add(subItem);
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    //regionReportItem.TalasRegion.Add(subItem);
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    //regionReportItem.YssykKolRegion.Add(subItem);
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    //regionReportItem.NarynRegion.Add(subItem);
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    //regionReportItem.BatkenRegion.Add(subItem);
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    //regionReportItem.OshRegion.Add(subItem);
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    //regionReportItem.OshCityRegion.Add(subItem);
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                    //regionReportItem.JalalAbadRegion.Add(subItem);
                }
                return items;
            }
            private static decimal GetRPAmountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "ritTotalAmount", SqlQuerySummaryFunction.Sum);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                    return 0m;
                }
            }
            private static int GetCountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    // var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.LeftOuter, "LegalReportSection");
                    query.AddAttribute(query.Source, "LegalPerson", SqlQuerySummaryFunction.Count);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetInt32(0) : 0;
                    return 0;
                }
            }
            //[DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportF8SVODItem>();
                    YssykKolRegion = new List<ReportF8SVODItem>();
                    NarynRegion = new List<ReportF8SVODItem>();
                    TalasRegion = new List<ReportF8SVODItem>();
                    OshRegion = new List<ReportF8SVODItem>();
                    JalalAbadRegion = new List<ReportF8SVODItem>();
                    BatkenRegion = new List<ReportF8SVODItem>();
                    BishkekCityRegion = new List<ReportF8SVODItem>();
                    OshCityRegion = new List<ReportF8SVODItem>();
                }
                public List<ReportF8SVODItem> ChuyRegion { get; set; }
                public List<ReportF8SVODItem> YssykKolRegion { get; set; }
                public List<ReportF8SVODItem> NarynRegion { get; set; }
                public List<ReportF8SVODItem> TalasRegion { get; set; }
                public List<ReportF8SVODItem> OshRegion { get; set; }
                public List<ReportF8SVODItem> JalalAbadRegion { get; set; }
                public List<ReportF8SVODItem> BatkenRegion { get; set; }
                public List<ReportF8SVODItem> BishkekCityRegion { get; set; }
                public List<ReportF8SVODItem> OshCityRegion { get; set; }
            }
            static ReportF8SVODItem GetReportItem(List<ReportF8SVODItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportF8SVODItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }

            public class ReportF8SVODItem
            {
                public string RegionName { get; set; }
                public string OrgName { get; set; }
                private Guid OrgId { get; set; }
                public int gr5 { get; set; }
                public decimal gr6 { get; set; }
                public int gr7 { get; set; }
                public decimal gr8 { get; set; }
                public int gr9 { get; set; }
                public decimal gr10 { get; set; }
                public int gr11 { get; set; }
                public decimal gr12 { get; set; }
                public decimal gr13 { get; set; }
                public decimal gr14 { get; set; }
                public decimal gr15 { get; set; }
                public decimal gr16 { get; set; }
                public int gr17 { get; set; }
                public decimal gr18 { get; set; }
                public int gr19 { get; set; }
                public decimal gr20 { get; set; }
                public int gr21 { get; set; }
                public decimal gr22 { get; set; }
                public int gr23 { get; set; }
                public decimal gr24 { get; set; }
                public decimal gr25 { get; set; }
                public decimal gr26 { get; set; }
                public decimal gr27 { get; set; }
                public decimal gr28 { get; set; }
                public decimal gr29 { get; set; }
                public ReportF8SVODItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class ReportForNBKR //active code
        {
            private static readonly Guid orderPaymentDefId = new Guid("{AD83752B-C412-4FEC-A345-BB0495C34150}");
            private static readonly Guid bankOrderDefId = new Guid("{A7D9505F-F3BE-4ABC-95E7-129D907C0FD8}"); //Банковский счет
            private static readonly Guid postOrderDefId = new Guid("{19EA8D75-2EE7-42CA-BE3B-D7E41F343DDD}"); //Почтовое поручения
            private static readonly Guid appDefId = new Guid("{04D25808-6DE9-42F5-8855-6F68A94A224C}"); //Заявления
            private static readonly Guid assignDefId = new Guid("{5D599CE4-76C5-4894-91CC-4EB3560196CE}");  //Назначения
            private static readonly Guid appStateId = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}"); //Дела (на выплате)
            private static readonly Guid approvedStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");  //Утвержденные банкавское поручения                      

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек
            {                                
            //new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),
                new Guid("{2AB93962-2A1F-42D4-9E70-78931B9A413D}"),//ленин
                new Guid("{34DDCAF2-EB08-48E7-894A-29C929D62C83}"),//первомайский
                new Guid("{0BADBCA1-ADD3-4B74-9A95-60F2EED92118}"),//свердлово
                new Guid("{17C0AC69-2247-41E8-B086-54599FE11CED}"),//октябрь
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                    
            //    new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{78D008DF-F7E8-4F99-92A1-42E7AE6E34C3}"),//кемин
                new Guid("{AA466C30-47A6-4252-989D-F44C91A120A5}"),//чуй
                new Guid("{CAE58A37-FBE8-49AA-8E09-B167F871A5E8}"),//город токмок
                new Guid("{BEC45992-2D1C-4488-A260-FC7C5511F619}"),//ыссык-ата
                new Guid("{822E0311-F790-474D-BC97-E67CE8D14009}"),//аламудун
                new Guid("{C139D4DE-9F64-46D2-A908-1C477B78ECCD}"),//сокулук
                new Guid("{CA59DB1A-4AB2-4CB2-90C6-BF323E82E44A}"),//москва
                new Guid("{6612E6F7-BA2B-4E33-ADB9-FA0B14705E27}"),//жайыл
                new Guid("{72075FFB-371D-4C7B-8A5A-993E1C51CBFF}"),//панфилов
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {                                   
            //    new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{02992EB8-E107-408E-954E-E322A73B433A}"),//г талас
                new Guid("{1E5868C3-B522-4DBF-BC8F-02C75A899C0F}"),//талас рн
                new Guid("{C285A1F2-2114-4752-A626-A235C6D6F2B1}"),//бакай-ата
                new Guid("{17A6CA38-8B7B-4F5C-973B-18F31646CC03}"),//кара-буура
                new Guid("{376FF578-372D-43A4-818E-31BC64327BEF}"),//манас
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
            //    new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{43842F64-7BB7-45EC-930B-54AD19186382}"),//каракол
                new Guid("{2FEA2DF5-24F6-4E53-BF6C-22604AC014C1}"),//балыкчы
                new Guid("{416366EE-580B-4E57-8641-0D90A2F5AB73}"),//иссык-куль
                new Guid("{5B438995-2070-46A8-9377-E922F0D64E4F}"),//тюп
                new Guid("{AAD91EAB-297F-40C8-B592-68573495EEC0}"),//жети-огуз
                new Guid("{55F9FFBF-B789-4002-BD64-B04163806897}"),//тон
                new Guid("{D2EDB83E-7EE5-4B5A-82A6-E9E49DD1E3B3}"),//ак-суу
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {
            //    new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{CB788BA9-8F94-4317-A655-B4F5527F3A4B}"),//акталаа
                new Guid("{4C60A2A2-73B4-4EA4-A6D0-E2B41370C7FC}"),//ат-баши
                new Guid("{52568E10-0210-4B09-B106-9E14520E26F1}"),//жумгал
                new Guid("{B631F3B0-1656-49C5-9152-0252F304D29B}"),//кочкор
                new Guid("{A6B9B397-81CF-43ED-A17B-6A13C110A678}"),//нарын район
                new Guid("{0A409F28-4A73-4CED-B368-10C6BE53419F}"),//нарын г
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
            //    new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{0BCED873-4950-449A-98E6-69C44F64D70C}"),//баткен рн
                new Guid("{20745158-EAE3-434C-BDF5-5F893C8963ED}"),//баткен г
                new Guid("{E062B2A3-42C4-4619-B086-705E6C5367D3}"),//кадамжай
                new Guid("{F6CECF6A-2D5D-44C1-BC2F-29A836965531}"),//лейлек
                new Guid("{DDE31E57-4454-44EE-AFA9-80227E3C8620}"),//кызыл-кия
                new Guid("{E883C8F3-5E3C-4086-A078-91FD22E6550A}"),//сулюкта
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
            //    new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{C3C63817-FFB3-4905-BC70-8C3A3DBB67DC}"),//араван
                new Guid("{2A0481C0-FB12-4048-9153-CB7AE997A26C}"),//каракулджа
                new Guid("{3A305A9A-D30E-4C38-9E41-09DF993A658E}"),//кара-суу
                new Guid("{E0AF1DF7-AA64-45DD-873E-510CD413AD35}"),//ноокат
                new Guid("{B0B7490F-E48D-4DC7-9548-0505D73C858F}"),//узген рн
                new Guid("{2F8C280E-6C97-41D5-B24F-7D0DF4FF4C0E}"),//узген г
                new Guid("{5903E184-79E4-4630-AD91-FD488B84B832}"),//алай
                new Guid("{8A7D0C1C-A4A7-4582-8D65-8023CDB273E1}")//чон-алай
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
            //    new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{D319DC07-E7F7-4997-AFCD-17CEAD707B7F}"),//г джалалабад
                new Guid("{8CAC9C70-D770-4AAB-8B0B-E1C432F6985A}"),//кок-жангак
                new Guid("{EFA2A70A-D10E-4941-B1F8-AE5218E5AD29}"),//майлысуу
                new Guid("{8E3CA117-0956-4F67-A8EF-B8222DC0A21E}"),//ташкумыр
                new Guid("{CB86E66E-8A41-4D92-9FD6-9BCF7E61F543}"),//каракуль
                new Guid("{9375DF49-1B41-4EFD-BB79-0FC2A86ABED6}"),//сузак
                new Guid("{A23770C6-2843-446E-8382-8C50AFD699E5}"),//базар-коргон
                new Guid("{A3E2A017-96F2-47C6-AF09-6FA4287E6953}"),//ноокен
                new Guid("{A5B70AEE-4E8B-4194-864D-F58E5BAB76E7}"),//аксы
                new Guid("{915D0BEB-53C1-440F-9CBA-00612369FEFC}"),//ала-бука
                new Guid("{5026031D-2BC9-4A24-8DB5-30C7DD992352}"),//чаткал
                new Guid("{F9D53DFB-0E18-44E6-A905-8B67F5751D37}"),//токтогул рн
                new Guid("{BF0A92AD-140E-4582-AB9F-DB304890C35A}")//тогуз-торо
            };
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                return CalcItems(context, year, month);
            }
            public static List<ReportItem> CalcItems(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                SqlQuery queryBank = new SqlQuery(orderPaymentDefId, context.DataContext);
                var orderBankSrc = queryBank.JoinSource(queryBank.Source, bankOrderDefId, SqlSourceJoinType.Inner, "OrderPayments");
                var appBankSrc = queryBank.JoinSource(orderBankSrc, appDefId, SqlSourceJoinType.Inner, "Application");
                var assignBankSrc = queryBank.JoinSource(appBankSrc, assignDefId, SqlSourceJoinType.Inner, "Assignments");
                queryBank.AddCondition(ExpressionOperation.And, appDefId, "&State", ConditionOperation.Equal, appStateId);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Year", ConditionOperation.Equal, year);
                queryBank.AddCondition(ExpressionOperation.And, orderPaymentDefId, "Month", ConditionOperation.Equal, month);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "&State", ConditionOperation.Equal, approvedStateId);
                queryBank.AddCondition(ExpressionOperation.And, bankOrderDefId, "ExpiryDate", ConditionOperation.GreatThen, new DateTime(year, month, 1));

                queryBank.AddAttribute(orderBankSrc, "&OrgId");
                queryBank.AddAttribute(appBankSrc, "&Id");
                var village = queryBank.AddAttribute(appBankSrc, "Town");
                //queryBank.AddGroupAttribute(village);

                var table = new DataTable();
                using (var reader = new SqlQueryReader(context.DataContext, queryBank))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var orgId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var appId = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var town = row[2] is DBNull ? "-" : (string)row[2];
                    if (string.IsNullOrEmpty(town)) town = "-";

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, town, orgId);
                    int appCount = 0;
                    if (appId != Guid.Empty)
                    {
                        /*town++;
                        rayon.Village = town;*/
                        rayon.AppCount++;
                    }
                }
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                }
                return items;
            }
            [DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportItem>();
                    YssykKolRegion = new List<ReportItem>();
                    NarynRegion = new List<ReportItem>();
                    TalasRegion = new List<ReportItem>();
                    OshRegion = new List<ReportItem>();
                    JalalAbadRegion = new List<ReportItem>();
                    BatkenRegion = new List<ReportItem>();
                    BishkekCityRegion = new List<ReportItem>();
                    OshCityRegion = new List<ReportItem>();
                }
                [DataMember]
                public List<ReportItem> ChuyRegion { get; set; }
                [DataMember]
                public List<ReportItem> YssykKolRegion { get; set; }
                [DataMember]
                public List<ReportItem> NarynRegion { get; set; }
                [DataMember]
                public List<ReportItem> TalasRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshRegion { get; set; }
                [DataMember]
                public List<ReportItem> JalalAbadRegion { get; set; }
                [DataMember]
                public List<ReportItem> BatkenRegion { get; set; }
                [DataMember]
                public List<ReportItem> BishkekCityRegion { get; set; }
                [DataMember]
                public List<ReportItem> OshCityRegion { get; set; }
            }
            static ReportItem GetReportItem(List<ReportItem> items, string orgName, string villa, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName && x.Village == villa);
                if (item != null) return item;
                item = new ReportItem(orgId)
                {
                    OrgName = orgName,
                    Village = villa,
                };
                items.Add(item);
                return item;
            }

            [DataContract]
            public class ReportItem
            {
                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string OrgName { get; set; }
                [DataMember]
                private Guid OrgId { get; set; }
                [DataMember]
                public string Village { get; set; }
                [DataMember]
                public int AppCount { get; set; }
                public ReportItem(Guid orgId)
                {
                    OrgId = orgId;
                }
                public Guid GetOrgId()
                {
                    return OrgId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_Application5
        {
            static Guid balagaSuyunchuApp = new Guid("{4B8EA3F0-D536-4A59-9D2A-41872D63103C}");
            static Guid payable_state = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}");
            static Guid approvedStateTypeId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");

            private static readonly Guid applicantId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid childId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid bankDetailsId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid bankSheetId = new Guid("{4C2C2792-DBB5-4F3A-9748-68D349EEB2BA}");
            private static readonly Guid summaryReportId = new Guid("{FC95D09E-3ABC-4E24-A57A-ED662F90798B}");

            private static readonly decimal BALAGA_SUYUNCHU_PRICE = 4000;

            public static HashSet<ZAGSInfo> PilotZAGS = new HashSet<ZAGSInfo>
            {
                new ZAGSInfo
                {
                    Id = 10001,
                    Name = "Отдел ЗАГС Аламудунского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10002,
                    Name = "Отдел ЗАГС Сокулукского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 9992,
                    Name = "Отдел ЗАГС Свердловского района, г .Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9991,
                    Name = "Отдел ЗАГС Первомайского района, г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9993,
                    Name = "Отдел ЗАГС Ленинского района, г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9994,
                    Name = "Отдел ЗАГС Октябрьского района, г. Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9995,
                    Name = "Дворец бракосочетания г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9997,
                    Name = "Отдел ЗАГС Кеминского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 9998,
                    Name = "Отдел ЗАГС Чуйского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 9999,
                    Name = "Отдел ЗАГС Ысык-Атинского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10000,
                    Name = "Отдел ЗАГС Московского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10003,
                    Name = "Отдел ЗАГС Панфиловского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10004,
                    Name = "Отдел ЗАГС Жайылского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10005,
                    Name = "Отдел ЗАГС г. Нарын",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10006,
                    Name = "Отдел ЗАГС Ак-Талинского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10007,
                    Name = "Отдел ЗАГС Жумгальского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10008,
                    Name = "Отдел ЗАГС Ат-Башинского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10009,
                    Name = "Отдел ЗАГС Кочкорского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10010,
                    Name = "Отдел ЗАГС г. Жалал-Абад",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10011,
                    Name = "Отдел ЗАГС г. Майлуу-Суу",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10012,
                    Name = "Отдел ЗАГС г. Таш-Кумыр",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10013,
                    Name = "Отдел ЗАГС г. Кара-Куль",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10014,
                    Name = "Отдел ЗАГС Ала-Букинского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10015,
                    Name = "Отдел ЗАГС Аксыйского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10016,
                    Name = "Отдел ЗАГС Базар-Коргонского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10019,
                    Name = "Отдел ЗАГС Токтогульского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10020,
                    Name = "Отдел ЗАГС Тогуз-Тороузкого района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10021,
                    Name = "Отдел ЗАГС Чаткальского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10022,
                    Name = "Кок-Артский зональный ЗАГС в Сузакский район",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10023,
                    Name = "Уч-Терекский зональный ЗАГС в Токтогульский район",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10024,
                    Name = "Отдел ЗАГС г. Ош",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10025,
                    Name = "Отдел ЗАГС Алайского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10026,
                    Name = "Отдел ЗАГС Араванского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10027,
                    Name = "Отдел ЗАГС Кара-Сууйского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10028,
                    Name = "Отдел ЗАГС Кара-Кульжинского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10029,
                    Name = "Отдел ЗАГС Ноокатского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10030,
                    Name = "Отдел ЗАГС Узгенского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10031,
                    Name = "Отдел ЗАГС Чон - Алайского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10032,
                    Name = "Отдел ЗАГС Баткенского района",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10033,
                    Name = "Отдел ЗАГС Лейлекского района",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10035,
                    Name = "Отдел ЗАГС  г. Кызыл-Кия",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10036,
                    Name = "Отдел ЗАГС г. Сулюкта",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10037,
                    Name = "Отдел ЗАГС г. Каракол",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10038,
                    Name = "Отдел ЗАГС г. Балыкчы",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10039,
                    Name = "Отдел ЗАГС Иссык-Кульского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10040,
                    Name = "Отдел ЗАГС Ак-Суйского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10041,
                    Name = "Отдел ЗАГС Тюпского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10042,
                    Name = "Отдел ЗАГС Жети-Огузского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10043,
                    Name = "Отдел ЗАГС Тонского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10044,
                    Name = "Отдел ЗАГС г. Талас",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 10045,
                    Name = "Отдел ЗАГС Таласского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 10046,
                    Name = "Отдел ЗАГС Манасского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 10047,
                    Name = "Отдел ЗАГС Бакай-Атинского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 9990,
                    Name = "Управление актов гражданского состояния",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9996,
                    Name = "Отдел ЗАГС гражданского обслуживания г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 10017,
                    Name = "Отдел ЗАГС Ноокенского района",
                    RegionName = "Жалал-Абадская область"

                },
                new ZAGSInfo
                {
                    Id = 10018,
                    Name = "Отдел ЗАГС Сузакского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10034,
                    Name = "Отдел ЗАГС Кадамжайского района",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10048,
                    Name = "Отдел ЗАГС Кара-Бууринского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 13328252,
                    Name = "Кок-Жангакский зональный ЗАГС в Сузакский район",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 29260968,
                    Name = "Сектор выездной регистрации г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 29787977,
                    Name = "Сектор выездной регистрации г.Ош",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 34592703,
                    Name = "Отдел ЗАГС г. Талас и Таласского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 34599769,
                    Name = "Отдел ЗАГС г. Майлуу-Суу и Ноокенского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 35926975,
                    Name = "c. Ивановка ОЗАГС Ысык-Атинского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 36812923,
                    Name = "отдел ЗАГС г.Кант",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 37278107,
                    Name = "отдел ЗАГС г.Кант",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 37598780,
                    Name = "Отдел ЗАГС Аламудунского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 37851512,
                    Name = "отдел ЗАГС Фрунзенского района Ошской области",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 38829108,
                    Name = "Дом бракосочетания г.Фрунзе",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 40748164,
                    Name = "ПО с.1-Май Ала-Букинского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 13320567,
                    Name = "Учреждение \"Сейдикумский айыл Окмоту Сейдикумского айылного аймака\"",
                    RegionName = "Жалал-Абадская область"
                },
            new ZAGSInfo
            {
                Id = 41784187,
                Name = "станция Кольцо",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 41784184,
                Name = "посёлок Восточный",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320636,
                Name = "Учреждение \"Айыл окмоту Жаны-Талапского айылного аймака\"",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320646,
                Name = "Учреждение \"Айыл окмот Баш-Каиндинского айылного аймака\"",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320652,
                Name = "Учреждение \"Айыл окмот Жаны-Арыкского айылного аймака\"",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320655,
                Name = "Кек-Ойский айыл окмоту ",
                RegionName = "Таласская область"

            },
            new ZAGSInfo
            {
                Id = 13320659,
                Name = "Учреждение \"Айыл окмоту Тюгель-Сайского айылного аймака\"",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320660,
                Name = "Учреждение \"Айыл окмот Таш-Добонского айылного аймака\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36667400,
                Name = "Кыргыз-Кыштакский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13893654,
                Name = "Байтикский айылный аймак",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320520,
                Name = "Бостеринский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320623,
                Name = "Баш-Дебенский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320685,
                Name = "Учкунский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320622,
                Name = "Шамалды-Сай айыл окмоту г.Таш-Кумыр Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 15787797,
                Name = "Логвиненовский сельский совет, Кантского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320507,
                Name = "Айыл окмоту Ак-Шыйракского айыльного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320510,
                Name = "Айыл окмоту Жаргылчакского айылного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320529,
                Name = "Айыл окмоту Оруктинского айылного аймака",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320532,
                Name = "Айыл окмоту Кол-Торского айылного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320535,
                Name = "Кунчыгышский айыл окмоту",
                RegionName = "Неизвестная область"

            },
            new ZAGSInfo
            {
                Id = 13320541,
                Name = "Иссык-Кульский айыл окмоту",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320550,
                Name = "Тюпский айыл окмоту",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320572,
                Name = "Учреждение \"Жаны-Жолский айыл Окмоту Жаны-Жолского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320558,
                Name = "1-Майский айыл окмоту, 1-Майского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320596,
                Name = "Учреждение \"Ленинский айыл Окмоту Ленинского айылного аймака\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320601,
                Name = "Учреждение \"Ырысский айыл Окмоту Ырысского айылного аймака",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320610,
                Name = "Учреждение \"Ничке-Сайский айыл Окмоту Ничке-Сайского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320593,
                Name = "Кок-Артский айылный окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320613,
                Name = "Учреждение \"Уч-Терекский айыл Окмоту Уч-Терекского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320624,
                Name = "Территориальное управление поселка Сары-Бээ",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320633,
                Name = "Учреждение \"Айыл окмот Жерге-Тальского айылного аймака\"",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320617,
                Name = "Каныш-Кийский сельский совет Чаткальского района Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320569,
                Name = "Кенешский айыл окмоту, Базар-Коргонского района,  Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320676,
                Name = "Учреждение \"Айыл окмот Доболинского айыльного аймака\"",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320677,
                Name = "Учреждение \"Айыл окмот Жан-Булакского айылного аймака\"",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320711,
                Name = "Кетерминский айыл окмоту ",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320723,
                Name = "Гульчинский айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320734,
                Name = "Алля-Анаровский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320735,
                Name = "Араванский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320748,
                Name = "Кызылсууский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320779,
                Name = "Каракульджинский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320780,
                Name = "Кызылджарский айыл окмоту",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320786,
                Name = "Акжарский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320787,
                Name = "Башдобо айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320799,
                Name = "Кызылтооский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320807,
                Name = "Чон-Алайский айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320808,
                Name = "\"Акчийский айыл окмоту\" Акчийского айыльного окружного кенеша Карабууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 43165025,
                Name = "Ак-Суйский сельский совет Московского района",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320813,
                Name = "\"Кара-Бууринский айыл окмоту\" Кара-Бууринского айыльного аймака Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320822,
                Name = "\"Бакай-Атинский айыл окмоту\" Ленинпольского айыльного аймака Бакай-Атинского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320830,
                Name = "\"Покровский айыл окмоту\" Покровского айыльного аймака Манасского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320835,
                Name = "\"Кок-Ой айыл окмоту\" Кок-Ойского айыльного округа Таласского района",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320852,
                Name = "Учреждение \"Кокжарский айыл окмоту Кокжарского айыльного округа Аламудунского района Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36667648,
                Name = "Уч-Коргонский сельский совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667775,
                Name = "Которминский сельский совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320855,
                Name = "Учреждение \"Маевский айыл окмоту\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320873,
                Name = "Учреждение \"Люксембургский айыл окмоту\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36667932,
                Name = "Марказский сельский совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 43998537,
                Name = "отдел ЗАГС г. Чолпон-Ата",
                RegionName = "Иссык-Кулская область"
            },
            new ZAGSInfo
            {
                Id = 13320892,
                Name = "Орловский поселковый окмоту",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320899,
                Name = "А.Дуйшеевский айыл окмоту",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320919,
                Name = "Учреждение \"Панфиловский айыл окмоту Панфиловского аильного округа Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320922,
                Name = "Ат-Башинский айыл окмоту",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320914,
                Name = "Целинный айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320913,
                Name = "Тюлекский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320872,
                Name = "Кочкорбаевский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13330077,
                Name = "Сакалды айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13330081,
                Name = "Сакалды айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13334970,
                Name = "Ак-Жол айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13566296,
                Name = "Тайгараев айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13566721,
                Name = "Кыз-Кольский айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13582751,
                Name = "Кадамжайская поселковая управа",
                RegionName = "Ошская область"

            },
            new ZAGSInfo
            {
                Id = 13591505,
                Name = "Дургонду айыл окмоту",
                RegionName = "Жалал-Абадская область"

            },
            new ZAGSInfo
            {
                Id = 13645086,
                Name = "Түгөлсайский айыл окмоту",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13645087,
                Name = "Көк-Өй айыл окмоту, Нарынская область",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320951,
                Name = "Жапалак айыл окмоту, г.Ош",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320502,
                Name = "Айыл окмоту Теплоключенского айылного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320934,
                Name = "Новопавловский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 15760292,
                Name = "Чон-Арыкский айыл окмоту",
                RegionName = "г. Бишкек"
            },
            new ZAGSInfo
            {
                Id = 17707924,
                Name = "Кун-Батыш айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 36694496,
                Name = "Чаувайский п/совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36696391,
                Name = "Алгинский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320869,
                Name = "Ысык-Атинский айыл окмоту, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 17807032,
                Name = "Толойкон айыл окмоту, Кара-Сууйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 18605996,
                Name = "Копуро-Базар айыл окмоту, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 19636598,
                Name = "Ызарский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 18696050,
                Name = "Орукту айыл окмоту Иссык-Кульского района Иссык-Кульской области",
                RegionName = "Иссык-Кулькая область"
            },
            new ZAGSInfo
            {
                Id = 13320798,
                Name = "Кызыл-Октябрьский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 18612937,
                Name = "Жаны-Жерский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 20133818,
                Name = "село Романовка, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320595,
                Name = "Кызыл-Тууйски айыл окмоту, Таласский район, Таласская область",
                RegionName = " Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320503,
                Name = "Челпекский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кулькая область"
            },
            new ZAGSInfo
            {
                Id = 20559692,
                Name = "Торогелди Балтагуловский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320587,
                Name = "Сакалдинский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320760,
                Name = "Кара-Ташский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320769,
                Name = "Он-Эки-Бельский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 18605981,
                Name = "Кызыл-Тоо айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320682,
                Name = "Мин-Булакский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320700,
                Name = "Маргунский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320717,
                Name = "Кыргыз-Кыштакский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320916,
                Name = "Вознесеновский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320878,
                Name = "Тузский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 21305367,
                Name = "Ак-Булакский айыл окмоту, г.Кызыл-Кия, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 21904580,
                Name = "Кок-алмийский айыл окмоту, Базар-Коргонского района, Жалал-абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320625,
                Name = "Территориальное управление поселка Кетмен-Тобо, г.Каракуль, Жалал-абадская область",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 22875047,
                Name = "Октябрьский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320815,
                Name = "Чолпонбайский айыл окмоту (Чымкент), Кара-Бууринского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320573,
                Name = "Ак-Сууский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320582,
                Name = "Бургондинский айыл окмоту, Ноокенского район, Жалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 23874735,
                Name = "Кашка-Жолский айыл окмоту, Кара-Кулжинского района, ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 33077219,
                Name = "Поселковый совет Орто - Токой",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 33332264,
                Name = "Кок - Жарский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 33603458,
                Name = "Исфанинский сельский совет с.Исфана",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 33967184,
                Name = "Привокзальный айыл окмоту",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 33787446,
                Name = "Бирликский айыл окмоту, Фрунзенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 14693942,
                Name = "Кызыл-Жарский айыл окмоту, г. Таш-Кумыр, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34356376,
                Name = "Джекенский айыл окмоту, Жайылского района, Чуйской области"
            },
            new ZAGSInfo
            {
                Id = 34356405,
                Name = "Алтынский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356472,
                Name = "Буденский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356256,
                Name = "Үч-Дөбө айыл окмоту Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320909,
                Name = "Первомайский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356333,
                Name = "Бөжөй айыл окмоту Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320691,
                Name = "Торт-Гул айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 34356519,
                Name = "Калининский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356567,
                Name = "Алексеевский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356578,
                Name = "Новониколаевкий айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356615,
                Name = "Ставрополовкий айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356639,
                Name = "Петропавловкий айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356718,
                Name = "Молтаварский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320907,
                Name = "Беловодский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 20562592,
                Name = "Ак-Чийский айыл окмоту, Ак-Талиского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 33937768,
                Name = "Ленин айыл окмоту, Сузакского район, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34591683,
                Name = "Бек-Абад айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320498,
                Name = "Октябрьский айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320629,
                Name = "Баетовский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 34591463,
                Name = "Благовещенка айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34591969,
                Name = "Чука - Тюбинский айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34592162,
                Name = "Джийденский айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34592172,
                Name = "Таштакский айыл омоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645700,
                Name = "Ак-Мечетский айыл окмоту, Сузакского района, Жалал-Абадской облсти",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645717,
                Name = "Чагыр-Ташский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645728,
                Name = "Ичинский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645748,
                Name = "Молотовский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645770,
                Name = "Большевикский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645780,
                Name = "Кумуш-Азизский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320599,
                Name = "Сузакский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 36259043,
                Name = "Хайдарканская поселковая управа Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 35035430,
                Name = "Бординский поселковый совет-Кеминского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320860,
                Name = "Таш-Добонский айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320666,
                Name = "Кочкорский айыл окмоту Кочкорского района Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 36258834,
                Name = "Которминский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36258906,
                Name = "Сельский совет Кара - Добо Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259288,
                Name = "Кыргыз - Кыштакский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259476,
                Name = "Ак-Турпакский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320853,
                Name = "Лебединовский айыл окмоту Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36259591,
                Name = "Уч-Коргонский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259696,
                Name = "Майданский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259915,
                Name = "Марказский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259989,
                Name = "Орозбековский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260043,
                Name = "Фрунзенский рай. ЗАГС Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260104,
                Name = "Фрунзенская поселковая управа Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260167,
                Name = "Кадамжайский поселковый совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260261,
                Name = "Бирликский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260314,
                Name = "Чувайский поселковый совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260381,
                Name = "Советский поселковый совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36263347,
                Name = "Баткенский сельский совет Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36263438,
                Name = "Жаны-Жерский сельский совет Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36588296,
                Name = "Алгинский сельский coвет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36298067,
                Name = "Ак-Чийский айыл окмоту Ак-Талинского района Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320875,
                Name = "Сын-Ташский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 16749885,
                Name = "Архангельский айыл окмоту, Сузакского района, Джалал-Абадская области",
                RegionName = "Жала-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320555,
                Name = "Тайгараев айыл окмоту, г.Джалал-Абад Джалал-Абадской области",
                RegionName = "Жала-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320560,
                Name = "Көк-Таш айыл окмоту Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36641136,
                Name = "Халмионский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666291,
                Name = "Халмионский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666712,
                Name = "Айдаркенский п/совет Кадамжайского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666753,
                Name = "Айдаркенский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666833,
                Name = "Кадамжайский п/совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666856,
                Name = "Кадамжайский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666931,
                Name = "Чаувайский п/совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666938,
                Name = "Чаувайский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666959,
                Name = "Советский п/совет Кадамжайского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666992,
                Name = "Советский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667044,
                Name = "Ак-Турпакский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667094,
                Name = "Бирликский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667293,
                Name = "Майданский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667326,
                Name = "Орозбековский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320809,
                Name = "Бейшекенский айыл окмоту Кара-Бууринского р-а Таласской обл",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320662,
                Name = "Кызыл-Жылдызский акыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320661,
                Name = "Чаекский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 36979594,
                Name = "Ак-Шыйракский айылный аймак Жети-Огузского района Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 37273338,
                Name = "Кара-Суйский поссовет Баткенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 37273491,
                Name = "Раут-Каутский сельский совет Баткенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 37273547,
                Name = "Зардалинский сельский совет Баткенского района г.Бишкек",
                RegionName = "г. Бишкек"
            },
            new ZAGSInfo
            {
                Id = 20525868,
                Name = "Берю-Башский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320518,
                Name = "Тамгинский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320580,
                Name = "Уч-Коргонский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 39625821,
                Name = "Пристань-Пржевальский а/к  г.Каракол Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 41491609,
                Name = "Чон-Арыкский сельский совет Аламудунского района",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 38621499,
                Name = "Кодулский сельсовет Токтогульского района  Джалал-Абадской области"
            },
            new ZAGSInfo
            {
                Id = 13320756,
                Name = "Толойконский айыл окмоту, Кара-Суйского района, Ошской области"
            },
            new ZAGSInfo
            {
                Id = 44099962,
                Name = "с.Кетмень-Тюбе, Токтогульского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320915,
                Name = "Чапаевский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 44716613,
                Name = "Чырпыктинский сельский совет Иссык-Кульского района",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320609,
                Name = "Кызыл-Озгорүшский айыл окмоту, Уч-Терекский зональный отдел ЗАГС Токтогульского района, Жалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 45803028,
                Name = "Торт-Кульский с/с Жети-Огузского района Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320519,
                Name = "Ананьевский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320738,
                Name = "Тепе-Коргонский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320845,
                Name = "Ак-Дебенский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320846,
                Name = "Ала-Арчинский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320851,
                Name = "Кара-Джыгачский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320884,
                Name = "Ак-Башатский айыл окмоту,  Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320883,
                Name = "Кызыл - Дыйканский айыл окмоту,  Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320564,
                Name = "Арстанбапский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320566,
                Name = "Могольский айыл окмот, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320562,
                Name = "Базар-Коргонский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320579,
                Name = "Жерге-Тальский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320584,
                Name = "Массынский айыл окмоту, Нокенского района, Джалал-Абаской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320552,
                Name = "Ак-Булакский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 15804570,
                Name = "Люксембургский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320551,
                Name = "Чон-Ташский айыл омоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320508,
                Name = "Барскоонский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320576,
                Name = "Кош-Добойский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320739,
                Name = "Нурабадский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320517,
                Name = "Светлополянский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320525,
                Name = "Тамчынский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320530,
                Name = "Чон-Сары-Ойский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320542,
                Name = "Кутургинский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320546,
                Name = "Сарыбулакский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320534,
                Name = "Болот Мамбетовский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320568,
                Name = "Талдуу-Булакский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320581,
                Name = "Аралский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320588,
                Name = "Шайданский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320611,
                Name = "Кетмень-Дебенский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320583,
                Name = "Достукский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320607,
                Name = "Бель-Алдынский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320557,
                Name = "Оруктунский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320571,
                Name = "Авлетимский айыл окмоту, Аксыйского района, ДжалалАбадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320728,
                Name = "Ленинский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320604,
                Name = "Каргалыкский айыл окмоту, Тогуз-Тороуского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320630,
                Name = "Терекский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320634,
                Name = "Кош-Дебенский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320639,
                Name = "Угутский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320643,
                Name = "Ак-Талинский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320651,
                Name = "Баш-Куугандынский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320654,
                Name = "Кабакский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320640,
                Name = "Ак-Джарский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320663,
                Name = "Мин-Кушский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320628,
                Name = "Ак-Чийский айылный аймак, Кара-Бууринского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320644,
                Name = "Баш-каинды айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320720,
                Name = "Алайский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320668,
                Name = "Кум-Дюбинский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320729,
                Name = "Талды-Сууский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320726,
                Name = "Кабылан-Колский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320736,
                Name = "Мангытский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320737,
                Name = "Керме-Тооский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320670,
                Name = "Семиз-Бельский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320675,
                Name = "Ак-Кудукский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320681,
                Name = "Эмгекчильский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320715,
                Name = "Уч-Коргонский айыл окмоту, Манасского района, Таласской области",
                RegionName = "Талаская область"
            },
            new ZAGSInfo
            {
                Id = 13320688,
                Name = "Сары-Ойский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320692,
                Name = "Кара-Бакский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320710,
                Name = "Абсамат Масалиевский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320693,
                Name = "Кара-Булакский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320742,
                Name = "Ак-Ташский айыл окмоту, Кара-суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320750,
                Name = "Наримановский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320754,
                Name = "Савайский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320765,
                Name = "Зулпуевский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320705,
                Name = "Сумбулинский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320699,
                Name = "Бешкентский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320764,
                Name = "Кыргызатинский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320758,
                Name = "Бельский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320733,
                Name = "Сары-Ташский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320771,
                Name = "Мирмахмудовский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320775,
                Name = "Капчыгайский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320781,
                Name = "Ылайталинский айыл окмоту,  Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320793,
                Name = "Ийрисууский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320796,
                Name = "Кароолский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320801,
                Name = "Мырзаке айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320810,
                Name = "Бакыянский айыльный аймак, Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320812,
                Name = "Бакайырский айыл окмоту, Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320817,
                Name = "Маймакский айыл окмоту, Кара-Бууринского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320819,
                Name = "Боо-Терекский айыл окмоту, Бакай-атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320821,
                Name = "Кен-Аральский айыльный аймак Бакай-Атинского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320826,
                Name = "Ороcкий айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320828,
                Name = "Киргизия айыл окмоту, Манасского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320832,
                Name = "Арал айыл окмоту, Таласского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320850,
                Name = "Грозденский айыл окмоту, Грозденского аильного округа, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320868,
                Name = "Интернациональный айыл окмоту, Ысык-Атинского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320857,
                Name = "Октябрьский айыл окмоту, Аламудунского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320854,
                Name = "Ленинский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320862,
                Name = "Ак-Кудукский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320863,
                Name = "Бирдикский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320864,
                Name = "Ивановский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320866,
                Name = "Жээкский айыл окмоту, Ысык-Атинского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320840,
                Name = "Осмонкуловский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320842,
                Name = "Куугандинский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320834,
                Name = "Долонский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320824,
                Name = "Озгорушский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320876,
                Name = "Новопокровский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320877,
                Name = "Юрьевский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320879,
                Name = "Узун-Кырский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320881,
                Name = "Кара-Сууский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320886,
                Name = "Суусамырский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320889,
                Name = "Сосновский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320908,
                Name = "Петровский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320911,
                Name = "Садовский айыл окмоту, Московского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320923,
                Name = "Тош-Булакский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320926,
                Name = "Жаны-Джерский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320928,
                Name = "Камышановский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320930,
                Name = "Кунтууский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320932,
                Name = "Кызыл-Тууский айыл окмоту, Сокулукского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320918,
                Name = "Ортоевский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320920,
                Name = "Фрунзенский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320905,
                Name = "Александровский айыл окмоту, Московского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320910,
                Name = "Предтеченский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320903,
                Name = "Ак-Тюзский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320901,
                Name = "Чым-Коргонский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320896,
                Name = "Ильичевский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320917,
                Name = "Курпульдекский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320515,
                Name = "Кызыл-Сууский айыл окмоту,Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320648,
                Name = "Кара-Коюнский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320859,
                Name = "Пригородный айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320942,
                Name = "Буранинский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320948,
                Name = "Сайлыкский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320945,
                Name = "Кегетинский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320936,
                Name = "Орокский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320937,
                Name = "Первомайский айыл окмоту, Сокулукского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320939,
                Name = "Фрунзенский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320925,
                Name = "Гавриловский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320499,
                Name = "Отрадненсий айыл окмоту, Ак-Суйского район, Иссык-Кульской Область",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320538,
                Name = "Улаколский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13329322,
                Name = "Кенеш айыл окмот, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320495,
                Name = "Караколский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320494,
                Name = "Кара-Джалский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320627,
                Name = "Ак-Талский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320766,
                Name = "Исанова айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320704,
                Name = "Кулундинский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320619,
                Name = "Сумсарский айыл окмоту, Чаткальского район, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 20108205,
                Name = "г. Кант, Ысык-Атинский район, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13946534,
                Name = "Кочкор-Атинский гор-управление, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320861,
                Name = "Таш-Мойнокский айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320493,
                Name = "Берю-Башский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320578,
                Name = "Кара-Сууйский айыл окмоту, Кара-Сууйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 17731405,
                Name = "Тугол-Сайский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320694,
                Name = "Кыш АО (Дубликат)",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320847,
                Name = "Аламудунский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 17756394,
                Name = "Кыргызстанский айыл окмоту,  Манаского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320849,
                Name = "Васильевский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 18617453,
                Name = "Мэрия г.Орловка, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320649,
                Name = "Кара-Суу айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 19744880,
                Name = "Кара-Суу айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 19771654,
                Name = "Пристань-Пржевальск поселковый кенеш г.Каракол Иссык-Кульская область",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320575,
                Name = "Кашка-Суу айыл окмоту, Чон-Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320506,
                Name = "Ак-Дюбинского Айыл окмоту, Аламудинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320848,
                Name = "Арашанский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320946,
                Name = "Кош-Коргонский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320949,
                Name = "Чуйский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 18238406,
                Name = "Кызыл-Октябрьский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320665,
                Name = "Кара-Сууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320743,
                Name = "Жаны-Арык айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 18995975,
                Name = "Первомайский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320890,
                Name = "Степнинская айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 20175483,
                Name = "Ат-Башы айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320638,
                Name = "Кок-Жарский айылный аймак, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320540,
                Name = "Аралский айыл окмоту, Тюпского района, Иссыкульской области",
                RegionName = "Иссы-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320671,
                Name = "Талаа-Булак  айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320496,
                Name = "Кереге-Ташский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320900,
                Name = "Кызыл-Октябрьский айыл окмоту, Ак-Сууйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20471180,
                Name = "Отрадненский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320500,
                Name = "Ак-Чийский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20218342,
                Name = "Кичи-Кеминский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320501,
                Name = "Тепкенский айыл окмоту, Ак-суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20156353,
                Name = "Мэрия г.Кербен, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320505,
                Name = "Жергаланский айыл окмоту, Ак-суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320547,
                Name = "Ак-Булунский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320497,
                Name = "Боз-Учукский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20474876,
                Name = "Жыргаланский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320504,
                Name = "Энильчекский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320509,
                Name = "Дарканский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20475366,
                Name = "Джаргылчакский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320513,
                Name = "Липенский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320514,
                Name = "Оргочорский айыл окмоту, Жети-Огузской района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320522,
                Name = "Кара-Ойский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320524,
                Name = "Семеновский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320526,
                Name = "Абдрахмановский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320528,
                Name = "Тору-Айгырский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20477878,
                Name = "Орюктинский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320940,
                Name = "айыл окмоту им.З.Кайназаровой, Сокулукского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320882,
                Name = "Красновосточный айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 20532532,
                Name = "Кель-терский айыл окмоту, Тонского района, Иссыкульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320673,
                Name = "Чолпонский айылный аймак, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320548,
                Name = "Талды-Сууский айыл окмоту, Тюпского района, Иссыкульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320531,
                Name = "Ак-Терекский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320533,
                Name = "Кек-Мойнокский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320536,
                Name = "Тонский Айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320804,
                Name = "Терт-Кульский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320539,
                Name = "Каджи-Сайский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 20558926,
                Name = "Иссык-Кельский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320543,
                Name = "Михайловский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320706,
                Name = "Тогуз-Булакский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320545,
                Name = "Сан-Ташский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320783,
                Name = "Сары-Булакский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320549,
                Name = "Карасаевский айыл окмоту, Тюпского района, Иссык-КУльской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320561,
                Name = "Акманский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320565,
                Name = "Кызыл-Ункюрский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320722,
                Name = "Бюлелинский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320724,
                Name = "Джошолунский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320725,
                Name = "Конур-Добонский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320554,
                Name = "Ак-Тамский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320727,
                Name = "Корульский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20560389,
                Name = "Сайдыкумский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320730,
                Name = "Сары - Моголский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320731,
                Name = "Уч-Дебенский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320608,
                Name = "Джаны-Джольский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320574,
                Name = "Кара-Жыгачский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320744,
                Name = "Жоошский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"

            },
            new ZAGSInfo
            {
                Id = 20560882,
                Name = "Мавляновский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320570,
                Name = "Ак-Жолский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 20560950,
                Name = "Кызыл-Тууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320741,
                Name = "Чек-Абадский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320740,
                Name = "Тео-Моюнский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320650,
                Name = "Талды-Сууский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320732,
                Name = "Жаны-Алайский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320698,
                Name = "Ак-Сууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320745,
                Name = "Катта-Талдыкский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20560156,
                Name = "Алайский айылный аймак им.К.Белекбаева, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320749,
                Name = "Мадынский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320585,
                Name = "Момбековский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320751,
                Name = "Отузадырский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320586,
                Name = "Ноокенский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320752,
                Name = "Сары-Колотский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320753,
                Name = "Папанский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320755,
                Name = "Сарайский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320757,
                Name = "Шаркский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320759,
                Name = "Гюльстанский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320784,
                Name = "Чалминский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320747,
                Name = "Кызыл-Кыштак айыл окмоту, Кара-Сууйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320721,
                Name = "Будалыкский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320833,
                Name = "Джерге-Талский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320605,
                Name = "Сары-Булунский айыл окмоту, Тогуз-Торинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320602,
                Name = "Атайский айыл окмоту, Тогуз-Торинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 15732723,
                Name = "Курама айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320614,
                Name = "Аралбаевский (Толукский) айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320612,
                Name = "Сары-Камышский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320618,
                Name = "Чаткальский айыл окмоту, Чаткальского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320620,
                Name = "Терек-Сайский айыл окмоту, Чаткальского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320631,
                Name = "Кара-Бюргенский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320632,
                Name = "Конорчокский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320635,
                Name = "Кызыл-Белесский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 20562849,
                Name = "Джаны-Талапский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320615,
                Name = "Суеркуловский (Торкенский) айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320761,
                Name = "Кулатовский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320762,
                Name = "Джаны-Ноокатский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320637,
                Name = "Тоголок-Молдоский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320768,
                Name = "Кек - Джарский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320767,
                Name = "Кок-Бельский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320641,
                Name = "Ак-Моюнский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320642,
                Name = "Ак-Музский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320645,
                Name = "Ача-Каиндинский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320647,
                Name = "Казыбекский  айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320773,
                Name = "Найманский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320774,
                Name = "Алайкууский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320776,
                Name = "Кенешский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320621,
                Name = "Кызыл-Жарский айылный аймак, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563379,
                Name = "Джаны-Арыкский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320782,
                Name = "Ой-Талский айыл окмоту,  Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320653,
                Name = "Джумгальский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320888,
                Name = "Сары-Булакский айылный аймак, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320763,
                Name = "Кенешский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320777,
                Name = "Карагузский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320656,
                Name = "Байзаковский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320657,
                Name = "Куйручукский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320770,
                Name = "Төөлөсский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320658,
                Name = "Чон-Добонский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 20563629,
                Name = "Баш-Дебенский айылный аймак, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563676,
                Name = "Тугол-Сайский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320789,
                Name = "Жылалдынский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320790,
                Name = "Ден-Булакский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320794,
                Name = "Чангетский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320795,
                Name = "Кара-Ташский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563918,
                Name = "Кызыл-Октябрьский айылный аймак, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320664,
                Name = "Ак-Кыянский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320785,
                Name = "Чалминский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563799,
                Name = "Суюмбаевский айыл окмоту (Таш-Добо), Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320802,
                Name = "Алтынбулакский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320797,
                Name = "Кельдюкский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320791,
                Name = "Заргерский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563101,
                Name = "Кызыл-Октябрьский айыл окмоту (Кок-Жар), Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320667,
                Name = "Кош-Дебенский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320803,
                Name = "Саламаликский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320669,
                Name = "Сары-Булакский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320805,
                Name = "Жекендийский айылный аймак, Чон-Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320811,
                Name = "Аманбаевский айыл окмоту,Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 20564374,
                Name = "Дебелинский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 20564448,
                Name = "Джан-Булакский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320814,
                Name = "Кок-Сайский айыл окмоту,  Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 20564528,
                Name = "Джергеталский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320816,
                Name = "Шекерский айыл окмоту, Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320818,
                Name = "Шадыканский айыл окмоту, Бакай-атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320679,
                Name = "Казан-Куйганский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320680,
                Name = "Кара-Куджурский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320823,
                Name = "Мин-Булакский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320825,
                Name = "Ак-Добонский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320827,
                Name = "Каиндинский айыл окмоту, Манасского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320683,
                Name = "Он-Арчинский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320829,
                Name = "Майский айыл окмоту, Манасского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320684,
                Name = "Ортокский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320686,
                Name = "Чет-Нуринский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320687,
                Name = "Эмгек-Талинский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320841,
                Name = "Омуралиевский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320839,
                Name = "Бердике-Баатырский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320838,
                Name = "Нуржановский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320843,
                Name = "Кара-Сууйский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320836,
                Name = "Бекмолдоевский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320858,
                Name = "Байтик айыл окмоту,  Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13894405,
                Name = "Маевский айылный аймак, Аламудунского района",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320690,
                Name = "Дарыинский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 20565487,
                Name = "Кыштутский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320695,
                Name = "Самаркандекский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320702,
                Name = "Лейлекский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320701,
                Name = "Джаны-Джерский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 14071519,
                Name = "Ак-Татырский айыл окмоту, Баткенского района,  Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320856,
                Name = "Нижне-Аларчинский айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320713,
                Name = "Марказский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320941,
                Name = "Ак-Бешимский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320943,
                Name = "Искринский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320944,
                Name = "Ибраимовский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320947,
                Name = "Онбир-Джылгинский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320714,
                Name = "Орозбековский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320709,
                Name = "Бирликский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 20566168,
                Name = "Которминский айыл окмоту Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320708,
                Name = "Алгинский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320719,
                Name = "Чаувайский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320718,
                Name = "Советский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320707,
                Name = "Ак-Турпакский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320904,
                Name = "Ак-Сууский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320703,
                Name = "Катранский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320544,
                Name = "Тогуз-Булакский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320950,
                Name = "Шамшынский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320924,
                Name = "Военно-Антоновский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320927,
                Name = "Джаны-Пахтинский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320933,
                Name = "Нижне-Чуйский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320935,
                Name = "Сазский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320938,
                Name = "Сокулукский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320929,
                Name = "Асылбашский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320870,
                Name = "Краснореченский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320867,
                Name = "Кен-Булунский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320874,
                Name = "Милянфанский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320880,
                Name = "Жайылский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320921,
                Name = "Чалдыбарский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320906,
                Name = "Беш-Терекский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320885,
                Name = "Полтавский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320912,
                Name = "Сретенский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320887,
                Name = "Сарыкооский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320902,
                Name = "Чон-Кеминский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320891,
                Name = "Талды-Булакский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320894,
                Name = "Боролдойский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320893,
                Name = "Алмалинский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320559,
                Name = "им. Т.Балтагулова айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320674,
                Name = "Сон-Кульский айыл окмоту (Телек), Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320626,
                Name = "Заргерский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320792,
                Name = "Жазыйский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20875144,
                Name = "Сары-Булакский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320820,
                Name = "Акназаровский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 21864115,
                Name = "Ноокатский городской кенеш, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320606,
                Name = "Тогуз-Тороуский айылный аймак, Тогуз-Тороузского района, Жалал-абадской области",
                RegionName = "Жалал-абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320895,
                Name = "Жаны-Алышский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320778,
                Name = "Кара-Кочкорский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320516,
                Name = "Алдашевский айыл окмоту(Саруу), Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320689,
                Name = "Достукский айыл окмоту, Ноокенского района, Жалал-Абадского области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320898,
                Name = "Көк-Ойрокский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 28565615,
                Name = "Ала-Букинский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 20539682,
                Name = "Ак-Булунский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 33967200,
                Name = "Кызыл-Аскерский айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320563,
                Name = "Бешик-Жонский айыл окмоту Базар-Коргонского района Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 33967175,
                Name = "Чон-Арыкский айыл окмоту Ленинского района г.Бишкек",
                RegionName = "г. Бишкек"
            },
            new ZAGSInfo
            {
                Id = 13320672,
                Name = "Кок-Жарский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320844,
                Name = "Калбинский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320837,
                Name = "Айдаралиевский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13585633,
                Name = "Мэрия г.Айдаркен Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 18595164,
                Name = "Мэрия г. Шопокова Сокулукского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 33967310,
                Name = "Кара-Алма айыл окмоту, Сузакского района, Джалал - Абад области",
                RegionName = "Джалал - Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320871,
                Name = "Логвиненковский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320865,
                Name = "Нурманбетский айыл окмоту,  Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320931,
                Name = "айыл окмоту им. Крупской, Сокулукского района, Чуйской области",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320523,
                Name = "Кум-Бельский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 13320521,
                Name = "Садыр аке айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 20112155,
                Name = "Калининский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320696,
                Name = "Ак-Сайский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 20565332,
                Name = "Торт-Гульский айыл окмоту  Баткенского района  Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320716,
                Name = "Халмионский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320527,
                Name = "Темировский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 13320678,
                Name = "Жергетальский айыл окмоту, Таласского района, Таласской области",
                RegionName = "Таласская  область"
            },
            new ZAGSInfo
            {
                Id = 13320603,
                Name = "Кок-Иримский айыл окмоту, Тогузтороузского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320590,
                Name = "Барпынский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320594,
                Name = "Кыз-Кельский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320598,
                Name = "Сайпидин-Атабековский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320589,
                Name = "Курманбекский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320591,
                Name = "Кара-Алминский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320597,
                Name = "Багышский айыл окмоту, Сузакского района, Жалал-абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 30678347,
                Name = "Ырысский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320577,
                Name = "Кызыл-Тууский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320600,
                Name = "Таш-Булакский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 46540372,
                Name = "Чыракский сельский совет Жети-Огузского района",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 46811068,
                Name = "Темен-Суйский сельский совет Московского района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 46811165,
                Name = "Кош-Тюбинский сельский совет Московского района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 47388375,
                Name = "Петровский сельский совет Московского  района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 48410811,
                Name = "Ак-Кульский сельский совет Жумгальского района",
                RegionName = "Нарынская  область"
            },
            new ZAGSInfo
            {
                Id = 13320511,
                Name = "Джети-Огузский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 50025884,
                Name = "Боз-Бешикский сельский совет Жети-Огузского района",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 50831848,
                Name = "Ленинский с/с  Кок-Артского зонального ЗАГС в Сузакском  районе",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 50997218,
                Name = "Ак-Суусский горсовет Московского района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320512,
                Name = "Ырдыкский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 13320897,
                Name = "Кара-Булакский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320592,
                Name = "Кара-Дарыянский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320697,
                Name = "Суу-Башинский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320746,
                Name = "Кашгар-Кыштакский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320831,
                Name = "Уч-Коргонский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 20561865,
                Name = "Джаны-Джольский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13702039,
                Name = "Кызыл-Озгорушский айыл окмоту Токтогульского района Жалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320616,
                Name = "Чолпон-Атинский айыл окмоту Токтогульского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320553,
                Name = "Ак-Коргонский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320556,
                Name = "Кек-Серекский айыл окмоту, Кек-Серекского айылного аймака, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 20559730,
                Name = "Кок-Ташский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320806,
                Name = "Кашка-Сууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320800,
                Name = "Куршабский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320537,
                Name = "Терт-Кульский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320788,
                Name = "Жалпак-Ташский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320712,
                Name = "Майданский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320772,
                Name = "Ынтымакский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 51867283,
                Name = "Ак-Ташский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 51867543,
                Name = "Сары-Булакский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 51966256,
                Name = "Чандалашский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 51966265,
                Name = "Коргон-Сайский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            }
         };

            public class ZAGSInfo
            {
                public int Id { get; set; }
                public string Name { get; set; }
                public string RegionName { get; set; }
            }
            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, 1, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(balagaSuyunchuApp, context.UserId);

                qb.Where("BankSheet").Include("CommonNeedAmount").Include("&State").Eq(approvedStateTypeId).And("Date").Ge(fd).And("Date").Le(ld).End().End();

                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var bankSheetSrc = query.JoinSource(query.Source, bankSheetId, SqlSourceJoinType.Inner, "BankSheet");
                var summaryReportSrc = query.JoinSource(bankSheetSrc, summaryReportId, SqlSourceJoinType.Inner, "CommonNeedAmount");
                query.AddAttribute(query.Source, "&Id", SqlQuerySummaryFunction.Count);
                var zagsAttr = query.AddAttribute(query.Source, "ZagsId");
                var dateAttr = query.AddAttribute(summaryReportSrc, "Date");
                query.AddGroupAttribute(zagsAttr);
                query.AddGroupAttribute(dateAttr);

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var govUnit = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var zagsId = reader.IsDbNull(1) ? 0 : reader.GetInt32(1);
                        var docDate = reader.IsDbNull(2) ? DateTime.MinValue : reader.GetDateTime(2);
                        var pilotZags = PilotZAGS.Where(x => x.Id == zagsId).FirstOrDefault();
                        var item = GetReportItem(items, pilotZags.Name, pilotZags.RegionName, zagsId);
                        int indexOfMonth = docDate.Month;
                        switch (indexOfMonth)
                        {
                            case 1:
                                item.January.Count += govUnit;
                                item.January.Sum = item.January.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 2:
                                item.February.Count += govUnit;
                                item.February.Sum = item.February.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 3:
                                item.March.Count += govUnit;
                                item.March.Sum = item.March.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 4:
                                item.April.Count += govUnit;
                                item.April.Sum = item.April.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 5:
                                item.May.Count += govUnit;
                                item.May.Sum = item.May.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 6:
                                item.June.Count += govUnit;
                                item.June.Sum = item.June.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 7:
                                item.July.Count += govUnit;
                                item.July.Sum = item.July.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 8:
                                item.August.Count += govUnit;
                                item.August.Sum = item.August.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 9:
                                item.September.Count += govUnit;
                                item.September.Sum = item.September.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 10:
                                item.October.Count += govUnit;
                                item.October.Sum = item.October.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 11:
                                item.November.Count += govUnit;
                                item.November.Sum = item.November.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 12:
                                item.December.Count += govUnit;
                                item.December.Sum = item.December.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                        }
                    }
                }
                return items;
            }
            static ReportItem GetReportItem(List<ReportItem> items, string districtName, string regionName, int _zagsId)
            {
                var item = items.FirstOrDefault(x => x.getZagsId().Equals(_zagsId));
                if (item != null) return item;
                item = new ReportItem(districtName, regionName, _zagsId);
                items.Add(item);
                return item;
            }
            [DataContract]
            public class ReportItem
            {

                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string DistrictName { get; set; }
                private int ZagsId { get; set; }
                [DataMember]
                public MonthReport January { get; set; }
                [DataMember]
                public MonthReport February { get; set; }
                [DataMember]
                public MonthReport March { get; set; }
                [DataMember]
                public MonthReport April { get; set; }
                [DataMember]
                public MonthReport May { get; set; }
                [DataMember]
                public MonthReport June { get; set; }
                [DataMember]
                public MonthReport July { get; set; }
                [DataMember]
                public MonthReport August { get; set; }
                [DataMember]
                public MonthReport September { get; set; }
                [DataMember]
                public MonthReport October { get; set; }
                [DataMember]
                public MonthReport November { get; set; }
                [DataMember]
                public MonthReport December { get; set; }

                public ReportItem(string districtName, string regionName, int _zagsId)
                {
                    DistrictName = districtName;
                    RegionName = regionName;
                    ZagsId = _zagsId;
                    January = new MonthReport();
                    February = new MonthReport();
                    March = new MonthReport();
                    April = new MonthReport();
                    May = new MonthReport();
                    June = new MonthReport();
                    July = new MonthReport();
                    August = new MonthReport();
                    September = new MonthReport();
                    October = new MonthReport();
                    November = new MonthReport();
                    December = new MonthReport();
                }

                [DataContract]
                public class MonthReport
                {
                    [DataMember]
                    public int Count { get; set; }
                    [DataMember]
                    public decimal Sum { get; set; }
                }
                public int getZagsId()
                {
                    return ZagsId;
                }
            }
        }

        /*******************************************************************************************************************/
        public static class Report_Application5a
        {
            static Guid balagaSuyunchuApp = new Guid("{4B8EA3F0-D536-4A59-9D2A-41872D63103C}");
            static Guid payable_state = new Guid("{3DB4DB00-3A7F-4228-A9A3-A413B85C18B4}");
            static Guid approvedStateTypeId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");

            private static readonly Guid applicantId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid childId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
            private static readonly Guid bankDetailsId = new Guid("{F21733AC-AC34-499B-B0CC-F47C8053D6B7}");
            private static readonly Guid bankSheetId = new Guid("{4C2C2792-DBB5-4F3A-9748-68D349EEB2BA}");
            private static readonly Guid summaryReportId = new Guid("{FC95D09E-3ABC-4E24-A57A-ED662F90798B}");

            private static readonly decimal BALAGA_SUYUNCHU_PRICE = 50000;

            public static HashSet<ZAGSInfo> PilotZAGS = new HashSet<ZAGSInfo>
            {
                new ZAGSInfo
                {
                    Id = 10001,
                    Name = "Отдел ЗАГС Аламудунского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10002,
                    Name = "Отдел ЗАГС Сокулукского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 9992,
                    Name = "Отдел ЗАГС Свердловского района, г .Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9991,
                    Name = "Отдел ЗАГС Первомайского района, г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9993,
                    Name = "Отдел ЗАГС Ленинского района, г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9994,
                    Name = "Отдел ЗАГС Октябрьского района, г. Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9995,
                    Name = "Дворец бракосочетания г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9997,
                    Name = "Отдел ЗАГС Кеминского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 9998,
                    Name = "Отдел ЗАГС Чуйского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 9999,
                    Name = "Отдел ЗАГС Ысык-Атинского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10000,
                    Name = "Отдел ЗАГС Московского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10003,
                    Name = "Отдел ЗАГС Панфиловского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10004,
                    Name = "Отдел ЗАГС Жайылского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 10005,
                    Name = "Отдел ЗАГС г. Нарын",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10006,
                    Name = "Отдел ЗАГС Ак-Талинского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10007,
                    Name = "Отдел ЗАГС Жумгальского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10008,
                    Name = "Отдел ЗАГС Ат-Башинского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10009,
                    Name = "Отдел ЗАГС Кочкорского района",
                    RegionName = "Нарынская область"
                },
                new ZAGSInfo
                {
                    Id = 10010,
                    Name = "Отдел ЗАГС г. Жалал-Абад",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10011,
                    Name = "Отдел ЗАГС г. Майлуу-Суу",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10012,
                    Name = "Отдел ЗАГС г. Таш-Кумыр",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10013,
                    Name = "Отдел ЗАГС г. Кара-Куль",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10014,
                    Name = "Отдел ЗАГС Ала-Букинского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10015,
                    Name = "Отдел ЗАГС Аксыйского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10016,
                    Name = "Отдел ЗАГС Базар-Коргонского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10019,
                    Name = "Отдел ЗАГС Токтогульского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10020,
                    Name = "Отдел ЗАГС Тогуз-Тороузкого района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10021,
                    Name = "Отдел ЗАГС Чаткальского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10022,
                    Name = "Кок-Артский зональный ЗАГС в Сузакский район",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10023,
                    Name = "Уч-Терекский зональный ЗАГС в Токтогульский район",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10024,
                    Name = "Отдел ЗАГС г. Ош",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10025,
                    Name = "Отдел ЗАГС Алайского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10026,
                    Name = "Отдел ЗАГС Араванского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10027,
                    Name = "Отдел ЗАГС Кара-Сууйского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10028,
                    Name = "Отдел ЗАГС Кара-Кульжинского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10029,
                    Name = "Отдел ЗАГС Ноокатского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10030,
                    Name = "Отдел ЗАГС Узгенского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10031,
                    Name = "Отдел ЗАГС Чон - Алайского района",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 10032,
                    Name = "Отдел ЗАГС Баткенского района",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10033,
                    Name = "Отдел ЗАГС Лейлекского района",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10035,
                    Name = "Отдел ЗАГС  г. Кызыл-Кия",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10036,
                    Name = "Отдел ЗАГС г. Сулюкта",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10037,
                    Name = "Отдел ЗАГС г. Каракол",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10038,
                    Name = "Отдел ЗАГС г. Балыкчы",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10039,
                    Name = "Отдел ЗАГС Иссык-Кульского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10040,
                    Name = "Отдел ЗАГС Ак-Суйского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10041,
                    Name = "Отдел ЗАГС Тюпского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10042,
                    Name = "Отдел ЗАГС Жети-Огузского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10043,
                    Name = "Отдел ЗАГС Тонского района",
                    RegionName = "Иссык — Кульская область"
                },
                new ZAGSInfo
                {
                    Id = 10044,
                    Name = "Отдел ЗАГС г. Талас",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 10045,
                    Name = "Отдел ЗАГС Таласского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 10046,
                    Name = "Отдел ЗАГС Манасского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 10047,
                    Name = "Отдел ЗАГС Бакай-Атинского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 9990,
                    Name = "Управление актов гражданского состояния",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 9996,
                    Name = "Отдел ЗАГС гражданского обслуживания г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 10017,
                    Name = "Отдел ЗАГС Ноокенского района",
                    RegionName = "Жалал-Абадская область"

                },
                new ZAGSInfo
                {
                    Id = 10018,
                    Name = "Отдел ЗАГС Сузакского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 10034,
                    Name = "Отдел ЗАГС Кадамжайского района",
                    RegionName = "Баткенская область"
                },
                new ZAGSInfo
                {
                    Id = 10048,
                    Name = "Отдел ЗАГС Кара-Бууринского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 13328252,
                    Name = "Кок-Жангакский зональный ЗАГС в Сузакский район",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 29260968,
                    Name = "Сектор выездной регистрации г.Бишкек",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 29787977,
                    Name = "Сектор выездной регистрации г.Ош",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 34592703,
                    Name = "Отдел ЗАГС г. Талас и Таласского района",
                    RegionName = "Таласская область"
                },
                new ZAGSInfo
                {
                    Id = 34599769,
                    Name = "Отдел ЗАГС г. Майлуу-Суу и Ноокенского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 35926975,
                    Name = "c. Ивановка ОЗАГС Ысык-Атинского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 36812923,
                    Name = "отдел ЗАГС г.Кант",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 37278107,
                    Name = "отдел ЗАГС г.Кант",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 37598780,
                    Name = "Отдел ЗАГС Аламудунского района",
                    RegionName = "Чуйская область"
                },
                new ZAGSInfo
                {
                    Id = 37851512,
                    Name = "отдел ЗАГС Фрунзенского района Ошской области",
                    RegionName = "Ошская область"
                },
                new ZAGSInfo
                {
                    Id = 38829108,
                    Name = "Дом бракосочетания г.Фрунзе",
                    RegionName = "г. Бишкек"
                },
                new ZAGSInfo
                {
                    Id = 40748164,
                    Name = "ПО с.1-Май Ала-Букинского района",
                    RegionName = "Жалал-Абадская область"
                },
                new ZAGSInfo
                {
                    Id = 13320567,
                    Name = "Учреждение \"Сейдикумский айыл Окмоту Сейдикумского айылного аймака\"",
                    RegionName = "Жалал-Абадская область"
                },
            new ZAGSInfo
            {
                Id = 41784187,
                Name = "станция Кольцо",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 41784184,
                Name = "посёлок Восточный",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320636,
                Name = "Учреждение \"Айыл окмоту Жаны-Талапского айылного аймака\"",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320646,
                Name = "Учреждение \"Айыл окмот Баш-Каиндинского айылного аймака\"",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320652,
                Name = "Учреждение \"Айыл окмот Жаны-Арыкского айылного аймака\"",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320655,
                Name = "Кек-Ойский айыл окмоту ",
                RegionName = "Таласская область"

            },
            new ZAGSInfo
            {
                Id = 13320659,
                Name = "Учреждение \"Айыл окмоту Тюгель-Сайского айылного аймака\"",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320660,
                Name = "Учреждение \"Айыл окмот Таш-Добонского айылного аймака\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36667400,
                Name = "Кыргыз-Кыштакский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13893654,
                Name = "Байтикский айылный аймак",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320520,
                Name = "Бостеринский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320623,
                Name = "Баш-Дебенский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320685,
                Name = "Учкунский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320622,
                Name = "Шамалды-Сай айыл окмоту г.Таш-Кумыр Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 15787797,
                Name = "Логвиненовский сельский совет, Кантского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320507,
                Name = "Айыл окмоту Ак-Шыйракского айыльного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320510,
                Name = "Айыл окмоту Жаргылчакского айылного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320529,
                Name = "Айыл окмоту Оруктинского айылного аймака",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320532,
                Name = "Айыл окмоту Кол-Торского айылного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320535,
                Name = "Кунчыгышский айыл окмоту",
                RegionName = "Неизвестная область"

            },
            new ZAGSInfo
            {
                Id = 13320541,
                Name = "Иссык-Кульский айыл окмоту",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320550,
                Name = "Тюпский айыл окмоту",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320572,
                Name = "Учреждение \"Жаны-Жолский айыл Окмоту Жаны-Жолского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320558,
                Name = "1-Майский айыл окмоту, 1-Майского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320596,
                Name = "Учреждение \"Ленинский айыл Окмоту Ленинского айылного аймака\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320601,
                Name = "Учреждение \"Ырысский айыл Окмоту Ырысского айылного аймака",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320610,
                Name = "Учреждение \"Ничке-Сайский айыл Окмоту Ничке-Сайского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320593,
                Name = "Кок-Артский айылный окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320613,
                Name = "Учреждение \"Уч-Терекский айыл Окмоту Уч-Терекского айылного аймака\"",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320624,
                Name = "Территориальное управление поселка Сары-Бээ",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320633,
                Name = "Учреждение \"Айыл окмот Жерге-Тальского айылного аймака\"",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320617,
                Name = "Каныш-Кийский сельский совет Чаткальского района Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320569,
                Name = "Кенешский айыл окмоту, Базар-Коргонского района,  Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320676,
                Name = "Учреждение \"Айыл окмот Доболинского айыльного аймака\"",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320677,
                Name = "Учреждение \"Айыл окмот Жан-Булакского айылного аймака\"",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320711,
                Name = "Кетерминский айыл окмоту ",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320723,
                Name = "Гульчинский айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320734,
                Name = "Алля-Анаровский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320735,
                Name = "Араванский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320748,
                Name = "Кызылсууский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320779,
                Name = "Каракульджинский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320780,
                Name = "Кызылджарский айыл окмоту",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320786,
                Name = "Акжарский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320787,
                Name = "Башдобо айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320799,
                Name = "Кызылтооский айыл окмоту ",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320807,
                Name = "Чон-Алайский айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320808,
                Name = "\"Акчийский айыл окмоту\" Акчийского айыльного окружного кенеша Карабууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 43165025,
                Name = "Ак-Суйский сельский совет Московского района",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320813,
                Name = "\"Кара-Бууринский айыл окмоту\" Кара-Бууринского айыльного аймака Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320822,
                Name = "\"Бакай-Атинский айыл окмоту\" Ленинпольского айыльного аймака Бакай-Атинского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320830,
                Name = "\"Покровский айыл окмоту\" Покровского айыльного аймака Манасского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320835,
                Name = "\"Кок-Ой айыл окмоту\" Кок-Ойского айыльного округа Таласского района",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320852,
                Name = "Учреждение \"Кокжарский айыл окмоту Кокжарского айыльного округа Аламудунского района Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36667648,
                Name = "Уч-Коргонский сельский совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667775,
                Name = "Которминский сельский совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320855,
                Name = "Учреждение \"Маевский айыл окмоту\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320873,
                Name = "Учреждение \"Люксембургский айыл окмоту\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36667932,
                Name = "Марказский сельский совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 43998537,
                Name = "отдел ЗАГС г. Чолпон-Ата",
                RegionName = "Иссык-Кулская область"
            },
            new ZAGSInfo
            {
                Id = 13320892,
                Name = "Орловский поселковый окмоту",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320899,
                Name = "А.Дуйшеевский айыл окмоту",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320919,
                Name = "Учреждение \"Панфиловский айыл окмоту Панфиловского аильного округа Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320922,
                Name = "Ат-Башинский айыл окмоту",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320914,
                Name = "Целинный айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320913,
                Name = "Тюлекский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320872,
                Name = "Кочкорбаевский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13330077,
                Name = "Сакалды айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13330081,
                Name = "Сакалды айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13334970,
                Name = "Ак-Жол айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13566296,
                Name = "Тайгараев айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13566721,
                Name = "Кыз-Кольский айыл окмоту",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13582751,
                Name = "Кадамжайская поселковая управа",
                RegionName = "Ошская область"

            },
            new ZAGSInfo
            {
                Id = 13591505,
                Name = "Дургонду айыл окмоту",
                RegionName = "Жалал-Абадская область"

            },
            new ZAGSInfo
            {
                Id = 13645086,
                Name = "Түгөлсайский айыл окмоту",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13645087,
                Name = "Көк-Өй айыл окмоту, Нарынская область",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320951,
                Name = "Жапалак айыл окмоту, г.Ош",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320502,
                Name = "Айыл окмоту Теплоключенского айылного аймака",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320934,
                Name = "Новопавловский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 15760292,
                Name = "Чон-Арыкский айыл окмоту",
                RegionName = "г. Бишкек"
            },
            new ZAGSInfo
            {
                Id = 17707924,
                Name = "Кун-Батыш айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 36694496,
                Name = "Чаувайский п/совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36696391,
                Name = "Алгинский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320869,
                Name = "Ысык-Атинский айыл окмоту, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 17807032,
                Name = "Толойкон айыл окмоту, Кара-Сууйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 18605996,
                Name = "Копуро-Базар айыл окмоту, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 19636598,
                Name = "Ызарский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 18696050,
                Name = "Орукту айыл окмоту Иссык-Кульского района Иссык-Кульской области",
                RegionName = "Иссык-Кулькая область"
            },
            new ZAGSInfo
            {
                Id = 13320798,
                Name = "Кызыл-Октябрьский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 18612937,
                Name = "Жаны-Жерский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 20133818,
                Name = "село Романовка, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320595,
                Name = "Кызыл-Тууйски айыл окмоту, Таласский район, Таласская область",
                RegionName = " Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320503,
                Name = "Челпекский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кулькая область"
            },
            new ZAGSInfo
            {
                Id = 20559692,
                Name = "Торогелди Балтагуловский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320587,
                Name = "Сакалдинский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320760,
                Name = "Кара-Ташский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320769,
                Name = "Он-Эки-Бельский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 18605981,
                Name = "Кызыл-Тоо айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320682,
                Name = "Мин-Булакский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320700,
                Name = "Маргунский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320717,
                Name = "Кыргыз-Кыштакский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320916,
                Name = "Вознесеновский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320878,
                Name = "Тузский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 21305367,
                Name = "Ак-Булакский айыл окмоту, г.Кызыл-Кия, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 21904580,
                Name = "Кок-алмийский айыл окмоту, Базар-Коргонского района, Жалал-абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320625,
                Name = "Территориальное управление поселка Кетмен-Тобо, г.Каракуль, Жалал-абадская область",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 22875047,
                Name = "Октябрьский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320815,
                Name = "Чолпонбайский айыл окмоту (Чымкент), Кара-Бууринского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320573,
                Name = "Ак-Сууский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320582,
                Name = "Бургондинский айыл окмоту, Ноокенского район, Жалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 23874735,
                Name = "Кашка-Жолский айыл окмоту, Кара-Кулжинского района, ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 33077219,
                Name = "Поселковый совет Орто - Токой",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 33332264,
                Name = "Кок - Жарский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 33603458,
                Name = "Исфанинский сельский совет с.Исфана",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 33967184,
                Name = "Привокзальный айыл окмоту",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 33787446,
                Name = "Бирликский айыл окмоту, Фрунзенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 14693942,
                Name = "Кызыл-Жарский айыл окмоту, г. Таш-Кумыр, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34356376,
                Name = "Джекенский айыл окмоту, Жайылского района, Чуйской области"
            },
            new ZAGSInfo
            {
                Id = 34356405,
                Name = "Алтынский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356472,
                Name = "Буденский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356256,
                Name = "Үч-Дөбө айыл окмоту Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320909,
                Name = "Первомайский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356333,
                Name = "Бөжөй айыл окмоту Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320691,
                Name = "Торт-Гул айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 34356519,
                Name = "Калининский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356567,
                Name = "Алексеевский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356578,
                Name = "Новониколаевкий айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356615,
                Name = "Ставрополовкий айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356639,
                Name = "Петропавловкий айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 34356718,
                Name = "Молтаварский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320907,
                Name = "Беловодский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 20562592,
                Name = "Ак-Чийский айыл окмоту, Ак-Талиского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 33937768,
                Name = "Ленин айыл окмоту, Сузакского район, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34591683,
                Name = "Бек-Абад айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320498,
                Name = "Октябрьский айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320629,
                Name = "Баетовский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 34591463,
                Name = "Благовещенка айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34591969,
                Name = "Чука - Тюбинский айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34592162,
                Name = "Джийденский айыл окмоту, Сузакского района, Джалал - Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34592172,
                Name = "Таштакский айыл омоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645700,
                Name = "Ак-Мечетский айыл окмоту, Сузакского района, Жалал-Абадской облсти",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645717,
                Name = "Чагыр-Ташский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645728,
                Name = "Ичинский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645748,
                Name = "Молотовский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645770,
                Name = "Большевикский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 34645780,
                Name = "Кумуш-Азизский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320599,
                Name = "Сузакский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 36259043,
                Name = "Хайдарканская поселковая управа Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 35035430,
                Name = "Бординский поселковый совет-Кеминского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320860,
                Name = "Таш-Добонский айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320666,
                Name = "Кочкорский айыл окмоту Кочкорского района Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 36258834,
                Name = "Которминский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36258906,
                Name = "Сельский совет Кара - Добо Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259288,
                Name = "Кыргыз - Кыштакский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259476,
                Name = "Ак-Турпакский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320853,
                Name = "Лебединовский айыл окмоту Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 36259591,
                Name = "Уч-Коргонский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259696,
                Name = "Майданский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259915,
                Name = "Марказский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36259989,
                Name = "Орозбековский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260043,
                Name = "Фрунзенский рай. ЗАГС Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260104,
                Name = "Фрунзенская поселковая управа Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260167,
                Name = "Кадамжайский поселковый совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260261,
                Name = "Бирликский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260314,
                Name = "Чувайский поселковый совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36260381,
                Name = "Советский поселковый совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36263347,
                Name = "Баткенский сельский совет Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36263438,
                Name = "Жаны-Жерский сельский совет Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36588296,
                Name = "Алгинский сельский coвет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36298067,
                Name = "Ак-Чийский айыл окмоту Ак-Талинского района Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320875,
                Name = "Сын-Ташский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 16749885,
                Name = "Архангельский айыл окмоту, Сузакского района, Джалал-Абадская области",
                RegionName = "Жала-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320555,
                Name = "Тайгараев айыл окмоту, г.Джалал-Абад Джалал-Абадской области",
                RegionName = "Жала-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320560,
                Name = "Көк-Таш айыл окмоту Баткенского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36641136,
                Name = "Халмионский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666291,
                Name = "Халмионский сельский совет Фрунзенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666712,
                Name = "Айдаркенский п/совет Кадамжайского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666753,
                Name = "Айдаркенский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666833,
                Name = "Кадамжайский п/совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666856,
                Name = "Кадамжайский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666931,
                Name = "Чаувайский п/совет Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666938,
                Name = "Чаувайский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36666959,
                Name = "Советский п/совет Кадамжайского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 36666992,
                Name = "Советский п/совет Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667044,
                Name = "Ак-Турпакский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667094,
                Name = "Бирликский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667293,
                Name = "Майданский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 36667326,
                Name = "Орозбековский айыл окмоту Кадамжайского района Ошской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320809,
                Name = "Бейшекенский айыл окмоту Кара-Бууринского р-а Таласской обл",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320662,
                Name = "Кызыл-Жылдызский акыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320661,
                Name = "Чаекский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 36979594,
                Name = "Ак-Шыйракский айылный аймак Жети-Огузского района Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 37273338,
                Name = "Кара-Суйский поссовет Баткенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 37273491,
                Name = "Раут-Каутский сельский совет Баткенского района Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 37273547,
                Name = "Зардалинский сельский совет Баткенского района г.Бишкек",
                RegionName = "г. Бишкек"
            },
            new ZAGSInfo
            {
                Id = 20525868,
                Name = "Берю-Башский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320518,
                Name = "Тамгинский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320580,
                Name = "Уч-Коргонский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 39625821,
                Name = "Пристань-Пржевальский а/к  г.Каракол Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 41491609,
                Name = "Чон-Арыкский сельский совет Аламудунского района",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 38621499,
                Name = "Кодулский сельсовет Токтогульского района  Джалал-Абадской области"
            },
            new ZAGSInfo
            {
                Id = 13320756,
                Name = "Толойконский айыл окмоту, Кара-Суйского района, Ошской области"
            },
            new ZAGSInfo
            {
                Id = 44099962,
                Name = "с.Кетмень-Тюбе, Токтогульского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320915,
                Name = "Чапаевский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 44716613,
                Name = "Чырпыктинский сельский совет Иссык-Кульского района",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320609,
                Name = "Кызыл-Озгорүшский айыл окмоту, Уч-Терекский зональный отдел ЗАГС Токтогульского района, Жалал-Абадской области",
                RegionName = "Жалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 45803028,
                Name = "Торт-Кульский с/с Жети-Огузского района Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320519,
                Name = "Ананьевский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320738,
                Name = "Тепе-Коргонский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320845,
                Name = "Ак-Дебенский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320846,
                Name = "Ала-Арчинский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320851,
                Name = "Кара-Джыгачский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320884,
                Name = "Ак-Башатский айыл окмоту,  Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320883,
                Name = "Кызыл - Дыйканский айыл окмоту,  Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320564,
                Name = "Арстанбапский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320566,
                Name = "Могольский айыл окмот, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320562,
                Name = "Базар-Коргонский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320579,
                Name = "Жерге-Тальский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320584,
                Name = "Массынский айыл окмоту, Нокенского района, Джалал-Абаской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320552,
                Name = "Ак-Булакский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 15804570,
                Name = "Люксембургский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320551,
                Name = "Чон-Ташский айыл омоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320508,
                Name = "Барскоонский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320576,
                Name = "Кош-Добойский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320739,
                Name = "Нурабадский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320517,
                Name = "Светлополянский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320525,
                Name = "Тамчынский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320530,
                Name = "Чон-Сары-Ойский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320542,
                Name = "Кутургинский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320546,
                Name = "Сарыбулакский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320534,
                Name = "Болот Мамбетовский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320568,
                Name = "Талдуу-Булакский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320581,
                Name = "Аралский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320588,
                Name = "Шайданский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320611,
                Name = "Кетмень-Дебенский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320583,
                Name = "Достукский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320607,
                Name = "Бель-Алдынский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320557,
                Name = "Оруктунский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320571,
                Name = "Авлетимский айыл окмоту, Аксыйского района, ДжалалАбадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320728,
                Name = "Ленинский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320604,
                Name = "Каргалыкский айыл окмоту, Тогуз-Тороуского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320630,
                Name = "Терекский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320634,
                Name = "Кош-Дебенский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320639,
                Name = "Угутский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320643,
                Name = "Ак-Талинский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320651,
                Name = "Баш-Куугандынский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320654,
                Name = "Кабакский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320640,
                Name = "Ак-Джарский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320663,
                Name = "Мин-Кушский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320628,
                Name = "Ак-Чийский айылный аймак, Кара-Бууринского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320644,
                Name = "Баш-каинды айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320720,
                Name = "Алайский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320668,
                Name = "Кум-Дюбинский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320729,
                Name = "Талды-Сууский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320726,
                Name = "Кабылан-Колский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320736,
                Name = "Мангытский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320737,
                Name = "Керме-Тооский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320670,
                Name = "Семиз-Бельский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320675,
                Name = "Ак-Кудукский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320681,
                Name = "Эмгекчильский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320715,
                Name = "Уч-Коргонский айыл окмоту, Манасского района, Таласской области",
                RegionName = "Талаская область"
            },
            new ZAGSInfo
            {
                Id = 13320688,
                Name = "Сары-Ойский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарыская область"
            },
            new ZAGSInfo
            {
                Id = 13320692,
                Name = "Кара-Бакский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320710,
                Name = "Абсамат Масалиевский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320693,
                Name = "Кара-Булакский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320742,
                Name = "Ак-Ташский айыл окмоту, Кара-суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320750,
                Name = "Наримановский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320754,
                Name = "Савайский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320765,
                Name = "Зулпуевский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320705,
                Name = "Сумбулинский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320699,
                Name = "Бешкентский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320764,
                Name = "Кыргызатинский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320758,
                Name = "Бельский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320733,
                Name = "Сары-Ташский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320771,
                Name = "Мирмахмудовский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320775,
                Name = "Капчыгайский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320781,
                Name = "Ылайталинский айыл окмоту,  Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320793,
                Name = "Ийрисууский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320796,
                Name = "Кароолский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320801,
                Name = "Мырзаке айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320810,
                Name = "Бакыянский айыльный аймак, Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320812,
                Name = "Бакайырский айыл окмоту, Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320817,
                Name = "Маймакский айыл окмоту, Кара-Бууринского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320819,
                Name = "Боо-Терекский айыл окмоту, Бакай-атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320821,
                Name = "Кен-Аральский айыльный аймак Бакай-Атинского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320826,
                Name = "Ороcкий айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320828,
                Name = "Киргизия айыл окмоту, Манасского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320832,
                Name = "Арал айыл окмоту, Таласского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320850,
                Name = "Грозденский айыл окмоту, Грозденского аильного округа, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320868,
                Name = "Интернациональный айыл окмоту, Ысык-Атинского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320857,
                Name = "Октябрьский айыл окмоту, Аламудунского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320854,
                Name = "Ленинский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320862,
                Name = "Ак-Кудукский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320863,
                Name = "Бирдикский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320864,
                Name = "Ивановский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320866,
                Name = "Жээкский айыл окмоту, Ысык-Атинского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320840,
                Name = "Осмонкуловский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320842,
                Name = "Куугандинский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320834,
                Name = "Долонский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320824,
                Name = "Озгорушский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320876,
                Name = "Новопокровский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320877,
                Name = "Юрьевский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320879,
                Name = "Узун-Кырский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320881,
                Name = "Кара-Сууский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320886,
                Name = "Суусамырский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320889,
                Name = "Сосновский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320908,
                Name = "Петровский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320911,
                Name = "Садовский айыл окмоту, Московского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320923,
                Name = "Тош-Булакский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320926,
                Name = "Жаны-Джерский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320928,
                Name = "Камышановский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320930,
                Name = "Кунтууский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320932,
                Name = "Кызыл-Тууский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320918,
                Name = "Ортоевский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320920,
                Name = "Фрунзенский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320905,
                Name = "Александровский айыл окмоту, Московского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320910,
                Name = "Предтеченский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320903,
                Name = "Ак-Тюзский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320901,
                Name = "Чым-Коргонский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320896,
                Name = "Ильичевский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320917,
                Name = "Курпульдекский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320515,
                Name = "Кызыл-Сууский айыл окмоту,Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320648,
                Name = "Кара-Коюнский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320859,
                Name = "Пригородный айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320942,
                Name = "Буранинский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320948,
                Name = "Сайлыкский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320945,
                Name = "Кегетинский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320936,
                Name = "Орокский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320937,
                Name = "Первомайский айыл окмоту, Сокулукского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320939,
                Name = "Фрунзенский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320925,
                Name = "Гавриловский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320499,
                Name = "Отрадненсий айыл окмоту, Ак-Суйского район, Иссык-Кульской Область",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320538,
                Name = "Улаколский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13329322,
                Name = "Кенеш айыл окмот, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320495,
                Name = "Караколский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320494,
                Name = "Кара-Джалский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320627,
                Name = "Ак-Талский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320766,
                Name = "Исанова айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320704,
                Name = "Кулундинский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320619,
                Name = "Сумсарский айыл окмоту, Чаткальского район, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 20108205,
                Name = "г. Кант, Ысык-Атинский район, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13946534,
                Name = "Кочкор-Атинский гор-управление, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320861,
                Name = "Таш-Мойнокский айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320493,
                Name = "Берю-Башский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320578,
                Name = "Кара-Сууйский айыл окмоту, Кара-Сууйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 17731405,
                Name = "Тугол-Сайский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320694,
                Name = "Кыш АО (Дубликат)",
                RegionName = "Неизвестная область"
            },
            new ZAGSInfo
            {
                Id = 13320847,
                Name = "Аламудунский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 17756394,
                Name = "Кыргызстанский айыл окмоту,  Манаского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320849,
                Name = "Васильевский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 18617453,
                Name = "Мэрия г.Орловка, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320649,
                Name = "Кара-Суу айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 19744880,
                Name = "Кара-Суу айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 19771654,
                Name = "Пристань-Пржевальск поселковый кенеш г.Каракол Иссык-Кульская область",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320575,
                Name = "Кашка-Суу айыл окмоту, Чон-Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320506,
                Name = "Ак-Дюбинского Айыл окмоту, Аламудинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320848,
                Name = "Арашанский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320946,
                Name = "Кош-Коргонский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320949,
                Name = "Чуйский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 18238406,
                Name = "Кызыл-Октябрьский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320665,
                Name = "Кара-Сууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320743,
                Name = "Жаны-Арык айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 18995975,
                Name = "Первомайский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320890,
                Name = "Степнинская айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 20175483,
                Name = "Ат-Башы айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320638,
                Name = "Кок-Жарский айылный аймак, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320540,
                Name = "Аралский айыл окмоту, Тюпского района, Иссыкульской области",
                RegionName = "Иссы-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320671,
                Name = "Талаа-Булак  айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320496,
                Name = "Кереге-Ташский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320900,
                Name = "Кызыл-Октябрьский айыл окмоту, Ак-Сууйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20471180,
                Name = "Отрадненский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320500,
                Name = "Ак-Чийский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20218342,
                Name = "Кичи-Кеминский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320501,
                Name = "Тепкенский айыл окмоту, Ак-суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20156353,
                Name = "Мэрия г.Кербен, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320505,
                Name = "Жергаланский айыл окмоту, Ак-суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320547,
                Name = "Ак-Булунский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320497,
                Name = "Боз-Учукский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20474876,
                Name = "Жыргаланский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320504,
                Name = "Энильчекский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320509,
                Name = "Дарканский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20475366,
                Name = "Джаргылчакский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320513,
                Name = "Липенский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320514,
                Name = "Оргочорский айыл окмоту, Жети-Огузской района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320522,
                Name = "Кара-Ойский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320524,
                Name = "Семеновский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320526,
                Name = "Абдрахмановский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320528,
                Name = "Тору-Айгырский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 20477878,
                Name = "Орюктинский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320940,
                Name = "айыл окмоту им.З.Кайназаровой, Сокулукского района, Чуйской области\"",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320882,
                Name = "Красновосточный айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 20532532,
                Name = "Кель-терский айыл окмоту, Тонского района, Иссыкульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320673,
                Name = "Чолпонский айылный аймак, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320548,
                Name = "Талды-Сууский айыл окмоту, Тюпского района, Иссыкульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320531,
                Name = "Ак-Терекский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320533,
                Name = "Кек-Мойнокский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320536,
                Name = "Тонский Айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320804,
                Name = "Терт-Кульский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320539,
                Name = "Каджи-Сайский айыл окмоту, Тонского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 20558926,
                Name = "Иссык-Кельский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320543,
                Name = "Михайловский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320706,
                Name = "Тогуз-Булакский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320545,
                Name = "Сан-Ташский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320783,
                Name = "Сары-Булакский айыл окмоту, Тюпского района, Иссык-Кульской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320549,
                Name = "Карасаевский айыл окмоту, Тюпского района, Иссык-КУльской области",
                RegionName = "Иссыкульская область"
            },
            new ZAGSInfo
            {
                Id = 13320561,
                Name = "Акманский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320565,
                Name = "Кызыл-Ункюрский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320722,
                Name = "Бюлелинский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320724,
                Name = "Джошолунский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320725,
                Name = "Конур-Добонский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320554,
                Name = "Ак-Тамский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320727,
                Name = "Корульский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20560389,
                Name = "Сайдыкумский айыл окмоту, Базар-Коргонского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320730,
                Name = "Сары - Моголский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320731,
                Name = "Уч-Дебенский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320608,
                Name = "Джаны-Джольский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320574,
                Name = "Кара-Жыгачский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320744,
                Name = "Жоошский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"

            },
            new ZAGSInfo
            {
                Id = 20560882,
                Name = "Мавляновский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320570,
                Name = "Ак-Жолский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 20560950,
                Name = "Кызыл-Тууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = " Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320741,
                Name = "Чек-Абадский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320740,
                Name = "Тео-Моюнский айыл окмоту, Араванского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320650,
                Name = "Талды-Сууский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320732,
                Name = "Жаны-Алайский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320698,
                Name = "Ак-Сууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320745,
                Name = "Катта-Талдыкский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20560156,
                Name = "Алайский айылный аймак им.К.Белекбаева, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320749,
                Name = "Мадынский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320585,
                Name = "Момбековский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320751,
                Name = "Отузадырский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320586,
                Name = "Ноокенский айыл окмоту, Ноокенского района, Джалал-Абадской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320752,
                Name = "Сары-Колотский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320753,
                Name = "Папанский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320755,
                Name = "Сарайский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320757,
                Name = "Шаркский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320759,
                Name = "Гюльстанский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320784,
                Name = "Чалминский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320747,
                Name = "Кызыл-Кыштак айыл окмоту, Кара-Сууйского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320721,
                Name = "Будалыкский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320833,
                Name = "Джерге-Талский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320605,
                Name = "Сары-Булунский айыл окмоту, Тогуз-Торинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320602,
                Name = "Атайский айыл окмоту, Тогуз-Торинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 15732723,
                Name = "Курама айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320614,
                Name = "Аралбаевский (Толукский) айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320612,
                Name = "Сары-Камышский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320618,
                Name = "Чаткальский айыл окмоту, Чаткальского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320620,
                Name = "Терек-Сайский айыл окмоту, Чаткальского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320631,
                Name = "Кара-Бюргенский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320632,
                Name = "Конорчокский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320635,
                Name = "Кызыл-Белесский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 20562849,
                Name = "Джаны-Талапский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320615,
                Name = "Суеркуловский (Торкенский) айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320761,
                Name = "Кулатовский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320762,
                Name = "Джаны-Ноокатский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320637,
                Name = "Тоголок-Молдоский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320768,
                Name = "Кек - Джарский айыл окмоту, Ак-Талинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320767,
                Name = "Кок-Бельский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320641,
                Name = "Ак-Моюнский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320642,
                Name = "Ак-Музский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320645,
                Name = "Ача-Каиндинский айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320647,
                Name = "Казыбекский  айыл окмоту, Ат-Башинского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320773,
                Name = "Найманский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320774,
                Name = "Алайкууский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320776,
                Name = "Кенешский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320621,
                Name = "Кызыл-Жарский айылный аймак, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563379,
                Name = "Джаны-Арыкский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320782,
                Name = "Ой-Талский айыл окмоту,  Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320653,
                Name = "Джумгальский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320888,
                Name = "Сары-Булакский айылный аймак, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320763,
                Name = "Кенешский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320777,
                Name = "Карагузский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320656,
                Name = "Байзаковский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320657,
                Name = "Куйручукский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320770,
                Name = "Төөлөсский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320658,
                Name = "Чон-Добонский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 20563629,
                Name = "Баш-Дебенский айылный аймак, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563676,
                Name = "Тугол-Сайский айыл окмоту, Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320789,
                Name = "Жылалдынский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320790,
                Name = "Ден-Булакский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320794,
                Name = "Чангетский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320795,
                Name = "Кара-Ташский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563918,
                Name = "Кызыл-Октябрьский айылный аймак, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320664,
                Name = "Ак-Кыянский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320785,
                Name = "Чалминский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563799,
                Name = "Суюмбаевский айыл окмоту (Таш-Добо), Жумгальского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320802,
                Name = "Алтынбулакский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320797,
                Name = "Кельдюкский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320791,
                Name = "Заргерский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20563101,
                Name = "Кызыл-Октябрьский айыл окмоту (Кок-Жар), Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320667,
                Name = "Кош-Дебенский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320803,
                Name = "Саламаликский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320669,
                Name = "Сары-Булакский айыл окмоту, Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320805,
                Name = "Жекендийский айылный аймак, Чон-Алайского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320811,
                Name = "Аманбаевский айыл окмоту,Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 20564374,
                Name = "Дебелинский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 20564448,
                Name = "Джан-Булакский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320814,
                Name = "Кок-Сайский айыл окмоту,  Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 20564528,
                Name = "Джергеталский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320816,
                Name = "Шекерский айыл окмоту, Кара-Бууринского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320818,
                Name = "Шадыканский айыл окмоту, Бакай-атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320679,
                Name = "Казан-Куйганский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320680,
                Name = "Кара-Куджурский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320823,
                Name = "Мин-Булакский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320825,
                Name = "Ак-Добонский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320827,
                Name = "Каиндинский айыл окмоту, Манасского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320683,
                Name = "Он-Арчинский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320829,
                Name = "Майский айыл окмоту, Манасского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320684,
                Name = "Ортокский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320686,
                Name = "Чет-Нуринский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320687,
                Name = "Эмгек-Талинский айыл окмоту, Нарынского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320841,
                Name = "Омуралиевский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320839,
                Name = "Бердике-Баатырский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320838,
                Name = "Нуржановский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320843,
                Name = "Кара-Сууйский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320836,
                Name = "Бекмолдоевский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320858,
                Name = "Байтик айыл окмоту,  Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13894405,
                Name = "Маевский айылный аймак, Аламудунского района",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320690,
                Name = "Дарыинский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 20565487,
                Name = "Кыштутский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320695,
                Name = "Самаркандекский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320702,
                Name = "Лейлекский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320701,
                Name = "Джаны-Джерский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 14071519,
                Name = "Ак-Татырский айыл окмоту, Баткенского района,  Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320856,
                Name = "Нижне-Аларчинский айыл окмоту, Аламудунского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320713,
                Name = "Марказский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320941,
                Name = "Ак-Бешимский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320943,
                Name = "Искринский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320944,
                Name = "Ибраимовский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320947,
                Name = "Онбир-Джылгинский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320714,
                Name = "Орозбековский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320709,
                Name = "Бирликский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 20566168,
                Name = "Которминский айыл окмоту Кадамжайского района Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320708,
                Name = "Алгинский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320719,
                Name = "Чаувайский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320718,
                Name = "Советский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320707,
                Name = "Ак-Турпакский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320904,
                Name = "Ак-Сууский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320703,
                Name = "Катранский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320544,
                Name = "Тогуз-Булакский айыл окмоту, Лейлекского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 13320950,
                Name = "Шамшынский айыл окмоту, Чуйского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320924,
                Name = "Военно-Антоновский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320927,
                Name = "Джаны-Пахтинский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320933,
                Name = "Нижне-Чуйский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320935,
                Name = "Сазский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320938,
                Name = "Сокулукский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320929,
                Name = "Асылбашский айыл окмоту, Сокулукского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320870,
                Name = "Краснореченский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320867,
                Name = "Кен-Булунский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320874,
                Name = "Милянфанский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320880,
                Name = "Жайылский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320921,
                Name = "Чалдыбарский айыл окмоту, Панфиловского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320906,
                Name = "Беш-Терекский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320885,
                Name = "Полтавский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320912,
                Name = "Сретенский айыл окмоту, Московского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320887,
                Name = "Сарыкооский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320902,
                Name = "Чон-Кеминский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320891,
                Name = "Талды-Булакский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320894,
                Name = "Боролдойский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320893,
                Name = "Алмалинский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320559,
                Name = "им. Т.Балтагулова айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320674,
                Name = "Сон-Кульский айыл окмоту (Телек), Кочкорского района, Нарынской области",
                RegionName = "Нарынская область"
            },
            new ZAGSInfo
            {
                Id = 13320626,
                Name = "Заргерский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320792,
                Name = "Жазыйский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 20875144,
                Name = "Сары-Булакский айыл окмоту, Жайылского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320820,
                Name = "Акназаровский айыл окмоту, Бакай-Атинского района, Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 21864115,
                Name = "Ноокатский городской кенеш, Ноокатского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320606,
                Name = "Тогуз-Тороуский айылный аймак, Тогуз-Тороузского района, Жалал-абадской области",
                RegionName = "Жалал-абадская область"
            },
            new ZAGSInfo
            {
                Id = 13320895,
                Name = "Жаны-Алышский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320778,
                Name = "Кара-Кочкорский айыл окмоту, Кара-Кулжинского района, Ошской области",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320516,
                Name = "Алдашевский айыл окмоту(Саруу), Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320689,
                Name = "Достукский айыл окмоту, Ноокенского района, Жалал-Абадского области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 13320898,
                Name = "Көк-Ойрокский айыл окмоту, Кеминского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 28565615,
                Name = "Ала-Букинский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 20539682,
                Name = "Ак-Булунский айыл окмоту, Ак-Суйского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская область"
            },
            new ZAGSInfo
            {
                Id = 33967200,
                Name = "Кызыл-Аскерский айыл окмоту",
                RegionName = "Ошская область"
            },
            new ZAGSInfo
            {
                Id = 13320563,
                Name = "Бешик-Жонский айыл окмоту Базар-Коргонского района Джалал-Абадской области",
                RegionName = "Джалал-Абадская область"
            },
            new ZAGSInfo
            {
                Id = 33967175,
                Name = "Чон-Арыкский айыл окмоту Ленинского района г.Бишкек",
                RegionName = "г. Бишкек"
            },
            new ZAGSInfo
            {
                Id = 13320672,
                Name = "Кок-Жарский айыл окмоту, Аламудунского района, Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 13320844,
                Name = "Калбинский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13320837,
                Name = "Айдаралиевский айыльный аймак Таласского района Таласской области",
                RegionName = "Таласская область"
            },
            new ZAGSInfo
            {
                Id = 13585633,
                Name = "Мэрия г.Айдаркен Кадамжайского района, Баткенской области",
                RegionName = "Баткенская область"
            },
            new ZAGSInfo
            {
                Id = 18595164,
                Name = "Мэрия г. Шопокова Сокулукского района Чуйской области",
                RegionName = "Чуйская область"
            },
            new ZAGSInfo
            {
                Id = 33967310,
                Name = "Кара-Алма айыл окмоту, Сузакского района, Джалал - Абад области",
                RegionName = "Джалал - Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320871,
                Name = "Логвиненковский айыл окмоту, Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320865,
                Name = "Нурманбетский айыл окмоту,  Ысык-Атинского района, Чуйской области",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320931,
                Name = "айыл окмоту им. Крупской, Сокулукского района, Чуйской области",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320523,
                Name = "Кум-Бельский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 13320521,
                Name = "Садыр аке айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 20112155,
                Name = "Калининский айыл окмоту, Алайского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320696,
                Name = "Ак-Сайский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 20565332,
                Name = "Торт-Гульский айыл окмоту  Баткенского района  Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320716,
                Name = "Халмионский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320527,
                Name = "Темировский айыл окмоту, Иссык-Кульского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 13320678,
                Name = "Жергетальский айыл окмоту, Таласского района, Таласской области",
                RegionName = "Таласская  область"
            },
            new ZAGSInfo
            {
                Id = 13320603,
                Name = "Кок-Иримский айыл окмоту, Тогузтороузского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320590,
                Name = "Барпынский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320594,
                Name = "Кыз-Кельский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320598,
                Name = "Сайпидин-Атабековский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320589,
                Name = "Курманбекский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320591,
                Name = "Кара-Алминский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320597,
                Name = "Багышский айыл окмоту, Сузакского района, Жалал-абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 30678347,
                Name = "Ырысский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320577,
                Name = "Кызыл-Тууский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320600,
                Name = "Таш-Булакский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Джалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 46540372,
                Name = "Чыракский сельский совет Жети-Огузского района",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 46811068,
                Name = "Темен-Суйский сельский совет Московского района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 46811165,
                Name = "Кош-Тюбинский сельский совет Московского района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 47388375,
                Name = "Петровский сельский совет Московского  района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 48410811,
                Name = "Ак-Кульский сельский совет Жумгальского района",
                RegionName = "Нарынская  область"
            },
            new ZAGSInfo
            {
                Id = 13320511,
                Name = "Джети-Огузский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 50025884,
                Name = "Боз-Бешикский сельский совет Жети-Огузского района",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 50831848,
                Name = "Ленинский с/с  Кок-Артского зонального ЗАГС в Сузакском  районе",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 50997218,
                Name = "Ак-Суусский горсовет Московского района",
                RegionName = "Чуйская  область"
            },
            new ZAGSInfo
            {
                Id = 13320512,
                Name = "Ырдыкский айыл окмоту, Жети-Огузского района, Иссык-Кульской области",
                RegionName = "Иссык-Кульская  область"
            },
            new ZAGSInfo
            {
                Id = 13320897,
                Name = "Кара-Булакский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320592,
                Name = "Кара-Дарыянский айыл окмоту, Сузакского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320697,
                Name = "Суу-Башинский айыл окмоту, Баткенского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320746,
                Name = "Кашгар-Кыштакский айыл окмоту, Кара-Суйского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320831,
                Name = "Уч-Коргонский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 20561865,
                Name = "Джаны-Джольский айыл окмоту, Токтогульского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13702039,
                Name = "Кызыл-Озгорушский айыл окмоту Токтогульского района Жалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320616,
                Name = "Чолпон-Атинский айыл окмоту Токтогульского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320553,
                Name = "Ак-Коргонский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320556,
                Name = "Кек-Серекский айыл окмоту, Кек-Серекского айылного аймака, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 20559730,
                Name = "Кок-Ташский айыл окмоту, Ала-Букинского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320806,
                Name = "Кашка-Сууский айыл окмоту, Аксыйского района, Джалал-Абадской области",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 13320800,
                Name = "Куршабский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320537,
                Name = "Терт-Кульский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320788,
                Name = "Жалпак-Ташский айыл окмоту, Узгенского района, Ошской области",
                RegionName = "Ошская  область"
            },
            new ZAGSInfo
            {
                Id = 13320712,
                Name = "Майданский айыл окмоту, Кадамжайского района, Баткенской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 13320772,
                Name = "Ынтымакский айыл окмоту, Ноокатского района, Ошской области",
                RegionName = "Баткенская  область"
            },
            new ZAGSInfo
            {
                Id = 51867283,
                Name = "Ак-Ташский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 51867543,
                Name = "Сары-Булакский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 51966256,
                Name = "Чандалашский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            },
            new ZAGSInfo
            {
                Id = 51966265,
                Name = "Коргон-Сайский сельский совет Чаткальского района",
                RegionName = "Жалал-Абадская  область"
            }
         };
            public class ZAGSInfo
            {
                public int Id { get; set; }
                public string Name { get; set; }
                public string RegionName { get; set; }
            }

            public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
            {
                var items = new List<ReportItem>();
                var fd = new DateTime(year, 1, 1);
                var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
                var qb = new QueryBuilder(balagaSuyunchuApp, context.UserId);

                qb.Where("PaymentSum").Eq("50000").And("BankSheet").Include("CommonNeedAmount").Include("&State").Eq(approvedStateTypeId).And("Date").Ge(fd).And("Date").Le(ld).End().End();

                SqlQuery query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                var bankSheetSrc = query.JoinSource(query.Source, bankSheetId, SqlSourceJoinType.Inner, "BankSheet");
                var summaryReportSrc = query.JoinSource(bankSheetSrc, summaryReportId, SqlSourceJoinType.Inner, "CommonNeedAmount");
                query.AddAttribute(query.Source, "&Id", SqlQuerySummaryFunction.Count);
                var zagsAttr = query.AddAttribute(query.Source, "ZagsId");
                var dateAttr = query.AddAttribute(summaryReportSrc, "Date");
                query.AddGroupAttribute(zagsAttr);
                query.AddGroupAttribute(dateAttr);

                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read())
                    {
                        var govUnit = reader.IsDbNull(0) ? 0 : reader.GetInt32(0);
                        var zagsId = reader.IsDbNull(1) ? 0 : reader.GetInt32(1);
                        var docDate = reader.IsDbNull(2) ? DateTime.MinValue : reader.GetDateTime(2);
                        var pilotZags = PilotZAGS.Where(x => x.Id == zagsId).FirstOrDefault();
                        var item = GetReportItem(items, pilotZags.Name, pilotZags.RegionName, zagsId);
                        int indexOfMonth = docDate.Month;
                        switch (indexOfMonth)
                        {
                            case 1:
                                item.January.Count += govUnit;
                                item.January.Sum = item.January.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 2:
                                item.February.Count += govUnit;
                                item.February.Sum = item.February.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 3:
                                item.March.Count += govUnit;
                                item.March.Sum = item.March.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 4:
                                item.April.Count += govUnit;
                                item.April.Sum = item.April.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 5:
                                item.May.Count += govUnit;
                                item.May.Sum = item.May.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 6:
                                item.June.Count += govUnit;
                                item.June.Sum = item.June.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 7:
                                item.July.Count += govUnit;
                                item.July.Sum = item.July.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 8:
                                item.August.Count += govUnit;
                                item.August.Sum = item.August.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 9:
                                item.September.Count += govUnit;
                                item.September.Sum = item.September.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 10:
                                item.October.Count += govUnit;
                                item.October.Sum = item.October.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 11:
                                item.November.Count += govUnit;
                                item.November.Sum = item.November.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                            case 12:
                                item.December.Count += govUnit;
                                item.December.Sum = item.December.Count * BALAGA_SUYUNCHU_PRICE;
                                break;
                        }
                    }
                }
                return items;
            }
            static ReportItem GetReportItem(List<ReportItem> items, string districtName, string regionName, int _zagsId)
            {
                var item = items.FirstOrDefault(x => x.getZagsId().Equals(_zagsId));
                if (item != null) return item;
                item = new ReportItem(districtName, regionName, _zagsId);
                items.Add(item);
                return item;
            }
            [DataContract]
            public class ReportItem
            {

                [DataMember]
                public string RegionName { get; set; }
                [DataMember]
                public string DistrictName { get; set; }
                private int ZagsId { get; set; }
                [DataMember]
                public MonthReport January { get; set; }
                [DataMember]
                public MonthReport February { get; set; }
                [DataMember]
                public MonthReport March { get; set; }
                [DataMember]
                public MonthReport April { get; set; }
                [DataMember]
                public MonthReport May { get; set; }
                [DataMember]
                public MonthReport June { get; set; }
                [DataMember]
                public MonthReport July { get; set; }
                [DataMember]
                public MonthReport August { get; set; }
                [DataMember]
                public MonthReport September { get; set; }
                [DataMember]
                public MonthReport October { get; set; }
                [DataMember]
                public MonthReport November { get; set; }
                [DataMember]
                public MonthReport December { get; set; }

                public ReportItem(string districtName, string regionName, int _zagsId)
                {
                    DistrictName = districtName;
                    RegionName = regionName;
                    ZagsId = _zagsId;
                    January = new MonthReport();
                    February = new MonthReport();
                    March = new MonthReport();
                    April = new MonthReport();
                    May = new MonthReport();
                    June = new MonthReport();
                    July = new MonthReport();
                    August = new MonthReport();
                    September = new MonthReport();
                    October = new MonthReport();
                    November = new MonthReport();
                    December = new MonthReport();
                }

                [DataContract]
                public class MonthReport
                {
                    [DataMember]
                    public int Count { get; set; }
                    [DataMember]
                    public decimal Sum { get; set; }
                }
                public int getZagsId()
                {
                    return ZagsId;
                }
            }
        }

        /*******************************************************************************************************************/
        //public static class PatientCountOfMonth_6001Old /*старый код*/
        //{
        //    public static List<ReportItem> Execute(WorkflowContext context, int year, int month)
        //    {
        //        CardsDays = new Dictionary<string, int>();
        //        return Build(context, year, month, context.UserId, context.GetUserInfo());
        //    }
        //    /*-------------------------------------Documents----------------------------------------------------------------------*/
        //    public static readonly Guid cardDefId = new Guid("{683B63E2-B0C6-470F-8A01-5D73AB145F8A}"); // PatientCard
        //    public static readonly Guid procedurDefId = new Guid("{79E864E5-7810-46F8-A2C2-E4C92B1D3290}");
        //    public static readonly Guid iprDefId = new Guid("{A1872B7D-0408-4338-B20D-42E4BDAEC2DA}");
        //    public static readonly Guid ReportDocId = new Guid("{A1C8DF40-EDCB-4DFF-AD77-F0A03D5B0C90}");
        //    public static readonly Guid ReportItemDocId = new Guid("{7033EA4A-C8AB-4A5B-BBDD-62143D864AD6}");
        //    private static readonly Guid WeekReportDefId = new Guid("{E71277B2-63E8-4F39-9771-92FDC580618B}");
        //    public static readonly Guid ApprovedDocStateId = new Guid("{66D7FA1C-77EF-470D-A70B-0D6E5E16D942}");
        //    private static readonly Guid ApplicantDefId = new Guid("{6F5B8A06-361E-4559-8A53-9CB480A9B16C}");
        //    private static readonly Guid vypiskaDefId = new Guid("{DA9CBB90-6527-41DA-A25E-690EFE24AE8A}");
        //    /*--------------------------------------------------------------------------------------------------------------------*/
        //    private static readonly Guid field1 = new Guid("{D402B05E-6906-4401-BCB1-35760C8F1CBF}");
        //    private static readonly Guid field2 = new Guid("{CA4AF527-67AE-4C49-8600-B8F84EAEB939}");
        //    private static readonly Guid field3 = new Guid("{9DF7929C-3016-4584-ABC8-5A03A714F148}");
        //    private static readonly Guid field4 = new Guid("{527F2FB1-EBCE-4BB7-92A9-699938B73A05}");
        //    private static readonly Guid field5 = new Guid("{EA23E687-7AF5-47D6-88C3-89D95C1D2773}");
        //    private static readonly Guid field6 = new Guid("{04724A1C-8842-4F09-BE51-AD6784B128EF}");
        //    private static readonly Guid field7 = new Guid("{6CE71B14-B8CB-411E-A954-2B16F6CC1A55}");
        //    private static readonly Guid field8 = new Guid("{98A4304F-2C33-40AB-A5CE-5EF9A353C7DC}");
        //    private static readonly Guid field9 = new Guid("{38872A87-3D1C-4F43-855E-7FEE6D4B1434}");
        //    private static readonly Guid field10 = new Guid("{75262FBD-6CA4-4109-8800-552C91C826A4}");
        //    private static readonly Guid field11 = new Guid("{91A6B5B6-38B0-4BA0-9DD6-FC633635B7F9}");
        //    private static readonly Guid field11_1 = new Guid("{1EFB8855-6C2A-4B25-8C00-9236CC393FE7}");
        //    private static readonly Guid field12 = new Guid("{A1CECF79-C5E4-4E7D-BDF6-72C37F796B33}");
        //    private static readonly Guid field13 = new Guid("{AEE289F4-D7D0-4FD9-82A7-3186DC047CA0}");
        //    private static readonly Guid field14 = new Guid("{383659E1-22D3-4703-9A3A-49BEA13D7645}");
        //    private static readonly Guid field15 = new Guid("{3517C817-DE1A-4D2F-93E1-EF34B022F904}");
        //    private static readonly Guid field16 = new Guid("{E11D16AE-367F-487C-8D12-F802BDFBCC38}");
        //    private static readonly Guid field17 = new Guid("{D3B6156D-9B0C-4D8B-9293-0FBC044F3642}");
        //    private static readonly Guid field18 = new Guid("{12CA4E09-0970-4B3C-87EE-25446B09F120}");
        //    private static readonly Guid field19 = new Guid("{E5313C2B-8571-4F1D-972B-152190FE7462}");
        //    private static readonly Guid field20 = new Guid("{BA504F1D-AC4A-44E8-894A-C677BF132383}");
        //    private static readonly Guid field21 = new Guid("{1F67482C-986C-4776-B299-C57A3CB6F9F4}");
        //    private static readonly Guid field22 = new Guid("{ED50C0C5-F6E8-4CA6-BEE8-6F71CBB3F3C9}");
        //    private static readonly Guid field23 = new Guid("{504886C9-D4A4-4198-84C2-E316E1E195CF}");
        //    private static readonly Guid field24 = new Guid("{F66E3355-FE3B-4C5F-8E78-E771DBCCB170}");
        //    private static readonly Guid field24_1 = new Guid("{4D4ACC4C-2CFD-4F60-9915-72E36D5EB45E}");  //ЭКГ
        //    private static readonly Guid field24_2 = new Guid("{473F4C3C-8AB9-4880-AC9B-BBB1F9B6AA05}");  //УЗДГ
        //    private static readonly Guid field24_3 = new Guid("{A6BE6905-2105-4E6F-99A6-1D05D4852AA8}");  //УЗИ 
        //    private static readonly Guid field25 = new Guid("{896796C6-BA76-404D-8B45-8DEF98FABDED}");
        //    private static readonly Guid field26 = new Guid("{B0477D17-2F03-4E95-9FC5-A4453F3E3A8E}");
        //    private static readonly Guid field27 = new Guid("{D982C076-C8B9-455D-A6D3-34F7ECB1DEAC}");
        //    private static readonly Guid field28 = new Guid("{B726E884-E163-4138-8A09-1A5E1E9383E9}");
        //    private static readonly Guid field29 = new Guid("{4B4AEA6C-3DBC-4596-AB03-A01027214D95}");
        //    private static readonly Guid field30 = new Guid("{F00753F2-1769-4C31-895F-3E5E5EBE2AE3}");
        //    private static readonly Guid field31 = new Guid("{15ADAEBD-6036-4108-9E7E-55AE491A9D89}");
        //    private static readonly Guid field32 = new Guid("{CCA0390E-A9CE-4AA7-A2DC-23F851E8D00D}");
        //    private static readonly Guid field32_1 = new Guid("{368607B0-3E6A-4426-9273-F082A90F0F5E}");
        //    private static readonly Guid field33 = new Guid("{DFC699BA-6F04-4994-91B6-4D767AA7B171}");
        //    private static readonly Guid field34 = new Guid("{89A90F92-2C2D-471F-8E45-BAAEC673094D}");
        //    private static readonly Guid field35 = new Guid("{0D6ADA32-5961-4630-A7D6-EC4A7BEDC287}");
        //    private static readonly Guid field36 = new Guid("{E382801C-E32D-43BF-B933-B12415F5C9EE}");
        //    private static readonly Guid field37 = new Guid("{A1A7455A-461B-461A-AFE7-D941189A984B}");
        //    private static readonly Guid field38 = new Guid("{DEA1DA30-D199-4429-9C40-85650881B16F}");
        //    private static readonly Guid field39 = new Guid("{0123CFF0-D8D5-4950-88C8-4CD816AFBBFF}");

        //    private static readonly Guid field40 = new Guid("{5EF451AE-91E0-4EBA-93E8-6DA84A418C07}");
        //    private static readonly Guid field40_1 = new Guid("{641366ED-AF6B-4542-9EEA-27D89961A396}");
        //    private static readonly Guid field41 = new Guid("{4C7A382F-2F3F-4F26-A555-9177130D4DDC}");
        //    private static readonly Guid field42 = new Guid("{11358616-5BE7-415D-A513-A11F4123851F}");
        //    private static readonly Guid field43 = new Guid("{55DCE035-FD2A-493C-9CD6-06EA6B7F389A}");
        //    //районы  
        //    private static readonly Guid field44 = new Guid("{F9C2EC34-2432-4512-9647-243A87CFD52E}");
        //    private static readonly Guid field45 = new Guid("{F54A1E9E-068B-46EF-9D75-FB6C39654FEB}");
        //    private static readonly Guid field46 = new Guid("{7F5F45D0-E179-42C6-A3EA-30FA107551F2}");
        //    private static readonly Guid field47 = new Guid("{81D925CF-0B63-4E05-AFD3-859DB982CF3A}");
        //    private static readonly Guid field48 = new Guid("{686B8E10-B535-4181-9246-B899A9598DEE}");
        //    private static readonly Guid field49 = new Guid("{3C0DEE8D-7F40-4EB4-8FDC-8456FBFC8E4C}");
        //    private static readonly Guid field50 = new Guid("{AF21CE80-2DC7-4958-9336-8BD1442CF5CF}");
        //    private static readonly Guid field51 = new Guid("{4E2B96A8-A5DD-44C1-8369-32BCBE18E61C}");
        //    private static readonly Guid field52 = new Guid("{91B58917-8D9E-4922-AADF-5BE9BA5D9FE8}");
        //    private static readonly Guid field53 = new Guid("{6C3ABA2D-5CD1-4E2C-BB0B-BC55ABDCFAF4}");
        //    private static readonly Guid field54 = new Guid("{56AD8CD7-641B-4E73-ADFC-F93A1C8F63CD}");
        //    private static readonly Guid field55 = new Guid("{ED3D5A89-9696-4B0C-AB58-F764C0332B76}");
        //    private static readonly Guid field56 = new Guid("{A5766D54-CB05-43EB-B3C1-CA42A1176A3A}");
        //    private static readonly Guid field57 = new Guid("{A7AF1299-988E-4836-84CF-6545B931E94F}");
        //    private static readonly Guid field58 = new Guid("{54BCFC63-926D-49B5-88D1-B3ABE7B341D6}");
        //    private static readonly Guid field59 = new Guid("{1CA5F9B0-E382-41FB-B654-F6DD7D8DCB54}");
        //    private static readonly Guid field60 = new Guid("{7A70FDD5-6123-4A90-8FCB-FBEDC7704955}");
        //    private static readonly Guid field61 = new Guid("{D99E0EDF-633E-45D0-B879-D613B21C9C75}");
        //    private static readonly Guid field62 = new Guid("{E6564BFF-B8DA-40EF-B91D-C66CC021D786}");
        //    private static readonly Guid field63 = new Guid("{9808D969-B314-4B4C-8D89-FE7F470195A1}");
        //    private static readonly Guid field64 = new Guid("{A7820FFA-070A-41AF-8C66-B308251ACB85}");
        //    private static readonly Guid field65 = new Guid("{EEA75CE5-4299-4DCE-9CA3-1E0DAD642043}");
        //    private static readonly Guid field66 = new Guid("{B81A244A-3658-444C-AB27-788D9179D53C}");
        //    private static readonly Guid field67 = new Guid("{C6949E8C-297C-4F78-8FB2-DDF9AD406A15}");
        //    private static readonly Guid field68 = new Guid("{9E9F2D55-E0E4-4231-8D41-166480986EB8}");
        //    private static readonly Guid field69 = new Guid("{128C8EAC-FE3D-47F6-B6C0-82A069CC6DB9}");
        //    private static readonly Guid field70 = new Guid("{9CCD848C-6F45-4D4D-A58F-F50C610BB6E7}");
        //    private static readonly Guid field71 = new Guid("{5128C983-DEAD-4657-AEA3-795176052200}");
        //    private static readonly Guid field72 = new Guid("{63DB2834-DBBC-48FE-9D42-1F39C5769A40}");
        //    private static readonly Guid field73 = new Guid("{F58A1BC2-BD6A-4A18-A88A-F9FB345D317D}");
        //    private static readonly Guid field74 = new Guid("{D7C0D83B-7038-4CE3-8D2A-038A7FC3A295}");
        //    private static readonly Guid field75 = new Guid("{999CB7F2-4751-4A32-862D-AA72140700A2}");
        //    private static readonly Guid field76 = new Guid("{93662031-C385-45F4-8881-BDD0838CE1E6}");
        //    private static readonly Guid field77 = new Guid("{23A12B87-12E3-4FA3-AF43-88476ABB5415}");
        //    private static readonly Guid field78 = new Guid("{7D243200-B0DD-4086-B97F-84AC1340A078}");
        //    private static readonly Guid field79 = new Guid("{14B59933-9FD1-4D20-9344-85734ADB72F4}");
        //    private static readonly Guid field80 = new Guid("{64CE0043-853F-418E-85E9-633D4095B201}");
        //    private static readonly Guid field81 = new Guid("{15ABE2D9-4CD6-449A-AD48-B177F78612FD}");
        //    private static readonly Guid field82 = new Guid("{57A8C4F1-3DC6-44FB-8B7C-FA5288D2EDFD}");
        //    private static readonly Guid field83 = new Guid("{EA5A9498-1708-4327-8696-8E804474DF79}");
        //    private static readonly Guid field84 = new Guid("{BBB9B6B8-B297-4C03-8EAB-FBF632769059}");
        //    private static readonly Guid field85 = new Guid("{5F1280B2-5191-4237-A13D-3949F0CB3719}");
        //    private static readonly Guid field86 = new Guid("{E8420F21-86E5-48F4-82C3-333F0E8C5697}");
        //    private static readonly Guid field87 = new Guid("{71D66396-B1AA-4B00-B0F0-A6C4B53C52A5}");
        //    private static readonly Guid field88 = new Guid("{E8F6BBA0-D400-4890-A879-E6AB6DB2E601}");
        //    private static readonly Guid field89 = new Guid("{DEAA9659-D7CC-42ED-8331-699E023B3E60}");
        //    private static readonly Guid field90 = new Guid("{2F4C0B06-BD30-450A-B403-64F3F0F873D6}");
        //    private static readonly Guid field91 = new Guid("{0CDEBAC7-AA1A-4094-BC86-401ED15D25FB}");
        //    private static readonly Guid field92 = new Guid("{6AC71F33-E93E-44AA-BB49-351CD9B3A558}");
        //    private static readonly Guid field93 = new Guid("{96F11B25-09F0-4AA5-A86D-97996646CF83}");
        //    private static readonly Guid field94 = new Guid("{DAABDE19-42B3-4757-8C4F-B0E1DADD489E}");
        //    private static readonly Guid field95 = new Guid("{E8965B60-CCD3-4EC8-BE11-DAD269A68D82}");
        //    private static readonly Guid field96 = new Guid("{350B63B0-016E-4445-ADD1-D41D7F7A8D35}");
        //    private static readonly Guid field97 = new Guid("{5C03BEDE-6D2F-499D-9305-D7265499CD6F}");
        //    private static readonly Guid field98 = new Guid("{F06A9AE9-51C4-4897-A036-E0A71DEDAADE}");
        //    private static readonly Guid field99 = new Guid("{492AB488-3D34-4295-9603-952641DA881A}");
        //    private static readonly Guid field100 = new Guid("{610967C9-32F9-41E9-AAC5-EDDC3600E11E}");
        //    private static readonly Guid field101 = new Guid("{FAC0322D-51E8-47B5-BB4E-226E4906F3F4}");
        //    private static readonly Guid field102 = new Guid("{B1F68566-5086-4616-A917-942903EFCA77}");
        //    private static readonly Guid field103 = new Guid("{0529B123-301A-44EF-A47B-48581EE4B938}");
        //    private static readonly Guid field104 = new Guid("{0FB52D18-974F-47EF-A340-1DBE30870A9F}");
        //    private static readonly Guid field105 = new Guid("{F5403F54-89A5-4434-A648-1F4846849E40}");
        //    private static readonly Guid field106 = new Guid("{67557EBA-EDB3-4C39-9DF5-6CDDA027E0CB}");
        //    private static readonly Guid field107 = new Guid("{A131016F-346C-4ED4-8FE7-E708C8CFCE45}");
        //    private static readonly Guid field108 = new Guid("{C6DE46C8-7EC1-4E1A-8BEC-238DAC021857}");
        //    private static readonly Guid field109 = new Guid("{9DC3BCC1-88CD-46BF-9D10-3C12E28D6488}");
        //    private static readonly Guid field110 = new Guid("{D469E9A3-8518-446B-9DBF-20E83B715E39}");
        //    private static readonly Guid field111 = new Guid("{92628B3E-8D05-4BE7-97AD-D00FC09CEFE2}");
        //    private static readonly Guid field112 = new Guid("{9C46C759-1F7A-481A-A810-F365994721C1}");
        //    private static readonly Guid field113 = new Guid("{8E322A0F-9064-4A3B-B644-601C3E70C707}");
        //    private static readonly Guid field114 = new Guid("{F31338BF-1D35-44FC-AB3D-4DFEAD242C52}");
        //    private static readonly Guid field115 = new Guid("{EF25BA27-826A-4BAA-98B7-45E6105B38E0}");
        //    private static readonly Guid field116 = new Guid("{AC683072-CF8F-4BC7-B10D-05AC572539F2}");
        //    private static readonly Guid field117 = new Guid("{74C074E1-D508-4DA5-9E92-D4B7C135866A}");
        //    private static readonly Guid field118 = new Guid("{B2C8D37F-5361-464A-983A-65A48EEABBF5}");
        //    private static readonly Guid field119 = new Guid("{4A814B77-AD08-43EF-BD2E-8472B7D0DCBB}");
        //    private static readonly Guid field120 = new Guid("{B1A7EB0F-D9BE-4A6F-9BC5-96B9760C7B97}");
        //    private static readonly Guid field121 = new Guid("{0F43D627-8FD4-48B5-A894-AD734A482E7A}");
        //    private static readonly Guid field122 = new Guid("{6E159D42-88B0-42C8-A7F2-A06C2C096514}");
        //    private static readonly Guid field123 = new Guid("{75E686FA-F3DA-4501-BB86-D72DA819C208}");
        //    private static readonly Guid field124 = new Guid("{348A1E10-7D75-4134-BDE6-AFE5A8B0C816}");
        //    private static readonly Guid field125 = new Guid("{BF82748C-40D3-42CE-9538-A979E599D164}"); //Переходящие с предыдущей недели/месяц ЛОВЗ
        //    private static readonly Guid field126 = new Guid("{459B083A-D12A-4822-A30F-4685CA8F854C}"); //Сопровождающие[new]
        //    private static readonly Guid field127 = new Guid("{44922F13-56F2-4F95-987E-21C9693EA196}"); //Хороший результат
        //    private static readonly Guid field128 = new Guid("{8407F3CA-FDC8-4DD2-8444-2A303C524994}"); //Удовлетворительный ответ
        //    private static readonly Guid field129 = new Guid("{33EA46C5-36CA-4EBB-A7FB-7F55D702A846}"); //Без изменений

        //    // Areas
        //    private static readonly Guid region1 = new Guid("{FCB6DB01-469E-4254-9BB6-E3409057A779}");
        //    private static readonly Guid region2 = new Guid("{4386D93C-2DF6-4F99-A438-55C20447FD24}");
        //    private static readonly Guid region3 = new Guid("{F2662FF6-FFA7-4707-8284-3FB52436C1F1}");
        //    private static readonly Guid region4 = new Guid("{591191B0-7827-4C47-AC47-FB03C685E911}");
        //    private static readonly Guid region5 = new Guid("{65C856CD-69E5-4CA4-BB8C-8F382AE659E8}");
        //    private static readonly Guid region6 = new Guid("{D1067965-ACC3-4C43-9CA3-DC50C0E4D128}");
        //    private static readonly Guid region7 = new Guid("{4171C264-3F39-4B23-AAAC-B4282C68C6A6}");
        //    private static readonly Guid dis1 = new Guid("{79AAD00B-DC3A-4247-BCF7-CDE467B96E4F}");
        //    private static readonly Guid dis2 = new Guid("{F3D9FBB2-D7CF-4CF9-B085-7D0793B37370}");
        //    private static readonly Guid dis3 = new Guid("{6674AFF4-B55C-45E3-A487-249317B33DF4}");
        //    private static readonly Guid dis4 = new Guid("{CA401F89-C9F5-4CEF-A7CF-2A0FDFEDD5FF}");
        //    private static readonly Guid dis5 = new Guid("{729FD82B-B855-4925-BBA6-6D450889D3F9}");
        //    private static readonly Guid dis6 = new Guid("{42D826F0-4AAB-4F4F-B08D-191ADDF55743}");
        //    private static readonly Guid dis7 = new Guid("{5579EDE7-40E8-4092-A6CF-30D96803637C}");
        //    private static readonly Guid dis8 = new Guid("{C9F27576-91E7-4A99-856E-38BBA988AF22}");
        //    private static readonly Guid dis9 = new Guid("{767CB4C4-C05F-4229-8960-6604744FFF0F}");
        //    private static readonly Guid dis10 = new Guid("{D9E97D93-0CE2-421F-87A9-3FF1554D3BBC}");
        //    private static readonly Guid dis11 = new Guid("{7497BA2E-F5F0-4663-B337-2E8966D1A919}");
        //    private static readonly Guid dis12 = new Guid("{5208308E-2561-4CC2-8BB5-88584F615E71}");
        //    private static readonly Guid dis13 = new Guid("{03B2DB0C-12B7-44F8-AF9F-E51DA49F7D57}");
        //    private static readonly Guid dis14 = new Guid("{15895A37-560D-4AF0-A971-05EB7C19AD58}");
        //    private static readonly Guid dis15 = new Guid("{F8041D96-55D9-4840-B175-12CF10529AFF}");
        //    private static readonly Guid dis16 = new Guid("{8369FB92-2EB4-43E7-B9D1-AAD62A06D307}");
        //    private static readonly Guid dis17 = new Guid("{85706905-A4E4-4DED-973D-EC1C09776746}");
        //    private static readonly Guid dis18 = new Guid("{4DB17EAE-4381-4E0E-94CD-108E0F421E36}");
        //    private static readonly Guid dis19 = new Guid("{E28660FF-2877-472B-BA70-1A89F5E8A8E6}");
        //    private static readonly Guid dis20 = new Guid("{601E1AB1-FD5A-42DE-BE36-6FA265CE0C59}");
        //    private static readonly Guid dis21 = new Guid("{1E549247-6C19-4ED6-A013-E028B4EE0887}");
        //    private static readonly Guid dis22 = new Guid("{5C8C633B-125F-4CDF-902C-574CF78A6728}");
        //    private static readonly Guid dis23 = new Guid("{CB9A187F-4E16-41BC-A745-3DB9ADEB1B02}");
        //    private static readonly Guid dis24 = new Guid("{8B5C6DA6-4283-4D8B-AD37-153874EDF0AD}");
        //    private static readonly Guid dis25 = new Guid("{7D735007-FDB7-48EA-A9E8-988BE0D40C96}");
        //    private static readonly Guid dis26 = new Guid("{57FD5C59-1C04-478B-99AB-BB330DF8B2EE}");
        //    private static readonly Guid dis27 = new Guid("{8497A553-07EE-4146-86BA-ED714C8E2D2B}");
        //    private static readonly Guid dis28 = new Guid("{156E9D8B-008E-4A09-8142-96CEC1AEA1F7}");
        //    private static readonly Guid dis29 = new Guid("{5AC16B2B-9A3E-4797-9CDE-30C5B6875B2F}");
        //    private static readonly Guid dis30 = new Guid("{446AB760-4952-480A-A2C8-C6E55E530306}");
        //    private static readonly Guid dis31 = new Guid("{F523CE1A-E8AA-4C28-B54A-CDBB9FDA06EE}");
        //    private static readonly Guid dis32 = new Guid("{B83B35FC-8DE8-4531-A55B-2122B6927BB7}");
        //    private static readonly Guid dis33 = new Guid("{7241D184-10D5-44EA-9696-FB17CC54908D}");
        //    private static readonly Guid dis34 = new Guid("{0BB1ED87-390A-4E78-9C39-43548000050B}");
        //    private static readonly Guid dis35 = new Guid("{000A1444-070E-4E88-B721-A124286CDF52}");
        //    private static readonly Guid dis36 = new Guid("{C028DF94-6F08-427B-B7E3-144E288AC8DF}");
        //    private static readonly Guid dis37 = new Guid("{CDD62071-0103-4AEA-9716-F878A8EC794A}");
        //    private static readonly Guid dis38 = new Guid("{44AC559E-9176-471D-9625-B4F5A8D4C017}");
        //    private static readonly Guid dis39 = new Guid("{29DD2C55-E331-4BDF-BFFB-8BAF01CE38A4}");
        //    private static readonly Guid dis40 = new Guid("{7BB62C60-E8D6-4CA2-88A3-9449E5F15EE9}");
        //    private static readonly Guid dis41 = new Guid("{7EC8E15D-FADD-4973-8253-D7CE8A3F8B7A}");
        //    private static readonly Guid dis42 = new Guid("{3A94B34F-5924-471E-BAE8-D30AB49B1DE9}");
        //    private static readonly Guid dis43 = new Guid("{7C08DEDF-4C83-4ACE-BACB-87683D7FE9AA}");
        //    private static readonly Guid dis44 = new Guid("{DD00A50F-CB35-4080-AE7B-A5C26BE9C0A9}");
        //    private static readonly Guid dis45 = new Guid("{0DE01029-2BF3-4042-83DA-5633C397C2A2}");
        //    private static readonly Guid dis46 = new Guid("{940A7FA2-A4D6-401F-AF8A-8DD67DEA2295}");
        //    private static readonly Guid dis47 = new Guid("{2FF3A76E-F7C6-4F44-8F91-192B431A1106}");
        //    private static readonly Guid dis48 = new Guid("{C8F6A8BF-F51F-427A-AA53-EA7CD1B63C7C}");
        //    private static readonly Guid dis49 = new Guid("{04EB0012-E8E7-4DA6-9BA5-28ED0F8BBE69}");
        //    private static readonly Guid dis50 = new Guid("{0648E502-3EA2-4FD6-B505-78331D7F337D}");
        //    private static readonly Guid dis51 = new Guid("{61806A08-B216-497E-889F-C5FFB2DDF4F2}");
        //    private static readonly Guid dis52 = new Guid("{358379BD-F7CB-43BF-B0D5-3E4DF0EBC586}");
        //    private static readonly Guid dis53 = new Guid("{073217E4-BD96-4EA5-BC1B-777D2E248294}");
        //    private static readonly Guid dis54 = new Guid("{711DEA4C-C051-4B8E-AF89-143326DBDDCD}");
        //    private static readonly Guid dis55 = new Guid("{091A243B-2565-45D7-B02D-6FF2E2A02A1D}");
        //    private static readonly Guid dis56 = new Guid("{76BC0B28-12D5-4502-B072-3940D0949B7E}");
        //    private static readonly Guid dis57 = new Guid("{42C3CB7B-37CC-4D40-9BB3-2B30FBE07D0F}");
        //    private static readonly Guid dis58 = new Guid("{26202293-B601-4F4B-9142-FDDEFB8063E6}");
        //    private static readonly Guid dis59 = new Guid("{CDB05FCA-44EA-4713-99EC-9E1D80271FEE}");
        //    private static readonly Guid dis60 = new Guid("{E491CD42-EA35-417D-8C1B-59287BD2D8E8}");
        //    private static readonly Guid dis61 = new Guid("{F50FD5B9-16F3-45AC-BAEA-02640F02912B}");
        //    private static readonly Guid dis62 = new Guid("{FCB537D1-6726-40E2-B484-91CE9C698895}");
        //    private static readonly Guid dis63 = new Guid("{4E958C6E-E319-4211-B047-F56EB69EF4CC}");
        //    private static readonly Guid dis64 = new Guid("{CA7BCCC5-EEC2-4C1A-A1AB-39AC3913E296}");
        //    private static readonly Guid dis65 = new Guid("{FA27FF69-6B10-4A6C-8A5C-9E6447C5604B}");
        //    private static readonly Guid dis66 = new Guid("{2AB3580D-1B0E-4824-986D-A14D2AE6D281}");
        //    private static readonly Guid dis67 = new Guid("{8D9BC28D-3177-4663-8F26-1F6F5C7FCF42}");
        //    private static readonly Guid dis68 = new Guid("{D0865B0B-793D-438C-9D53-A71FF4D599F1}");
        //    private static readonly Guid dis69 = new Guid("{B1A29E3B-3F80-49DF-A94F-6F3F91165112}");
        //    private static readonly Guid dis70 = new Guid("{8DDDADBF-710E-4182-A912-C98604080BAF}");
        //    private static readonly Guid dis71 = new Guid("{4ED420A7-1561-417B-AC49-B0123A6A0E03}");
        //    private static readonly Guid dis72 = new Guid("{0E5917DA-8BFE-4E50-819D-065AF47B5CAD}");
        //    private static readonly Guid dis73 = new Guid("{609F1D57-023D-400F-B3FE-F8EE9D20BEB9}");
        //    private static readonly Guid dis74 = new Guid("{18988DC4-FFD1-4DA5-BB90-5738F3BA08BF}");
        //    private static readonly Guid dis75 = new Guid("{6C7FF2AC-5394-4F7F-A085-709A7D0DCB70}");
        //    private static readonly Guid dis76 = new Guid("{3642C666-F83E-43C2-9D6E-29C9E527E22A}");
        //    private static readonly Guid dis77 = new Guid("{80AD3EBC-43A3-43D3-85FB-3DE5C2DA5364}");
        //    private static readonly Guid dis78 = new Guid("{03C74B83-32EC-48AC-B4C8-E4EAF24D089B}");
        //    private static readonly Guid dis79 = new Guid("{3D17C5D9-315E-4D23-8352-3367C0FDAF88}");
        //    private static readonly Guid dis80 = new Guid("{09824519-A477-4901-AA1C-7C97BE816B9A}");
        //    private static readonly Guid dis81 = new Guid("{DF466856-AB99-4C6B-99B8-A0172FED7964}");

        //    private static readonly Guid metropolis = new Guid("{0504E82A-7468-4DAF-BCA1-F31163241C02}");
        //    private static readonly Guid women = new Guid("{BC064CB6-0EF7-4535-9208-4288EA6EFD21}");

        //    // Group disability
        //    private static readonly Guid group1 = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}");
        //    private static readonly Guid group2 = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}");
        //    private static readonly Guid group3 = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}");
        //    private static readonly Guid groupChild = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}");
        //    // By whom pointed
        //    private static readonly Guid msec = new Guid("{A593BA5C-714F-4ECE-8346-B88BCD225A9E}");
        //    private static readonly Guid rupoi = new Guid("{BBD3975D-9B3E-404F-A9BA-ED0C787E6817}");
        //    private static readonly Guid csm = new Guid("{CE62443C-C025-400E-86E2-639B5A973A5C}");
        //    private static readonly Guid ssu = new Guid("{9B989C2C-1ECF-4962-99C6-75EDCC7E883D}");
        //    /*--------------------------------------------------------------------------------------------------------------------*/
        //    private static Guid oneService = new Guid("{267ACE41-9834-4593-B6A2-DAD0D0A72293}"); //Цель направления в ЦРЛОВЗ-Реабилитация 

        //    private static Guid[] twoService = new Guid[]
        //    {
        //        new Guid("{129333EE-7948-485B-8406-B5D7E378DAA5}"), /*Протезирование*/
        //        new Guid("{007B16CE-181A-47E9-9897-BFD1D08090CF}"), /*Реабилитация и протезирование*/ 
        //        new Guid("{94FB1C58-D16E-46D8-A159-73D1106A343E}")  /*Ремонт ПОИ*/
        //    };

        //    public static List<ReportItem> Build(WorkflowContext context, int year, int month, Guid userId, UserInfo userInfo)
        //    {
        //        if (year < 2011 || year > 3000)
        //            throw new ApplicationException("Ошибка в значении года!");
        //        if (month < 1 || month > 12)
        //            throw new ApplicationException("Ошибка в значении месяца!");
        //        if (userInfo.OrganizationId == null)
        //            throw new ApplicationException("Не могу создать заявку! Организация не указана!");

        //        var docRepo = context.Documents;
        //        var qb = new QueryBuilder(ReportDocId, userId);
        //        qb.Where("Year").Eq(year).And("Month").Eq(month).And("Organization").Eq(userInfo.OrganizationId)/*.And("&State").IsNull()*/;

        //        var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
        //        query.AddAttribute("&Id");

        //        var docs = new List<Guid>();
        //        using (var reader = new SqlQueryReader(context.DataContext, query))
        //        {
        //            if (reader.Read())
        //                docs.Add(reader.Reader.GetGuid(0));
        //        }

        //        Doc report;
        //        var rowsAttrDefId = new Guid("{CEE41BE3-E0F6-410C-AD41-23FB3DDF90A3}");
        //        if (docs.Count > 0)
        //        {
        //            report = docRepo.LoadById(docs[0]);
        //            docRepo.ClearAttrDocList(report.Id, rowsAttrDefId);
        //        }
        //        else
        //            report = docRepo.New(ReportDocId);

        //        var names = new Guid[]{
        //                               field129, field128, field127,
        //                               field126, field125, field124, field123, field122, field121, field120, field119, field118, field117, field116,
        //                               field115, field114, field113, field112, field111, field110, field109, field108, field107, field106,
        //                               field105, field104, field103, field102, field101, field100, field99, field98, field97, field96,
        //                               field95, field94, field93, field92, field91, field90, field89, field88, field87, field86, field85,
        //                               field84, field83, field82, field81, field80, field79, field78, field77, field76, field75, field74,
        //                               field73, field72, field71, field70, field69, field68, field67, field66, field65, field64, field63,
        //                               field62, field61, field60, field59, field58, field57, field56, field55, field54, field53, field52,
        //                               field51, field50, field49, field48, field47, field46, field45, field44, field43, field42, field41,
        //                               field40_1, field40, field39, field38, field37, field36, field35, field34, field33, field32_1,
        //                               field32, field31, field30, field29, field28, field27, field26, field25, field24_3, field24_2, field24_1, field24, field23, field22,
        //                               field21, field20, field19, field18, field17, field16, field15, field14, field13, field12, field11_1,
        //                               field11, field10, field9, field8, field7, field6, field5, field4, field3, field2, field1
        //                           };

        //        var items = new List<ReportItem>();
        //        foreach (var i1 in names)
        //        {
        //            var item = new ReportItem(); //docRepo.New(reportItemDefId);
        //            item.FieldName = i1;
        //            item.FieldNameText = context.Enums.GetValue(i1).Value;
        //            items.Add(item);
        //        }
        //        CalcItems(context, userId, (Guid)userInfo.OrganizationId, year, month,
        //            items[134], items[133], items[132], items[131], items[130], items[129], items[128], items[127], items[126], items[125],
        //            items[124], items[123], items[122], items[121], items[120], items[119], items[118], items[117], items[116], items[115],
        //            items[114], items[113], items[112], items[111], items[110], items[109], items[108], items[107], items[106], items[105], items[104],
        //            items[103], items[102], items[101], items[100], items[99], items[98], items[97], items[96], items[95], items[94], items[93], items[92],
        //            items[91], items[90], items[89], items[88], items[87], items[86], items[85], items[84], items[83], items[82], items[81], items[80],
        //            items[79], items[78], items[77], items[76], items[75], items[74], items[73], items[72], items[71], items[70], items[69], items[68],
        //            items[67], items[66], items[65], items[64], items[63], items[62], items[61], items[60], items[59], items[58], items[57], items[56],
        //            items[55], items[54], items[53], items[52], items[51], items[50], items[49], items[48], items[47], items[46], items[45], items[44],
        //            items[43], items[42], items[41], items[40], items[39], items[38], items[37], items[36], items[35], items[34], items[33], items[32],
        //            items[31], items[30], items[29], items[28], items[27], items[26], items[25], items[24], items[23], items[22], items[21], items[20],
        //            items[19], items[18], items[17], items[16], items[15], items[14], items[13], items[12], items[11], items[10], items[9], items[8],
        //            items[7], items[6], items[5], items[4], items[3], items[2], items[1], items[0]);

        //        GetAllEvents(context, report, (Guid)userInfo.OrganizationId, year, month);

        //        return items;
        //    }
        //    private static void GetAllEvents(WorkflowContext context, Doc report, Guid orgId, int year, int month)
        //    {
        //        var fd = new DateTime(year, month, 1);
        //        var ld = fd.AddMonths(1).AddDays(-1);
        //        var qb = new QueryBuilder(WeekReportDefId);
        //        qb.Where("&OrgId").Eq(orgId).And("From").Ge(fd).And("To").Le(ld);
        //        var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
        //        var events = new List<object>();
        //        query.AddAttribute("Event");
        //        query.AddOrderAttribute("Event");
        //        using (var reader = new SqlQueryReader(context.DataContext, query))
        //        {
        //            while (reader.Read())
        //                if (!reader.IsDbNull(0))
        //                    events.Add(reader.GetValue(0));
        //        }
        //        string even = "";
        //        foreach (var e in events)
        //            even += e + "\n";
        //        var eLength = even.Length;
        //        report["Event"] = even.Substring(0, eLength < 800 ? eLength - 0 : 799);
        //    }
        //    public static void CalcItems(WorkflowContext context, Guid userId, Guid orgId, int year, int month,
        //        ReportItem item1, ReportItem item2, ReportItem item3, ReportItem item4, ReportItem item5, ReportItem item6, ReportItem item7, ReportItem item8, ReportItem item9, ReportItem item10,
        //        ReportItem item11, ReportItem item11_1, ReportItem item12, ReportItem item13, ReportItem item14, ReportItem item15, ReportItem item16, ReportItem item17, ReportItem item18, ReportItem item19,
        //        ReportItem item20, ReportItem item21, ReportItem item22, ReportItem item23, ReportItem item24, ReportItem item24_1, ReportItem item24_2, ReportItem item24_3, ReportItem item25, ReportItem item26, ReportItem item27, ReportItem item28,
        //        ReportItem item29, ReportItem item30, ReportItem item31, ReportItem item32, ReportItem item32_1, ReportItem item33, ReportItem item34, ReportItem item35, ReportItem item36, ReportItem item37, ReportItem item38, ReportItem item39, ReportItem item40, ReportItem item40_1, ReportItem item41, ReportItem item42, ReportItem item43,
        //        ReportItem item44, ReportItem item45, ReportItem item46, ReportItem item47, ReportItem item48, ReportItem item49, ReportItem item50, ReportItem item51, ReportItem item52, ReportItem item53, ReportItem item54, ReportItem item55, ReportItem item56, ReportItem item57, ReportItem item58,
        //        ReportItem item59, ReportItem item60, ReportItem item61, ReportItem item62, ReportItem item63, ReportItem item64, ReportItem item65, ReportItem item66, ReportItem item67, ReportItem item68, ReportItem item69, ReportItem item70, ReportItem item71, ReportItem item72, ReportItem item73,
        //        ReportItem item74, ReportItem item75, ReportItem item76, ReportItem item77, ReportItem item78, ReportItem item79, ReportItem item80, ReportItem item81, ReportItem item82, ReportItem item83, ReportItem item84, ReportItem item85, ReportItem item86, ReportItem item87, ReportItem item88,
        //        ReportItem item89, ReportItem item90, ReportItem item91, ReportItem item92, ReportItem item93, ReportItem item94, ReportItem item95, ReportItem item96, ReportItem item97, ReportItem item98, ReportItem item99, ReportItem item100, ReportItem item101, ReportItem item102, ReportItem item103,
        //        ReportItem item104, ReportItem item105, ReportItem item106, ReportItem item107, ReportItem item108, ReportItem item109, ReportItem item110, ReportItem item111, ReportItem item112, ReportItem item113, ReportItem item114, ReportItem item115, ReportItem item116, ReportItem item117, ReportItem item118,
        //        ReportItem item119, ReportItem item120, ReportItem item121, ReportItem item122, ReportItem item123, ReportItem item124, ReportItem item125, ReportItem item126, ReportItem item127, ReportItem item128, ReportItem item129)
        //    {
        //        var fd = new DateTime(year, month, 1);
        //        var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));

        //        var qb = new QueryBuilder(cardDefId, userId);
        //        qb.Where("&OrgId").Eq(orgId).And("DateOfReceipt").Le(ld).And("OrderDateDef").Ge(fd).And("&State").Neq(new Guid("ca1157a0-fddf-4c90-9692-7cdb47ccc7c2")); //Отказанные
        //        var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
        //        var applicant = query.JoinSource(query.Source, ApplicantDefId, SqlSourceJoinType.Inner, "Applicant");
        //        var vypiska = query.JoinSource(query.Source, vypiskaDefId, SqlSourceJoinType.LeftOuter, "CardOfThePatient");
        //        query.AddAttributes(new[] {
        //                                  "&Id", "GroupDisability", "DirectExamination", "HaveAttendant", "FirstType"
        //                              });
        //        query.AddAttribute(applicant, "Sex");
        //        query.AddAttribute(query.Source, "OrderDateDef");
        //        query.AddAttribute(query.Source, "DateOfReceipt");
        //        query.AddAttribute(vypiska, "ResultRehabilitation");
        //        query.AddAttribute(vypiska, "DateExtraction");
        //        var list = new List<Guid>();
        //        var table = new DataTable();
        //        using (var reader = new SqlQueryReader(context.DataContext, query))
        //        {
        //            reader.Open();
        //            reader.Fill(table);
        //            reader.Close();
        //        }
        //        int nextMonth = 0;
        //        int str13 = 0;
        //        int str14 = 0;
        //        int str3 = 0;
        //        foreach (DataRow row in table.Rows)
        //        {
        //            var cardObj = row[0];
        //            if (!(cardObj is DBNull))
        //            {
        //                var cardId = (Guid)cardObj;
        //                if (!list.Contains(cardId))
        //                {
        //                    list.Add(cardId);

        //                    var group = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
        //                    var examin = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
        //                    bool attendant = row[3] is DBNull ? false : (bool)row[3];
        //                    bool prim = row[4] is DBNull ? false : (bool)row[4];
        //                    var sex = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
        //                    var orderDateDef = row[6] is DBNull ? DateTime.MaxValue : (DateTime)row[6];
        //                    var reciptDateDef = row[7] is DBNull ? DateTime.MaxValue : (DateTime)row[7];
        //                    var resultReab = row[8] is DBNull ? Guid.Empty : (Guid)row[8];
        //                    var vypiskaDate = row[9] is DBNull ? DateTime.MaxValue : (DateTime)row[9];
        //                    if (orderDateDef >= fd && reciptDateDef < fd)
        //                    {
        //                        nextMonth++;
        //                        if (nextMonth != null && attendant)
        //                        {
        //                            //строка №2
        //                            item126.StringCount = item126.StringCount != string.Empty ? (Convert.ToInt32(item126.StringCount) + 1).ToString() : "1";
        //                        }
        //                    }
        //                    //строка №13
        //                    if (prim && examin == new Guid("{007B16CE-181A-47E9-9897-BFD1D08090CF}"))
        //                    {
        //                        str13++;
        //                    }
        //                    //строка №14
        //                    if (prim && examin == oneService)
        //                    {
        //                        str14++;
        //                    }
        //                    //строка № 15                           
        //                    if (group == groupChild)
        //                    {
        //                        item12.StringCount = item12.StringCount != string.Empty ? (Convert.ToInt32(item12.StringCount) + 1).ToString() : "1";
        //                        if (sex == women)
        //                            item12.Women = (int?)item12.Women + 1 ?? 1;
        //                        else if (sex != Guid.Empty)
        //                            item12.Men = (int?)item12.Men + 1 ?? 1;
        //                    }
        //                    //строка № 16                        
        //                    if (group == group1)
        //                    {
        //                        item13.StringCount = item13.StringCount != string.Empty ? (Convert.ToInt32(item13.StringCount) + 1).ToString() : "1";
        //                        if (sex == women)
        //                            item13.Women = (int?)item13.Women + 1 ?? 1;
        //                        else if (sex != Guid.Empty)
        //                            item13.Men = (int?)item13.Men + 1 ?? 1;
        //                    }
        //                    //строка № 17                        
        //                    if (group == group2)
        //                    {
        //                        item14.StringCount = item14.StringCount != string.Empty ? (Convert.ToInt32(item14.StringCount) + 1).ToString() : "1";
        //                        if (sex == women)
        //                            item14.Women = (int?)item14.Women + 1 ?? 1;
        //                        else if (sex != Guid.Empty)
        //                            item14.Men = (int?)item14.Men + 1 ?? 1;
        //                    }
        //                    //строка № 18                        
        //                    if (group == group3)
        //                    {
        //                        item15.StringCount = item15.StringCount != string.Empty ? (Convert.ToInt32(item15.StringCount) + 1).ToString() : "1";
        //                        if (sex == women)
        //                            item15.Women = (int?)item15.Women + 1 ?? 1;
        //                        else if (sex != Guid.Empty)
        //                            item15.Men = (int?)item15.Men + 1 ?? 1;
        //                    }
        //                    if (attendant)
        //                    {
        //                        item5.StringCount = item5.StringCount != string.Empty ? (Convert.ToInt32(item5.StringCount) + 1).ToString() : "1";
        //                        item6.StringCount = item6.StringCount != string.Empty ? (Convert.ToInt32(item6.StringCount) + CountDays(context.GetDynaDoc(cardId), month, year, context)).ToString() : CountDays(context.GetDynaDoc(cardId), month, year, context).ToString();
        //                    }
        //                    item4.StringCount = item4.StringCount != string.Empty ? (Convert.ToInt32(item4.StringCount) + CountDays(context.GetDynaDoc(cardId), month, year, context)).ToString() : CountDays(context.GetDynaDoc(cardId), month, year, context).ToString();

        //                    if (twoService.Contains(examin))
        //                    {
        //                        item7.StringCount = item7.StringCount != string.Empty ? (Convert.ToInt32(item7.StringCount) + 1).ToString() : "1";
        //                        item8.StringCount = item8.StringCount != string.Empty ? (Convert.ToInt32(item8.StringCount) + CountDays(context.GetDynaDoc(cardId), month, year, context)).ToString() : CountDays(context.GetDynaDoc(cardId), month, year, context).ToString();
        //                    }
        //                    else if (examin == oneService)
        //                    {
        //                        item9.StringCount = item9.StringCount != string.Empty ? (Convert.ToInt32(item9.StringCount) + 1).ToString() : "1";
        //                        item10.StringCount = item10.StringCount != string.Empty ? (Convert.ToInt32(item10.StringCount) + CountDays(context.GetDynaDoc(cardId), month, year, context)).ToString() : CountDays(context.GetDynaDoc(cardId), month, year, context).ToString();
        //                    }
        //                    if (vypiskaDate <= ld && vypiskaDate >= fd)
        //                    {
        //                        //строка №44                        
        //                        if ((Guid)resultReab == new Guid("{2A02FEBE-51B0-413C-9F44-73DE432282A8}"))
        //                        {
        //                            item127.StringCount = item127.StringCount != string.Empty ? (Convert.ToInt32(item127.StringCount) + 1).ToString() : "1";
        //                        }
        //                        //строка №45
        //                        if ((Guid)resultReab == new Guid("{E459834F-0254-453D-A871-9197BCCD8B44}"))
        //                        {
        //                            item128.StringCount = item128.StringCount != string.Empty ? (Convert.ToInt32(item128.StringCount) + 1).ToString() : "1";
        //                        }
        //                        //строка №46
        //                        if ((Guid)resultReab == new Guid("{0941FAAF-AAA8-44A8-969D-FCA9A68C6BD5}"))
        //                        {
        //                            item129.StringCount = item129.StringCount != string.Empty ? (Convert.ToInt32(item129.StringCount) + 1).ToString() : "1";
        //                        }
        //                    }
        //                }
        //            }
        //        }
        //        item125.StringCount = nextMonth.ToString(); //строка №1
        //        item3.StringCount = list.Count.ToString(); //количество стат. кард на тек. месяц                 
        //        item11.StringCount = str13.ToString();
        //        item11_1.StringCount = str14.ToString();

        //        if (string.IsNullOrEmpty((string)item7.StringCount)) item7.StringCount = "0";
        //        if (string.IsNullOrEmpty((string)item8.StringCount)) item8.StringCount = "0";
        //        if (string.IsNullOrEmpty((string)item9.StringCount)) item9.StringCount = "0";
        //        if (string.IsNullOrEmpty((string)item10.StringCount)) item10.StringCount = "0";
        //        item40.StringCount = "0";
        //        item41.StringCount = "0";
        //        item42.StringCount = "0";
        //        item43.StringCount = "0";

        //        item2.StringCount = (Convert.ToInt32(item6.StringCount) + Convert.ToInt32(item4.StringCount)).ToString();
        //        item26.StringCount = item7.StringCount;
        //        //строка №5 
        //        item16.StringCount = item3.StringCount;

        //        GetProcedures(context, year, month, userId, orgId, new List<ReportItem> { item17, item18, item19, item22, item23, item24, item25, item20,
        //                                                                       item21, item27, item28, item29, item24_1, item24_2, item24_3
        //                                                                     });
        //        GetNextItems(context, item30, item31, item32, item32_1, item33, item34, item35, item36, item37, item38, item39, item44, item45, item46, item47, item48,
        //                    item49, item50, item51, item52, item53, item54, item55, item56, item57, item58, item59, item60, item61, item62, item63, item64,
        //                    item65, item66, item67, item68, item69, item70, item71, item72, item73, item74, item75, item76, item77, item78, item79,
        //                    item80, item81, item82, item83, item84, item85, item86, item87, item88, item89, item90, item91, item92, item93, item94,
        //                    item95, item96, item97, item98, item99, item100, item101, item102, item103, item104, item105, item106, item107, item108,
        //                    item109, item110, item111, item112, item113, item114, item115, item116, item117, item118, item119, item120, item121,
        //                    item122, item123, item124, item40, item40_1, item41, item42, item43, fd, ld);

        //        //строка №3 = строка №5 + строка №2 + строка №21
        //        item1.StringCount = (Convert.ToInt32(item3.StringCount) + Convert.ToInt32(item126.StringCount) + Convert.ToInt32(item42.StringCount)).ToString();
        //    }

        //    private static void GetNextItems(WorkflowContext context, ReportItem item30, ReportItem item31, ReportItem item32, ReportItem item32_1, ReportItem item33, ReportItem item34, ReportItem item35, ReportItem item36,
        //                        ReportItem item37, ReportItem item38, ReportItem item39, ReportItem item44, ReportItem item45, ReportItem item46, ReportItem item47, ReportItem item48, ReportItem item49, ReportItem item50, ReportItem item51, ReportItem item52,
        //                        ReportItem item53, ReportItem item54, ReportItem item55, ReportItem item56, ReportItem item57, ReportItem item58, ReportItem item59, ReportItem item60, ReportItem item61, ReportItem item62, ReportItem item63, ReportItem item64,
        //                        ReportItem item65, ReportItem item66, ReportItem item67, ReportItem item68, ReportItem item69, ReportItem item70, ReportItem item71, ReportItem item72, ReportItem item73, ReportItem item74, ReportItem item75, ReportItem item76,
        //                        ReportItem item77, ReportItem item78, ReportItem item79, ReportItem item80, ReportItem item81, ReportItem item82, ReportItem item83, ReportItem item84, ReportItem item85, ReportItem item86, ReportItem item87, ReportItem item88,
        //                        ReportItem item89, ReportItem item90, ReportItem item91, ReportItem item92, ReportItem item93, ReportItem item94, ReportItem item95, ReportItem item96, ReportItem item97, ReportItem item98, ReportItem item99, ReportItem item100,
        //                        ReportItem item101, ReportItem item102, ReportItem item103, ReportItem item104, ReportItem item105, ReportItem item106, ReportItem item107, ReportItem item108, ReportItem item109, ReportItem item110, ReportItem item111,
        //                        ReportItem item112, ReportItem item113, ReportItem item114, ReportItem item115, ReportItem item116, ReportItem item117, ReportItem item118, ReportItem item119, ReportItem item120, ReportItem item121, ReportItem item122,
        //                        ReportItem item123, ReportItem item124, ReportItem item40, ReportItem item40_1, ReportItem item41, ReportItem item42, ReportItem item43, DateTime fd, DateTime ld)
        //    {
        //        var orderDefId = new Guid("{DA9CBB90-6527-41DA-A25E-690EFE24AE8A}");
        //        var qb = new QueryBuilder(orderDefId, context.UserId);
        //        qb.Where("DateExtraction").Ge(fd).And("DateExtraction").Le(ld).And("&State").Eq(new Guid("79417A2A-365D-473B-A09B-3230CAA17D9D")); //выписанные
        //        var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
        //        var cardSrc = query.JoinSource(query.Source, cardDefId, SqlSourceJoinType.Inner, "CardOfThePatient");
        //        query.AddAttribute(query.Source, "&Id");
        //        query.AddAttribute(cardSrc, "HaveAttendant");
        //        using (var reader = new SqlQueryReader(context.DataContext, query))
        //        {
        //            int i40 = 0;
        //            int i40_1 = 0;
        //            while (reader.Read())
        //            {
        //                i40++;
        //                var haveAttendant = reader.IsDbNull(1) ? false : reader.GetBoolean(1);
        //                if (haveAttendant)
        //                    i40_1++;
        //            }
        //            //строка 42, 43             
        //            item40.StringCount = i40.ToString();
        //            item40_1.StringCount = i40_1.ToString();
        //        }

        //        qb = new QueryBuilder(cardDefId, context.UserId);
        //        qb.Where("DateOfReceipt").Ge(fd).And("DateOfReceipt").Le(ld).And("&State").Neq(new Guid("ca1157a0-fddf-4c90-9692-7cdb47ccc7c2"));
        //        query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
        //        query.AddAttribute("&Id", SqlQuerySummaryFunction.Count);
        //        query.AddAttribute("HaveAttendant");
        //        query.AddAttribute("WhoDirected");
        //        query.AddAttribute("Obl");
        //        query.AddAttribute("Rag");
        //        query.AddGroupAttribute("HaveAttendant");
        //        query.AddGroupAttribute("WhoDirected");
        //        query.AddGroupAttribute("Obl");
        //        query.AddGroupAttribute("Rag");
        //        using (var reader = new SqlQueryReader(context.DataContext, query))
        //        {
        //            while (reader.Read())
        //            {
        //                int c = reader.GetInt32(0);
        //                bool attend = reader.Reader.IsDBNull(1) ? false : reader.GetBoolean(1);
        //                var directId = !reader.Reader.IsDBNull(2) ? reader.GetGuid(2) : Guid.Empty;
        //                var region = !reader.Reader.IsDBNull(3) ? reader.GetGuid(3) : Guid.Empty;
        //                var distr = !reader.Reader.IsDBNull(4) ? reader.GetGuid(4) : Guid.Empty;

        //                //строка №20
        //                item41.StringCount = (Convert.ToInt32(item41.StringCount) + c).ToString();

        //                //строка №21
        //                if (attend)
        //                {
        //                    item42.StringCount = (Convert.ToInt32(item42.StringCount) + c).ToString();
        //                }
        //                item43.StringCount = (Convert.ToInt32(item43.StringCount) + c).ToString();
        //                if (directId == rupoi)
        //                {
        //                    item30.StringCount = (Convert.ToInt32(item30.StringCount) + c).ToString();
        //                }
        //                else if (directId == msec)
        //                    item31.StringCount = (Convert.ToInt32(item31.StringCount) + c).ToString();
        //                else if (directId == csm)
        //                    item32.StringCount = (Convert.ToInt32(item32.StringCount) + c).ToString();
        //                else if (directId == ssu)
        //                    item32_1.StringCount = (Convert.ToInt32(item32_1.StringCount) + c).ToString();
        //                if (region == region1 || region == metropolis)
        //                    item33.StringCount = item33.StringCount != string.Empty ? (Convert.ToInt32(item33.StringCount) + c).ToString() : c.ToString();
        //                else if (region == region2)
        //                    item34.StringCount = item34.StringCount != string.Empty ? (Convert.ToInt32(item34.StringCount) + c).ToString() : c.ToString();
        //                else if (region == region3)
        //                    item35.StringCount = item35.StringCount != string.Empty ? (Convert.ToInt32(item35.StringCount) + c).ToString() : c.ToString();
        //                else if (region == region4)
        //                    item36.StringCount = item36.StringCount != string.Empty ? (Convert.ToInt32(item36.StringCount) + c).ToString() : c.ToString();
        //                else if (region == region5)
        //                    item37.StringCount = item37.StringCount != string.Empty ? (Convert.ToInt32(item37.StringCount) + c).ToString() : c.ToString();
        //                else if (region == region6)
        //                    item38.StringCount = item38.StringCount != string.Empty ? (Convert.ToInt32(item38.StringCount) + c).ToString() : c.ToString();
        //                else if (region == region7)
        //                    item39.StringCount = item39.StringCount != string.Empty ? (Convert.ToInt32(item39.StringCount) + c).ToString() : c.ToString();

        //                if (distr == dis1)
        //                    item44.StringCount = item44.StringCount != string.Empty ? (Convert.ToInt32(item44.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis2)
        //                    item45.StringCount = item45.StringCount != string.Empty ? (Convert.ToInt32(item45.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis3)
        //                    item46.StringCount = item46.StringCount != string.Empty ? (Convert.ToInt32(item46.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis4)
        //                    item47.StringCount = item47.StringCount != string.Empty ? (Convert.ToInt32(item47.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis5)
        //                    item48.StringCount = item48.StringCount != string.Empty ? (Convert.ToInt32(item48.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis6)
        //                    item49.StringCount = item49.StringCount != string.Empty ? (Convert.ToInt32(item49.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis7)
        //                    item50.StringCount = item50.StringCount != string.Empty ? (Convert.ToInt32(item50.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis8)
        //                    item51.StringCount = item51.StringCount != string.Empty ? (Convert.ToInt32(item51.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis9)
        //                    item52.StringCount = item52.StringCount != string.Empty ? (Convert.ToInt32(item52.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis10)
        //                    item53.StringCount = item53.StringCount != string.Empty ? (Convert.ToInt32(item53.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis11)
        //                    item54.StringCount = item54.StringCount != string.Empty ? (Convert.ToInt32(item54.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis12)
        //                    item55.StringCount = item55.StringCount != string.Empty ? (Convert.ToInt32(item55.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis13)
        //                    item56.StringCount = item56.StringCount != string.Empty ? (Convert.ToInt32(item56.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis14)
        //                    item57.StringCount = item57.StringCount != string.Empty ? (Convert.ToInt32(item57.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis15)
        //                    item58.StringCount = item58.StringCount != string.Empty ? (Convert.ToInt32(item58.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis16)
        //                    item59.StringCount = item59.StringCount != string.Empty ? (Convert.ToInt32(item59.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis17)
        //                    item60.StringCount = item60.StringCount != string.Empty ? (Convert.ToInt32(item60.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis18)
        //                    item61.StringCount = item61.StringCount != string.Empty ? (Convert.ToInt32(item61.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis19)
        //                    item62.StringCount = item62.StringCount != string.Empty ? (Convert.ToInt32(item62.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis20)
        //                    item63.StringCount = item63.StringCount != string.Empty ? (Convert.ToInt32(item63.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis21)
        //                    item64.StringCount = item64.StringCount != string.Empty ? (Convert.ToInt32(item64.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis22)
        //                    item65.StringCount = item65.StringCount != string.Empty ? (Convert.ToInt32(item65.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis23)
        //                    item66.StringCount = item66.StringCount != string.Empty ? (Convert.ToInt32(item66.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis24)
        //                    item67.StringCount = item67.StringCount != string.Empty ? (Convert.ToInt32(item67.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis25)
        //                    item68.StringCount = item68.StringCount != string.Empty ? (Convert.ToInt32(item68.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis26)
        //                    item69.StringCount = item69.StringCount != string.Empty ? (Convert.ToInt32(item69.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis27)
        //                    item70.StringCount = item70.StringCount != string.Empty ? (Convert.ToInt32(item70.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis28)
        //                    item71.StringCount = item71.StringCount != string.Empty ? (Convert.ToInt32(item71.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis29)
        //                    item72.StringCount = item72.StringCount != string.Empty ? (Convert.ToInt32(item72.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis30)
        //                    item73.StringCount = item73.StringCount != string.Empty ? (Convert.ToInt32(item73.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis31)
        //                    item74.StringCount = item74.StringCount != string.Empty ? (Convert.ToInt32(item74.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis32)
        //                    item75.StringCount = item75.StringCount != string.Empty ? (Convert.ToInt32(item75.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis33)
        //                    item76.StringCount = item76.StringCount != string.Empty ? (Convert.ToInt32(item76.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis34)
        //                    item77.StringCount = item77.StringCount != string.Empty ? (Convert.ToInt32(item77.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis35)
        //                    item78.StringCount = item78.StringCount != string.Empty ? (Convert.ToInt32(item78.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis36)
        //                    item79.StringCount = item79.StringCount != string.Empty ? (Convert.ToInt32(item79.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis37)
        //                    item80.StringCount = item80.StringCount != string.Empty ? (Convert.ToInt32(item80.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis38)
        //                    item81.StringCount = item81.StringCount != string.Empty ? (Convert.ToInt32(item81.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis39)
        //                    item82.StringCount = item82.StringCount != string.Empty ? (Convert.ToInt32(item82.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis40)
        //                    item83.StringCount = item83.StringCount != string.Empty ? (Convert.ToInt32(item83.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis41)
        //                    item84.StringCount = item84.StringCount != string.Empty ? (Convert.ToInt32(item84.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis42)
        //                    item85.StringCount = item85.StringCount != string.Empty ? (Convert.ToInt32(item85.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis43)
        //                    item86.StringCount = item86.StringCount != string.Empty ? (Convert.ToInt32(item86.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis44)
        //                    item87.StringCount = item87.StringCount != string.Empty ? (Convert.ToInt32(item87.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis45)
        //                    item88.StringCount = item88.StringCount != string.Empty ? (Convert.ToInt32(item88.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis46)
        //                    item89.StringCount = item89.StringCount != string.Empty ? (Convert.ToInt32(item89.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis47)
        //                    item90.StringCount = item90.StringCount != string.Empty ? (Convert.ToInt32(item90.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis48)
        //                    item91.StringCount = item91.StringCount != string.Empty ? (Convert.ToInt32(item91.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis49)
        //                    item92.StringCount = item92.StringCount != string.Empty ? (Convert.ToInt32(item92.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis50)
        //                    item93.StringCount = item93.StringCount != string.Empty ? (Convert.ToInt32(item93.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis51)
        //                    item94.StringCount = item94.StringCount != string.Empty ? (Convert.ToInt32(item94.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis52)
        //                    item95.StringCount = item95.StringCount != string.Empty ? (Convert.ToInt32(item95.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis53)
        //                    item96.StringCount = item96.StringCount != string.Empty ? (Convert.ToInt32(item96.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis54)
        //                    item97.StringCount = item97.StringCount != string.Empty ? (Convert.ToInt32(item97.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis55)
        //                    item98.StringCount = item98.StringCount != string.Empty ? (Convert.ToInt32(item98.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis56)
        //                    item99.StringCount = item99.StringCount != string.Empty ? (Convert.ToInt32(item99.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis57)
        //                    item100.StringCount = item100.StringCount != string.Empty ? (Convert.ToInt32(item100.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis58)
        //                    item101.StringCount = item101.StringCount != string.Empty ? (Convert.ToInt32(item101.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis59)
        //                    item102.StringCount = item102.StringCount != string.Empty ? (Convert.ToInt32(item102.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis60)
        //                    item103.StringCount = item103.StringCount != string.Empty ? (Convert.ToInt32(item103.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis61)
        //                    item104.StringCount = item104.StringCount != string.Empty ? (Convert.ToInt32(item104.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis62)
        //                    item105.StringCount = item105.StringCount != string.Empty ? (Convert.ToInt32(item105.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis63)
        //                    item106.StringCount = item106.StringCount != string.Empty ? (Convert.ToInt32(item106.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis64)
        //                    item107.StringCount = item107.StringCount != string.Empty ? (Convert.ToInt32(item107.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis65)
        //                    item108.StringCount = item108.StringCount != string.Empty ? (Convert.ToInt32(item108.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis66)
        //                    item109.StringCount = item109.StringCount != string.Empty ? (Convert.ToInt32(item109.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis67)
        //                    item110.StringCount = item110.StringCount != string.Empty ? (Convert.ToInt32(item110.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis68)
        //                    item111.StringCount = item111.StringCount != string.Empty ? (Convert.ToInt32(item111.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis69)
        //                    item112.StringCount = item112.StringCount != string.Empty ? (Convert.ToInt32(item112.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis70)
        //                    item113.StringCount = item113.StringCount != string.Empty ? (Convert.ToInt32(item113.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis71)
        //                    item114.StringCount = item114.StringCount != string.Empty ? (Convert.ToInt32(item114.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis72)
        //                    item115.StringCount = item115.StringCount != string.Empty ? (Convert.ToInt32(item115.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis73)
        //                    item116.StringCount = item116.StringCount != string.Empty ? (Convert.ToInt32(item116.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis74)
        //                    item117.StringCount = item117.StringCount != string.Empty ? (Convert.ToInt32(item117.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis75)
        //                    item118.StringCount = item118.StringCount != string.Empty ? (Convert.ToInt32(item118.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis76)
        //                    item119.StringCount = item119.StringCount != string.Empty ? (Convert.ToInt32(item119.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis77)
        //                    item120.StringCount = item120.StringCount != string.Empty ? (Convert.ToInt32(item120.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis78)
        //                    item121.StringCount = item121.StringCount != string.Empty ? (Convert.ToInt32(item121.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis79)
        //                    item122.StringCount = item122.StringCount != string.Empty ? (Convert.ToInt32(item122.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis80)
        //                    item123.StringCount = item123.StringCount != string.Empty ? (Convert.ToInt32(item123.StringCount) + c).ToString() : c.ToString();
        //                else if (distr == dis81)
        //                    item124.StringCount = item124.StringCount != string.Empty ? (Convert.ToInt32(item124.StringCount) + c).ToString() : c.ToString();
        //            }
        //        }
        //    }

        //    private static Dictionary<string, int> CardsDays = new Dictionary<string, int>();
        //    public static int CountDays(dynamic card, int month, int year, WorkflowContext context)
        //    {
        //        var days = 0;
        //        var fullMonth = new DateTime(year, month, DateTime.DaysInMonth(year, month));
        //        var beginMonth = new DateTime(year, month, 1);
        //        if (card.DateOfReceipt == null)
        //            throw new ApplicationException("У карты под базовым номером " + card.RegNo.ToString() + " не указана дата поступления!");
        //        DateTime recDate = card.DateOfReceipt;
        //        DateTime outDate = card.OrderDateDef;
        //        if (outDate < beginMonth)
        //            throw new ApplicationException("У карты под базовым номером " + card.RegNo.ToString() + " дата выписки меньше чем дата получения процедуры!");
        //        if (recDate < beginMonth)//дата поступления раньше начала месяца
        //        {
        //            if (outDate > fullMonth)//дата выписки позже конца месяца
        //                days = fullMonth.Day;//целый месяц
        //            else//дата выписки не позже конца месяца
        //                days = outDate.Day - 1; //день выписки не включительно
        //        }
        //        else //дата поступления не раньше или равно начала месяца
        //        {
        //            if (outDate > fullMonth)//дата выписки позже конца месяца
        //                days = (int)(fullMonth - recDate).TotalDays + 1;//разница конца месяца и даты поступления
        //            else//дата выписки не позже конца месяца 
        //                days = (int)(outDate - recDate).TotalDays;//разница даты выписки и даты поступления
        //        }
        //        var cardNo = card.RegNo.ToString();
        //        if (!CardsDays.ContainsKey(cardNo))
        //            CardsDays.Add(cardNo, days);
        //        return days;
        //    }
        //    private static void GetProcedures(WorkflowContext context, int year, int month, Guid userId, Guid orgId, List<ReportItem> items)
        //    {
        //        var fd = new DateTime(year, month, 1);
        //        var ld = new DateTime(year, month, DateTime.DaysInMonth(year, month));
        //        var procedureType = "процедур";
        //        var iprTypes = new Guid[]
        //        {
        //        new Guid("{B318D20E-11BC-4914-9672-C0D8930AC80A}"), //  Физиолечение
        //        new Guid("{558F5E14-B96F-4412-AA08-62F3310E43D3}"), //  Парафинотерапия
        //        new Guid("{0CB745A4-3EAE-40FD-9D6F-27823282382A}"), //  ЛФК              
        //        new Guid("{1B1334AB-09F6-460F-93E0-198F14388D00}"), //  Перевязки
        //        new Guid("{74437DF8-99B3-4E82-850F-B7340D93AEA6}"), //  Медикаментозная реабилитация
        //        new Guid("{F469BE29-7BD5-48DD-8496-4F4FE6D37DB4}"), //  Психологическая реабилитация
        //        new Guid("{9B14B46B-3882-413F-9F8C-07F4B769B4CD}")  //  Массаж
        //        };
        //        var iprTypes2 = new Guid[]
        //        {
        //        new Guid("{6794BD63-2DA0-45FE-94EA-7F58B91AC801}"), // Лечение зубов
        //        new Guid("{01AAAE7C-5559-449E-941A-66F1B3C59060}"), // Зубопротезирование
        //        new Guid("{166648BF-0F52-470E-ABC2-C9349E296315}"), // Трудотерапия(обучение основам компьютерной грамоте)
        //        new Guid("{96AAE67E-21CC-4C35-B180-21795DB64DE8}"), // Трудотерапия(обучение мелким ремонтом протезов и ортезов)
        //        new Guid("{3F752DA5-F243-4434-AF07-702EBB2C5D22}"),  // Трудотерапия(кройка и шитье)
        //        new Guid("{90526149-BDC0-46B7-BA0B-D0435EB16B92}"),  // ЭКГ 
        //        new Guid("{900A1115-C6EC-48D2-BA6C-5461C9935DE4}"),  // УЗДГ         
        //        new Guid("{9C4881D6-05CE-47EF-B027-E04A22D96CEE}")  // УЗИ
        //        };
        //        for (int i = 0; i < 7; i++)
        //        {
        //            var iprId = iprTypes[i];
        //            if (iprId == new Guid("{1B1334AB-09F6-460F-93E0-198F14388D00}")) /*Перевязки*/
        //                procedureType = "перевязок";
        //            if (iprId == new Guid("{0CB745A4-3EAE-40FD-9D6F-27823282382A}")) /*ЛФК*/
        //                procedureType = "занятий";
        //            if (iprId == new Guid("{F469BE29-7BD5-48DD-8496-4F4FE6D37DB4}")) /*Психологическая реабилитация */
        //                procedureType = "бесед";
        //            /* if (new Guid[] {                             
        //                                new Guid("{90526149-BDC0-46B7-BA0B-D0435EB16B92}"), // ЭКГ
        //                                new Guid("{900A1115-C6EC-48D2-BA6C-5461C9935DE4}"), // УЗДГ
        //                                new Guid("{9C4881D6-05CE-47EF-B027-E04A22D96CEE}")   //УЗИ 
        //                            }.Contains(iprId))
        //                                procedureType = " чел.";    */
        //            var item = items[i];
        //            var query = new SqlQuery(context.DataContext, procedurDefId, userId);
        //            query.JoinSource(query.Source, iprDefId, SqlSourceJoinType.Inner, "Rehabilitation");
        //            query.AddCondition(ExpressionOperation.And, procedurDefId, "&OrgId", ConditionOperation.Equal, orgId);
        //            query.AddCondition(ExpressionOperation.And, procedurDefId, "Date", ConditionOperation.GreatEqual, fd);
        //            query.AddCondition(ExpressionOperation.And, procedurDefId, "Date", ConditionOperation.LessEqual, ld);
        //            query.AddCondition(ExpressionOperation.And, iprDefId, "IndividualRehabilitationPlan", ConditionOperation.Equal, iprId);
        //            query.AddAttribute("ProceduraCount", SqlQuerySummaryFunction.Sum);
        //            using (var reader = new SqlQueryReader(context.DataContext, query))
        //            {
        //                if (reader.Read())
        //                {
        //                    var count = !reader.Reader.IsDBNull(0) ? Convert.ToInt32(reader.GetValue(0)) : 0;
        //                    item.StringCount = string.Format("{1} чел. {0} {2}", count, CountPatient(iprId, orgId, fd, ld, context), procedureType);
        //                }
        //            }
        //            procedureType = "процедур";
        //        }
        //        for (int i = 0; i < 8; i++)
        //        {
        //            var iprId = iprTypes2[i];
        //            if (new Guid[] {
        //            new Guid("{166648BF-0F52-470E-ABC2-C9349E296315}"), // Трудотерапия(обучение основам компьютерной грамоте)
        //            new Guid("{96AAE67E-21CC-4C35-B180-21795DB64DE8}"), // Трудотерапия(обучение мелким ремонтом протезов и ортезов)
        //            new Guid("{3F752DA5-F243-4434-AF07-702EBB2C5D22}")}
        //                .Contains(iprId))
        //                procedureType = "занятий";
        //            var item = items[i + 7];
        //            var query = new SqlQuery(context.DataContext, procedurDefId, userId);
        //            query.JoinSource(query.Source, iprDefId, SqlSourceJoinType.Inner, "Rehabilitation");
        //            query.AddCondition(ExpressionOperation.And, procedurDefId, "&OrgId", ConditionOperation.Equal, orgId);
        //            query.AddCondition(ExpressionOperation.And, procedurDefId, "Date", ConditionOperation.GreatEqual, fd);
        //            query.AddCondition(ExpressionOperation.And, procedurDefId, "Date", ConditionOperation.LessEqual, ld);
        //            query.AddCondition(ExpressionOperation.And, iprDefId, "IndividualRehabilitationPlan", ConditionOperation.Equal, iprId);
        //            query.AddAttribute("ProceduraCount", SqlQuerySummaryFunction.Sum);
        //            using (var reader = new SqlQueryReader(context.DataContext, query))
        //            {
        //                if (reader.Read())
        //                {
        //                    var count = !reader.Reader.IsDBNull(0) ? Convert.ToInt32(reader.GetValue(0)) : 0;
        //                    item.StringCount = string.Format("{1} чел. {0} {2}", count, CountPatient(iprId, orgId, fd, ld, context), procedureType);
        //                }
        //            }
        //            procedureType = "процедур";
        //        }
        //    }
        //    public static int CountPatient(Guid iprId, Guid orgId, DateTime fd, DateTime ld, WorkflowContext context)
        //    {
        //        var query = new SqlQuery(context.DataContext, cardDefId, context.UserId);
        //        var iprSrc = query.JoinSource(query.Source, iprDefId, SqlSourceJoinType.Inner, "IPRat");
        //        var appSrc = query.JoinSource(query.Source, ApplicantDefId, SqlSourceJoinType.Inner, "Applicant");
        //        query.JoinSource(iprSrc, procedurDefId, SqlSourceJoinType.Inner, "Rehabilitation");
        //        query.AddCondition(ExpressionOperation.And, procedurDefId, "&OrgId", ConditionOperation.Equal, orgId);
        //        query.AddCondition(ExpressionOperation.And, procedurDefId, "Date", ConditionOperation.GreatEqual, fd);
        //        query.AddCondition(ExpressionOperation.And, procedurDefId, "Date", ConditionOperation.LessEqual, ld);
        //        query.AddCondition(ExpressionOperation.And, iprDefId, "IndividualRehabilitationPlan", ConditionOperation.Equal, iprId);
        //        query.AddAttribute(appSrc, "&Id");
        //        var list = new List<Guid>();
        //        int count = 0;
        //        var table = new DataTable();
        //        using (var reader = new SqlQueryReader(context.DataContext, query))
        //        {
        //            reader.Open();
        //            reader.Fill(table);
        //            reader.Close();
        //        }
        //        foreach (DataRow row in table.Rows)
        //        {
        //            var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
        //            if (appId != Guid.Empty && !list.Contains(appId))
        //            {
        //                list.Add(appId);
        //                count++;
        //            }
        //        }
        //        return count;
        //    }
        //    public class ReportItem
        //    {
        //        public Guid FieldName { get; set; }
        //        public string FieldNameText { get; set; }

        //        public string StringCount { get; set; }
        //        public int Men { get; set; }
        //        public int Women { get; set; }
        //    }
        //}*/







        //Сводная заявка по БРРП Форма 8


    }
}